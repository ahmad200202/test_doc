!function($,undefined){function findCenter(elem){var offset,document=$(elem.ownerDocument);return elem=$(elem),offset=elem.offset(),{x:offset.left+elem.outerWidth()/2-document.scrollLeft(),y:offset.top+elem.outerHeight()/2-document.scrollTop()}}function findCorner(elem){var offset,document=$(elem.ownerDocument);return elem=$(elem),offset=elem.offset(),{x:offset.left-document.scrollLeft(),y:offset.top-document.scrollTop()}}var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/;$.fn.simulate=function(type,options){return this.each(function(){new $.simulate(this,type,options)})},$.simulate=function(elem,type,options){var method=$.camelCase("simulate-"+type);this.target=elem,this.options=options,this[method]?this[method]():this.simulateEvent(elem,type,options)},$.extend($.simulate,{keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},buttonCode:{LEFT:0,MIDDLE:1,RIGHT:2}}),$.extend($.simulate.prototype,{simulateEvent:function(elem,type,options){var event=this.createEvent(type,options);this.dispatchEvent(elem,type,event,options)},createEvent:function(type,options){return rkeyEvent.test(type)?this.keyEvent(type,options):rmouseEvent.test(type)?this.mouseEvent(type,options):void 0},mouseEvent:function(type,options){var event,eventDoc,doc,body;return options=$.extend({bubbles:!0,cancelable:"mousemove"!==type,view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:undefined},options),document.createEvent?(event=document.createEvent("MouseEvents"),event.initMouseEvent(type,options.bubbles,options.cancelable,options.view,options.detail,options.screenX,options.screenY,options.clientX,options.clientY,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,options.button,options.relatedTarget||document.body.parentNode),0===event.pageX&&0===event.pageY&&Object.defineProperty&&(eventDoc=event.relatedTarget.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,Object.defineProperty(event,"pageX",{get:function(){return options.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0)}}),Object.defineProperty(event,"pageY",{get:function(){return options.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}}))):document.createEventObject&&(event=document.createEventObject(),$.extend(event,options),event.button={0:1,1:4,2:2}[event.button]||(-1===event.button?0:event.button)),event},keyEvent:function(type,options){var event;if(options=$.extend({bubbles:!0,cancelable:!0,view:window,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:undefined},options),document.createEvent)try{event=document.createEvent("KeyEvents"),event.initKeyEvent(type,options.bubbles,options.cancelable,options.view,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,options.keyCode,options.charCode)}catch(err){event=document.createEvent("Events"),event.initEvent(type,options.bubbles,options.cancelable),$.extend(event,{view:options.view,ctrlKey:options.ctrlKey,altKey:options.altKey,shiftKey:options.shiftKey,metaKey:options.metaKey,keyCode:options.keyCode,charCode:options.charCode})}else document.createEventObject&&(event=document.createEventObject(),$.extend(event,options));return(/msie [\w.]+/.exec(navigator.userAgent.toLowerCase())||"[object Opera]"==={}.toString.call(window.opera))&&(event.keyCode=options.charCode>0?options.charCode:options.keyCode,event.charCode=undefined),event},dispatchEvent:function(elem,type,event){elem[type]?elem[type]():elem.dispatchEvent?elem.dispatchEvent(event):elem.fireEvent&&elem.fireEvent("on"+type,event)},simulateFocus:function(){function trigger(){triggered=!0}var focusinEvent,triggered=!1,element=$(this.target);element.bind("focus",trigger),element[0].focus(),triggered||(focusinEvent=$.Event("focusin"),focusinEvent.preventDefault(),element.trigger(focusinEvent),element.triggerHandler("focus")),element.unbind("focus",trigger)},simulateBlur:function(){function trigger(){triggered=!0}var focusoutEvent,triggered=!1,element=$(this.target);element.bind("blur",trigger),element[0].blur(),setTimeout(function(){element[0].ownerDocument.activeElement===element[0]&&element[0].ownerDocument.body.focus(),triggered||(focusoutEvent=$.Event("focusout"),focusoutEvent.preventDefault(),element.trigger(focusoutEvent),element.triggerHandler("blur")),element.unbind("blur",trigger)},1)}}),$.extend($.simulate.prototype,{simulateDrag:function(){var i=0,target=this.target,options=this.options,center="corner"===options.handle?findCorner(target):findCenter(target),x=Math.floor(center.x),y=Math.floor(center.y),coord={clientX:x,clientY:y},dx=options.dx||(options.x!==undefined?options.x-x:0),dy=options.dy||(options.y!==undefined?options.y-y:0),moves=options.moves||3;for(this.simulateEvent(target,"mousedown",coord);moves>i;i++)x+=dx/moves,y+=dy/moves,coord={clientX:Math.round(x),clientY:Math.round(y)},this.simulateEvent(target.ownerDocument,"mousemove",coord);$.contains(document,target)?(this.simulateEvent(target,"mouseup",coord),this.simulateEvent(target,"click",coord)):this.simulateEvent(document,"mouseup",coord)}})}(jQuery);