!function(angular){"use strict";var keyEventsModule=angular.module("keyEvents",[]);keyEventsModule.config(["keyEventsProvider",function(keyEventsProvider){keyEventsProvider.addShortcut(function(event,is){is.esc="keydown"===event.type&&27===event.which,is.cmdEnter="keydown"===event.type&&13===event.which&&event.metaKey,is.input="BUTTON"===event.target.tagName||"INPUT"===event.target.tagName||"SELECT"===event.target.tagName||"TEXTAREA"===event.target.tagName})}]),keyEventsModule.provider("keyEvents",function(){function addShortcut(operator){shortcuts.push(operator)}function keyEventsFactory($document,KeyEventHandler){function handler(priority,isTerminal){return new KeyEventHandler(api,priority,isTerminal||!1)}function off(eventType,handler){deregisterHandler(eventType,handler)}function on(eventType,handler,priority,isTerminal){registerHandler(eventType,handler,priority,isTerminal)}function deregisterHandler(eventType,handler){for(var handlers=eventHandlers[eventType],i=handlers.length-1;i>=0;i--)handlers[i].handler===handler&&handlers.splice(i,1);handlers.length||stopWatchingEvent(eventType)}function handleEvent(event){var handlers=eventHandlers[event.type];event.is={};for(var i=0,length=shortcuts.length;length>i;i++)shortcuts[i](event,event.is);for(var i=handlers.length-1;i>=0;i--){if(handlers[i].handler(event)===!1)return event.stopImmediatePropagation(),event.preventDefault(),!1;if(handlers[i].isTerminal||event.isImmediatePropagationStopped())break}}function registerHandler(eventType,handler,priority,isTerminal){var handlers=eventHandlers[eventType],newItem={handler:handler,priority:priority,isTerminal:isTerminal};if(!handlers.length)return handlers.push(newItem),startWatchingEvent(eventType);if(handlers[0].priority>priority)return handlers.unshift(newItem);for(var i=handlers.length-1;i>=0;i--)if(handlers[i].priority<=priority)return handlers.splice(i+1,0,newItem)}function startWatchingEvent(eventType){$document.on(eventType,handleEvent)}function stopWatchingEvent(eventType){$document.off(eventType,handleEvent)}var eventHandlers={keydown:[],keypress:[],keyup:[]},api={handler:handler,off:off,on:on};return api}var shortcuts=[function(event,is){is[String.fromCharCode(event.which).toLowerCase()]=!0}];return{$get:keyEventsFactory,addShortcut:addShortcut}}),keyEventsModule.factory("KeyEventHandler",function(){function KeyEventHandler(keyEvents,priority,isTerminal){function keydown(handler){return eventHandlers.keydown.push(handler),keyEvents.on("keydown",handler,priority,isTerminal),api}function keypress(handler){return eventHandlers.keypress.push(handler),keyEvents.on("keypress",handler,priority,isTerminal),api}function keyup(handler){return eventHandlers.keyup.push(handler),keyEvents.on("keyup",handler,priority,isTerminal),api}function teardown(){teardownEventType("keydown"),teardownEventType("keypress"),teardownEventType("keyup")}function teardownEventType(eventType){for(var handlers=eventHandlers[eventType],i=0,length=handlers.length;length>i;i++)keyEvents.off(eventType,handlers[i])}var eventHandlers={keydown:[],keypress:[],keyup:[]},api={keydown:keydown,keypress:keypress,keyup:keyup,teardown:teardown};return api}return KeyEventHandler})}(angular);