!function(angular){"use strict";var attCommonServices=angular.module("attCommon.attCommonServices",["keyEvents"]),services=angular.module("attCommon.attCommonServices");services.value("server",{Name:"local"}),attCommonServices.factory("attSpinnerFactory",["$rootScope",function(){var factory={};return factory.data={},factory.data.isActive=!1,factory.startSpinner=function(){factory.data.isActive=!0},factory.stopSpinner=function(){factory.data.isActive=!1},factory}]).directive("attSpinnerDirective",["$window","attSpinnerFactory",function($window,attSpinnerFactory){return{scope:!0,link:function(scope){scope.data=attSpinnerFactory.data},template:'<div class="SpinnerContainer" ng-show="data.isActive"><img src="images/loader.gif" style="position: fixed;top: 50%;left: 50%;" class="MainSpinner"></div>'}}]),attCommonServices.provider("userPreferenceMapping",[function(){var mapping=null;return{setMapping:function(callbacksContext){mapping=callbacksContext},$get:function(){return{mapping:mapping}}}}]),attCommonServices.factory("DomElementsService",function(){var _verifyIdFormat=function(id){return 0==id.indexOf("#")?id:"#"+id},DomElementsService={data:{DOMElementsCallbacks:{}},DOMElementReady:function(domId){domId=_verifyIdFormat(domId);var fnc=DomElementsService.data.DOMElementsCallbacks[domId];angular.isDefined(fnc)&&"function"==typeof fnc?(DomElementsService.data.DOMElementsCallbacks[domId](),delete DomElementsService.data.DOMElementsCallbacks[domId]):DomElementsService.data.DOMElementsCallbacks[domId]={}},setCallbackForId:function(domId,callback){if(!angular.isUndefined(domId)&&!angular.isUndefined(callback)){domId=_verifyIdFormat(domId);var elementCallback=DomElementsService.data.DOMElementsCallbacks[domId];angular.isDefined(elementCallback)&&elementCallback=={}?callback():DomElementsService.data.DOMElementsCallbacks[domId]=callback}},removeId:function(domId){angular.isUndefined(domId)||""==domId||(domId=_verifyIdFormat(domId),delete DomElementsService.data.DOMElementsCallbacks[domId])}};return DomElementsService}),attCommonServices.factory("UserPreferencesService",["InvokerService","GlobalMessagesService","$q","userPreferenceMapping",function(InvokerService,GlobalMessagesService,$q,userPreferenceMapping){var _preferenceDelimiter="||",_keyValueDelimiter=":",_spaceReplacement="_|_",_resizingTimeout=null,UserPreferencesService={data:{currentContext:"",mapping:null,saveInterval:0,userInfoObj:null},getValueByKey:function(key){return window.userPreferences.get(key)},setValueByKey:function(key,val){window.userPreferences.set(key,val),UserPreferencesService.saveAllUserPreferences()},saveAllUserPreferences:function(successCallback){window.userPreferences.save(successCallback)},removePreferencesByKey:function(objKey,doSave){var subKeyToRemove="",subKeyToRemoveArr=[];angular.isUndefined(objKey)||(ObjectUtils.every(objKey,function(key,val){subKeyToRemoveArr.push(key+_keyValueDelimiter+val.replaceAll(" ",_spaceReplacement))}),subKeyToRemove=subKeyToRemoveArr.join(_preferenceDelimiter),window.userPreferences.removePreferencesByKey(subKeyToRemove,doSave))},removePreferencesByKeySimpleText:function(subKeyToRemove,doSave){window.userPreferences.removePreferencesByKey(subKeyToRemove,doSave)},buildCurrentContext:function(objContext){var currentCtx="";return ObjectUtils.every(objContext,function(key,item){currentCtx.length>0&&(currentCtx+=_preferenceDelimiter),currentCtx+=key+_keyValueDelimiter+item.replaceAll(" ",_spaceReplacement)}),currentCtx},checkMapping:function(){angular.equals(UserPreferencesService.data.mapping,userPreferenceMapping.mapping)||(UserPreferencesService.data.mapping=userPreferenceMapping.mapping)},setContext:function(objContext,callback){UserPreferencesService.checkMapping(),UserPreferencesService.data.currentContext=UserPreferencesService.buildCurrentContext(objContext);var setContextDefer=$q.defer(),setContextPromise=setContextDefer.promise;return ObjectUtils.isEmpty(UserPreferencesService.data.mapping)?(callback&&callback(),setContextDefer.resolve()):UserPreferencesService.initUserPreference(function(){callback&&callback(),setContextDefer.resolve()}),setContextPromise},getUserInfoObj:function(){return ObjectUtils.isEmpty(UserPreferencesService.data.userInfoObj)&&(UserPreferencesService.data.userInfoObj={}),ObjectUtils.deepClone(UserPreferencesService.data.userInfoObj)},saveUserInfo:function(dataAsDictionary,onSuccess){if(!ObjectUtils.isEmpty(UserPreferencesService.data.mapping)){var dataAsString=JSON.stringify(dataAsDictionary);UserPreferencesService.data.mapping.PutUserInfo.params.putData=UserPreferencesService.getUserInfoObj(),UserPreferencesService.data.mapping.PutUserInfo.params.putData.data=dataAsString,InvokerService.invokeServiceMethod(UserPreferencesService.data.mapping,"PutUserInfo",function(){onSuccess&&"function"==typeof onSuccess&&onSuccess()},function(message,moreInfo,code){GlobalMessagesService.showErrorMessage(message,moreInfo,code)})}},getUserInfo:function(onSuccess){ObjectUtils.isEmpty(UserPreferencesService.data.mapping)||InvokerService.invokeServiceMethod(UserPreferencesService.data.mapping,"GetUserInfo",function(response){if(UserPreferencesService.data.userInfoObj=response,""==response.data||"null"==response.data)return void onSuccess({});var dataObj=JSON.parse(response.data);onSuccess(dataObj)})},initUserPreference:function(callback){var initFunctionsObj=null;ObjectUtils.isEmpty(UserPreferencesService.data.mapping)||(initFunctionsObj={saveCallback:UserPreferencesService.saveUserInfo,getCallback:UserPreferencesService.getUserInfo,saveInterval:UserPreferencesService.data.saveInterval}),window.userPreferences.init(initFunctionsObj,callback)},getKey:function(objParameters){var preferencesKey=UserPreferencesService.data.currentContext;if(angular.isUndefined(objParameters))return preferencesKey;var preferencesKeyArr=[];return preferencesKey.length>0&&(preferencesKeyArr=preferencesKey.split(_preferenceDelimiter)),ObjectUtils.every(objParameters,function(key,val){if(!ObjectUtils.isEmpty(val)){var validItem=val.replaceAll(" ",_spaceReplacement),arrayItem=key+_keyValueDelimiter+validItem;return"state"==key?void preferencesKeyArr.splice(0,1,arrayItem):void preferencesKeyArr.push(arrayItem)}}),preferencesKey=preferencesKeyArr.join(_preferenceDelimiter)},handleUISplitOnLoad:function(leftSelector,rightSelector){var preferenceKey=UserPreferencesService.getKey({type:"layoutSplit",id:leftSelector}),layoutSplitVal=UserPreferencesService.getValueByKey(preferenceKey);if(layoutSplitVal){var leftElement=$("#"+leftSelector)[0];if(angular.isUndefined(leftElement))return;leftElement.style.right=layoutSplitVal,layoutSplitVal=layoutSplitVal.replace("%",""),$("#"+leftSelector+" + .stretch.ui-splitbar")[0].style.left=100-layoutSplitVal+"%";var rightElement=$("#"+rightSelector)[0];if(angular.isUndefined(rightElement))return;rightElement.style.left=100-layoutSplitVal+"%"}},setUISplitOnChange:function(leftSelector){var leftSelectorObj=$("#"+leftSelector);0!=leftSelectorObj.length&&addResizeListener(leftSelectorObj[0],function(){_resizingTimeout&&(clearTimeout(_resizingTimeout),_resizingTimeout=null),_resizingTimeout=setTimeout(function(){if(!ObjectUtils.isEmpty($("#"+leftSelector)[0])){var preferenceKey=UserPreferencesService.getKey({type:"layoutSplit",id:leftSelector}),preferenceVal=$("#"+leftSelector)[0].style.right;UserPreferencesService.setValueByKey(preferenceKey,preferenceVal)}},300)})}};return UserPreferencesService}]),attCommonServices.factory("DataFormatCommonService",["$filter",function($filter){var _dateToLocale=function(dateObj,hide_today,display_format,include_time){if(hide_today){var currentDate=new Date;if(currentDate.getDate()==dateObj.getDate()&&currentDate.getMonth()==dateObj.getMonth()&&currentDate.getYear()==dateObj.getYear())return DataFormatCommonService.getDateFormatFromMS(dateObj.getTime(),"shortTime")}return display_format?DataFormatCommonService.getDateFormatFromMS(dateObj.getTime(),display_format):include_time?DataFormatCommonService.getDateFormatFromMS(dateObj.getTime(),"medium"):DataFormatCommonService.getDateFormatFromMS(dateObj.getTime(),"mediumDate")},DataFormatCommonService={data:{DisplayFormats:{"short":"short",medium:"medium",fullDate:"fullDate",longDate:"longDate",mediumDate:"mediumDate",shortDate:"shortDate",mediumTime:"mediumTime",shortTime:"shortTime"}},getKbToMbAsInt:function(sizeInKb){return Math.floor(sizeInKb/1024)},getNumberKbToMb:function(sizeInKb){var valMB=DataFormatCommonService.getKbToMbAsInt(sizeInKb);return $filter("number")(valMB)},getDateFormatFromMS:function(milisec,format){return $filter("date")(milisec,format)},getTicksToDateFormat:function(timeticks,format){return DataFormatCommonService.getDateFormatFromMS(Utils.ConvertTicksToMS(timeticks),format)},getTicksToMillisecondsFormatFilter:function(milliseconds,format,padding,hideDateForSameDate){return $filter("millisecondsFormat")(milliseconds,format,padding,hideDateForSameDate)},getMiliSecToDuration:function(millisec){(""==millisec||null==millisec||void 0==millisec||"number"!=typeof millisec)&&(millisec=0);var seconds=(millisec/1e3).toFixed(0),minutes=Math.floor(seconds/60),hours=0;return minutes>59&&(hours=Math.floor(minutes/60),minutes-=60*hours),seconds=Math.floor(seconds%60),Utils.pad(hours)+":"+Utils.pad(minutes)+":"+Utils.pad(seconds)},getTicksToHHmmss:function(timeticks){return 0===timeticks?"00:00:00":DataFormatCommonService.getTicksToDateFormat(timeticks,"shortTime")},getTicksToFullDateAndTime:function(timeticks){return DataFormatCommonService.getTicksToDateFormat(timeticks,"medium")},getDateLocalFormat:function(date,format,includeTime,ifTodayHideDate,displayFormat){if(0==date)return date;switch((void 0==ifTodayHideDate||""==ifTodayHideDate)&&(ifTodayHideDate=!1),format){case consts.DateToLocaleFilterFormats.YYYYminMMminDD:var dateArr=date.split("-"),newDate=new Date(dateArr[0],dateArr[1]-1,dateArr[2]);return _dateToLocale(newDate,ifTodayHideDate,displayFormat,includeTime);case consts.DateToLocaleFilterFormats.mm_slash_dd_slash_yyyy_space_hh_colon_mm_colon_ss:var dateTimeArr=date.split(" "),dateArr=dateTimeArr[0].split("/"),timeArr=dateTimeArr[1].split(":"),newDate=new Date(dateArr[2],dateArr[0]-1,dateArr[1]),hours=timeArr[0];return"AM"==dateTimeArr[2]?12==timeArr[0]&&(hours=0):12!=timeArr[0]&&(hours=parseInt(timeArr[0])+12),newDate.setHours(hours),newDate.setMinutes(timeArr[1]),newDate.setSeconds(timeArr[2]),_dateToLocale(newDate,ifTodayHideDate,displayFormat,includeTime);case consts.DateToLocaleFilterFormats.ticks:var newDate=new Date((date-621355968e9)/1e4);return _dateToLocale(newDate,ifTodayHideDate,displayFormat,includeTime);case consts.DateToLocaleFilterFormats.nanoSec:var newDate=new Date(date/1e3);return _dateToLocale(newDate,ifTodayHideDate,displayFormat,includeTime);case consts.DateToLocaleFilterFormats.dateObj:return _dateToLocale(date,ifTodayHideDate,displayFormat,includeTime)}}};return DataFormatCommonService}]),attCommonServices.factory("GlobalEvents",[function(){var handlers={},GlobalEvents={on:function(evName,handler){null==handlers[evName]&&(handlers[evName]=[]),handlers[evName].push(handler)},trigger:function(ev,evOptions){handlers[ev]&&ArrayUtils.each(handlers[ev],function(hndl){hndl&&hndl(evOptions)})},destroy:function(evName,handler){if(null==handler)handlers[evName]=null;else if(handlers[evName]){var index=handlers[evName].indexOf(handler);-1!=index&&handlers[evName].splice(index,1)}}};return GlobalEvents}]),attCommonServices.factory("AttGlobalBatch",["AttBatch",function(AttBatch){var globalBatch=AttBatch.CreateBatch(),AttGlobalBatch={data:{isActive:!1},Begin:function(){AttGlobalBatch.data.isActive&&console.log("ATTMessage - Warning : Global batch has already started!"),AttGlobalBatch.data.isActive=!0},_addRequest:function(options){globalBatch.addRequest(options)},Flush:function(){globalBatch.flush()},Submit:function(){return AttGlobalBatch.data.isActive=!1,AttBatch.SubmitBatch(globalBatch)}};return AttGlobalBatch}]),attCommonServices.factory("AttBatch",["$injector",function($injector){var ServerFactory,BatchRequest=function(){this.batchItems={},this.requestsDic={},this.addRequest=function(options){var allReqsKeys=Object.keys(this.requestsDic),requstId=Utils.generateNewName("Call",function(it){return allReqsKeys.indexOf(it)>=0},"_",1);this.requestsDic[requstId]=options;var batchItem={url:options.url,method:options.method};null!=options.payload&&(batchItem.payload=options.payload),this.batchItems[requstId]=batchItem},this.flush=function(){this.batchItems={},this.requestsDic={}}},AttBatch={CreateBatch:function(){return new BatchRequest},SubmitBatch:function(batchObj,onBatchSuccess,onBatchError){ServerFactory=ServerFactory||$injector.get("serverFactory");var req=angular.copy(DO.BatchReq_Defaults);return req[DO.BatchReq.batch_items]=batchObj.batchItems,ServerFactory.DoBatch(req,function(batchResponse){ObjectUtils.forOwn(batchResponse[DO.BatchResp.batch_items],function(callId,respItem){if(200==respItem[DO.BatchRespItem.status])batchObj.requestsDic[callId]&&batchObj.requestsDic[callId].onSuccess&&batchObj.requestsDic[callId].onSuccess({data:respItem[DO.BatchRespItem.payload]});else if(batchObj.requestsDic[callId].onError){const err={appMessage:respItem[DO.BatchRespItem.message],statusCode:respItem[DO.BatchRespItem.status],detailedMessage:respItem[DO.BatchRespItem.detailed_message]};var errorPayload={data:err};errorPayload=ObjectUtils.deepFillIn(errorPayload,err),batchObj.requestsDic[callId].onError(errorPayload)}}),batchObj.flush(),onBatchSuccess&&onBatchSuccess()},function(){batchObj.flush(),onBatchError&&onBatchError()})}};return AttBatch}]),attCommonServices.factory("TimeFrameService",["locale",function(locale){return{getBaseValuesTimeFrameList:function(){return[{name:angular.copy(consts.MessagesCenter.timeFrameNames.last6Hours),displayName:locale.getString("common.messageCenter.last6Hours"),lowerCaseName:locale.getString("common.messageCenter.last6Hours").toLowerCase()},{name:angular.copy(consts.MessagesCenter.timeFrameNames.last12Hours),displayName:locale.getString("common.messageCenter.last12Hours"),lowerCaseName:locale.getString("common.messageCenter.last12Hours").toLowerCase()},{name:angular.copy(consts.MessagesCenter.timeFrameNames.last24Hours),displayName:locale.getString("common.messageCenter.lastDay"),lowerCaseName:locale.getString("common.messageCenter.lastDay").toLowerCase()},{name:angular.copy(consts.MessagesCenter.timeFrameNames.last72Hours),displayName:locale.getString("common.messageCenter.last3Days"),lowerCaseName:locale.getString("common.messageCenter.last3Days").toLowerCase()},{name:angular.copy(consts.MessagesCenter.timeFrameNames.lastWeek),displayName:locale.getString("common.messageCenter.lastWeek"),lowerCaseName:locale.getString("common.messageCenter.lastWeek").toLowerCase()}]}}}]),attCommonServices.factory("PendingGetRequests",function(){var pendingRequests={},PendingGetRequests={data:{promises:{}},isPending:function(url){return pendingRequests[url]?!0:(pendingRequests[url]=!0,!1)},removePendingRequest:function(url){null!=pendingRequests[url]&&(delete pendingRequests[url],delete PendingGetRequests.data.promises[url])}};return PendingGetRequests}),attCommonServices.factory("attInterval",["keyEvents",function(keyEvents){{var _intervalsDictionary={},_labelsDictionary={},_intervalCounter=0,_intervalActions={PAUSE:0,RESUME:1,REMOVE:2},_addLabelsToDictionary=function(arrLabels,intervalId){ArrayUtils.each(arrLabels,function(label){var arrIntervalIDs=_labelsDictionary[label];null==arrIntervalIDs?_labelsDictionary[label]=[intervalId]:ArrayUtils.insert(_labelsDictionary[label],intervalId)})},_removeIntervalFromLabelsDictionary=function(intervalId){attInterval.isIntervalExist(intervalId)&&ArrayUtils.each(_intervalsDictionary[intervalId].labels,function(label){null!=_labelsDictionary[label]&&(ArrayUtils.removeElementFromArray(_labelsDictionary[label],intervalId),0==_labelsDictionary[label].length&&delete _labelsDictionary[label])})},_setNewIntervalObject=function(intervalAction,delay,labels,immediateFirstInvoke,onSuccess,onError){var intervalId=_intervalCounter++;return _intervalsDictionary[intervalId]={id:intervalId,delay:delay,labels:labels,funcToExecute:intervalAction,onFuncSuccess:onSuccess,onFuncError:onError,immediateFirstInvoke:null==immediateFirstInvoke?!0:immediateFirstInvoke,timeoutHandler:null},_addLabelsToDictionary(labels,intervalId),intervalId},_runAction=function(id){var intervalObj=_intervalsDictionary[id];if(!ObjectUtils.isEmpty(intervalObj)){var funcRet=intervalObj.funcToExecute();funcRet&&funcRet.then?(funcRet.then(function(){intervalObj.onFuncSuccess&&intervalObj.onFuncSuccess()},function(){intervalObj.onFuncError&&intervalObj.onFuncError()}),funcRet.finally(function(){_intervalIteration(id)})):_intervalIteration(id)}},_intervalIteration=function(id){var intervalObj=_intervalsDictionary[id];void 0!=intervalObj&&(intervalObj.timeoutHandler=setTimeout(function(){null!=intervalObj.timeoutHandler&&_runAction(id)},intervalObj.delay))},_invokeInterval=function(id){var intervalObj=_intervalsDictionary[id];ObjectUtils.isEmpty(intervalObj)||(intervalObj.immediateFirstInvoke?_runAction(id):_intervalIteration(id))},_pauseIntervalById=function(id){if(!attInterval.isIntervalExist(id))return!1;var intervalObj=_intervalsDictionary[id];return clearTimeout(intervalObj.timeoutHandler),intervalObj.timeoutHandler=null,!0},_resumeIntervalById=function(id){if(!attInterval.isIntervalExist(id))return!1;if(null==_intervalsDictionary[id].timeoutHandler)return _invokeInterval(id),!0},_removeIntervalById=function(id){if(!attInterval.isIntervalExist(id))return!1;var intervalObj=_intervalsDictionary[id];return clearTimeout(intervalObj.timeoutHandler),intervalObj.timeoutHandler=null,_removeIntervalFromLabelsDictionary(id),delete _intervalsDictionary[id],!0},_actionOnIntervalsByLabels=function(arrLabels,action){ArrayUtils.each(arrLabels,function(label){ObjectUtils.isEmpty(_labelsDictionary[label])||ArrayUtils.each(_labelsDictionary[label],function(intervalId){switch(action){case _intervalActions.PAUSE:_pauseIntervalById(intervalId);break;case _intervalActions.RESUME:_resumeIntervalById(intervalId);break;case _intervalActions.REMOVE:_removeIntervalById(intervalId)}})})},attInterval={setInterval:function(intervalAction,delay,labels,immediateFirstInvoke,onSuccess,onError){var newIntervalId=_setNewIntervalObject(intervalAction,delay,labels,immediateFirstInvoke,onSuccess,onError);return _invokeInterval(newIntervalId),newIntervalId},pauseIntervalsById:function(arrIDs){ArrayUtils.each(arrIDs,function(id){_pauseIntervalById(id)})},pauseIntervalsByLabels:function(arrLabels){_actionOnIntervalsByLabels(arrLabels,_intervalActions.PAUSE)},resumeIntervalById:function(arrIDs){ArrayUtils.each(arrIDs,function(id){_resumeIntervalById(id)})},resumeIntervalsByLabels:function(arrLabels){_actionOnIntervalsByLabels(arrLabels,_intervalActions.RESUME)},removeIntervals:function(arrIDs){null==arrIDs&&(arrIDs=Object.keys(_intervalsDictionary)),ArrayUtils.each(arrIDs,function(id){_removeIntervalById(parseInt(id))})},removeIntervalsByLabels:function(arrLabels){_actionOnIntervalsByLabels(arrLabels,_intervalActions.REMOVE)},isIntervalPaused:function(id){return attInterval.isIntervalExist(id)?null==_intervalsDictionary[id].timeoutHandler:void 0},isIntervalRunning:function(id){return attInterval.isIntervalExist(id)?null!=_intervalsDictionary[id].timeoutHandler:void 0},isIntervalExist:function(id){return!ObjectUtils.isEmpty(_intervalsDictionary[id])}};keyEvents.handler(1).keydown(function(event){Utils.isDebugMode()&&event.ctrlKey&&event.shiftKey&&event.is.e&&attInterval.removeIntervals()})}return attInterval}]),attCommonServices.factory("AttSharedUtils",["$filter","locale","$timeout","modalService","$q",function($filter,locale,$timeout,modalService,$q){var AttSharedUtils={SHARED_PROPS:{ui_prop_is_full_edit_mode:"ui_prop_is_full_edit_mode",ui_prop_is_partial_edit_mode:"ui_prop_is_partial_edit_mode",ui_prop_is_new_item:"ui_prop_is_new_item"},IsCtrlPressed:function($event){return $event&&($event.ctrlKey||$event.metaKey)||Utils.isDebugMode()},EnableHiddenFeature:function($event){return AttSharedUtils.IsCtrlPressed($event)},HandleMenuNotClosing:function($event){null!=$event&&null!=$event.currentTarget&&$timeout(function(){angular.element($event.currentTarget).parents("ul").trigger("click")},100)},RecurseTree:function(tree,pridecate){if(tree&&(pridecate(tree),tree.children))for(var i=0;i<tree.children.length;i++)AttSharedUtils.RecurseTree(tree.children[i],pridecate)},FilterTree:function(item,filter_predicate){var ret_predicate=!1;if(filter_predicate&&(ret_predicate=filter_predicate(item)),ret_predicate)return ret_predicate;if(item.children){for(var res=!1,i=0;i<item.children.length;i++)res=res||AttSharedUtils.FilterTree(item.children[i],filter_predicate);return res}return!1},FocusOnFirstInput:function(selector){},SetItemsInEditMode:function(items,full_edit,partial_edit){null!=items&&angular.forEach(items,function(item){item[AttSharedUtils.SHARED_PROPS.ui_prop_is_full_edit_mode]=full_edit,null!=partial_edit&&(item[AttSharedUtils.SHARED_PROPS.ui_prop_is_partial_edit_mode]=partial_edit)})},SetAsNewItem:function(items,is_new){null!=items&&angular.forEach(items,function(item){item[AttSharedUtils.SHARED_PROPS.ui_prop_is_new_item]=is_new})},DeleteUIProps:function(props_obj,items){if(null!=items){var propsArr=Object.keys(props_obj);items=AttSharedUtils.RemoveUndefinedItemsFromArray(items),angular.forEach(items,function(item){angular.forEach(propsArr,function(prop){delete item[props_obj[prop]]})});var props_objArr=Object.keys(AttSharedUtils.SHARED_PROPS);angular.forEach(items,function(item){angular.forEach(props_objArr,function(prop){delete item[AttSharedUtils.SHARED_PROPS[prop]]})})}},RemoveUndefinedItemsFromArray:function(arr){return null==arr&&(arr=[]),arr.filter(function(it){return null!=it&&void 0!=it})},GetNewOrdinal:function(att_list,selected_item,arrangeList,custom_ordinal_prop){var selected_ordinal=0,ordinal_number=0,ordinal_prop="ordinal";if(null!=custom_ordinal_prop&&""!=custom_ordinal_prop&&(ordinal_prop=custom_ordinal_prop),null!=selected_item&&(selected_ordinal=selected_item[ordinal_prop]),0==selected_ordinal){ordinal_number=consts.OrdinalSpace;for(var i=0;i<att_list.length;i++)att_list[i][ordinal_prop]>=ordinal_number&&(ordinal_number=att_list[i][ordinal_prop]+consts.OrdinalSpace)}else{var index=att_list.indexOf(selected_item);ordinal_number=att_list[index][ordinal_prop]+consts.OrdinalSpace,1==arrangeList&&this.ArrangeList(att_list,index,custom_ordinal_prop)}return ordinal_number},ArrangeList:function(att_list,index,custom_ordinal_prop,arrange_all){var ordinal_prop="ordinal";if(null!=custom_ordinal_prop&&""!=custom_ordinal_prop&&(ordinal_prop=custom_ordinal_prop),null==arrange_all||1!=arrange_all)for(var i=index+1;i<att_list.length;i++)att_list[i][ordinal_prop]=att_list[i][ordinal_prop]+consts.OrdinalSpace;else for(var start_ordinal=consts.OrdinalSpace,i=0;i<att_list.length;i++)att_list[i][ordinal_prop]=start_ordinal,start_ordinal+=consts.OrdinalSpace},CanChangeItemsOrder:function(full_list,selected_item,direction,prop_name_to_compare){var row_idx=-1;return direction==consts.Directions.UP||direction==consts.Directions.FIRST?(angular.forEach(full_list,function(item,idx){item[prop_name_to_compare]==selected_item[0][prop_name_to_compare]&&(row_idx=idx)}),0!=row_idx):(angular.forEach(full_list,function(item,idx){selected_item.length>1?item[prop_name_to_compare]==selected_item[selected_item.length-1][prop_name_to_compare]&&(row_idx=idx):item[prop_name_to_compare]==selected_item[0][prop_name_to_compare]&&(row_idx=idx)}),row_idx!=full_list.length-1)},ChangeItemsOrder:function(full_list,selected_items,direction,prop_name_to_compare,prop_name_to_order,find_index_func){var continueLoop=!0,row=null,index=0,temp_order="";if(direction==consts.Directions.UP){row=selected_items[0];for(var i=0;i<full_list.length&&continueLoop;i++)if(null!=full_list[i+1]&&full_list[i+1][prop_name_to_compare]==row[prop_name_to_compare]){for(var tempRow=full_list[i],j=0;j<selected_items.length;j++)full_list[i]=selected_items[j],i++;full_list[i]=tempRow,continueLoop=!1}if(""!=prop_name_to_order)for(var ordering=0,i=0;i<full_list.length;i++)ordering+=consts.OrdinalSpace,full_list[i][prop_name_to_order]=ordering}if(direction==consts.Directions.DOWN){row=selected_items[selected_items.length-1];for(var i=full_list.length;i>0&&continueLoop;i--)if(null!=full_list[i-2]&&full_list[i-2][prop_name_to_compare]==row[prop_name_to_compare]){for(var tempRow=full_list[i-1],j=selected_items.length;j>0;j--)full_list[i-1]=selected_items[j-1],i--;full_list[i-1]=tempRow,continueLoop=!1}if(""!=prop_name_to_order)for(var ordering=0,i=0;i<full_list.length;i++)ordering+=consts.OrdinalSpace,full_list[i][prop_name_to_order]=ordering}if(direction==consts.Directions.FIRST){var row_order=0;if(1==selected_items.length){row=full_list[0],""!=prop_name_to_order&&(row_order=full_list[0][prop_name_to_order]),index=null!=find_index_func?find_index_func(selected_items[0]):full_list.indexOf(selected_items[0]),full_list[0]=angular.copy(selected_items[0]),""!=prop_name_to_order&&(full_list[0][prop_name_to_order]=row_order);for(var i=1;index+1>i;i++){var tempRow=full_list[i];""!=prop_name_to_order&&(temp_order=full_list[i][prop_name_to_order]),full_list[i]=row,""!=prop_name_to_order&&(full_list[i][prop_name_to_order]=temp_order),row=tempRow}}else{for(var multiple_index=[],first_items=[],i=0;i<selected_items.length;i++)index=null!=find_index_func?find_index_func(selected_items[i]):full_list.indexOf(selected_items[i]),multiple_index.push(index),first_items.push(full_list[index]);for(var last_items=[],i=0;i<full_list.length;i++){for(var found=!1,j=0;j<multiple_index.length;j++)multiple_index[j]==i&&(found=!0);0==found&&last_items.push(full_list[i])}for(var ordinal=consts.OrdinalSpace,i=0;i<first_items.length;i++)full_list[i]=angular.copy(first_items[i]),""!=prop_name_to_order&&(full_list[i][prop_name_to_order]=ordinal,ordinal+=consts.OrdinalSpace);for(var i=first_items.length,j=0;j<last_items.length;i++,j++)full_list[i]=angular.copy(last_items[j]),""!=prop_name_to_order&&(full_list[i][prop_name_to_order]=ordinal,ordinal+=consts.OrdinalSpace)}}if(direction==consts.Directions.LAST){var row_order=0;if(1==selected_items.length){row=full_list[full_list.length-1],""!=prop_name_to_order&&(row_order=full_list[full_list.length-1][prop_name_to_order]),index=null!=find_index_func?find_index_func(selected_items[0]):full_list.indexOf(selected_items[0]),full_list[full_list.length-1]=angular.copy(selected_items[0]),""!=prop_name_to_order&&(full_list[full_list.length-1][prop_name_to_order]=row_order);for(var i=full_list.length-2;i>index-1;i--){var tempRow=full_list[i];""!=prop_name_to_order&&(temp_order=full_list[i][prop_name_to_order]),full_list[i]=row,""!=prop_name_to_order&&(full_list[i][prop_name_to_order]=temp_order),row=tempRow}}else{for(var multiple_index=[],last_items=[],i=0;i<selected_items.length;i++)index=null!=find_index_func?find_index_func(selected_items[i]):full_list.indexOf(selected_items[i]),multiple_index.push(index),last_items.push(full_list[index]);for(var first_items=[],i=0;i<full_list.length;i++){for(var found=!1,j=0;j<multiple_index.length;j++)multiple_index[j]==i&&(found=!0);0==found&&first_items.push(full_list[i])}for(var ordinal=consts.OrdinalSpace,i=0;i<first_items.length;i++)full_list[i]=angular.copy(first_items[i]),""!=prop_name_to_order&&(full_list[i][prop_name_to_order]=ordinal,ordinal+=consts.OrdinalSpace);for(var i=0,j=first_items.length;i<last_items.length;i++,j++)full_list[j]=angular.copy(last_items[i]),""!=prop_name_to_order&&(full_list[j][prop_name_to_order]=ordinal,ordinal+=consts.OrdinalSpace)}}return full_list},RefreshCodeMirrorInstance:function(timeout,code_mirror_class_name){timeout=timeout||250,$timeout(function(){var instance=Utils.GetCodeMirrorInstance(code_mirror_class_name);instance&&instance.refresh()},timeout)},RemoveItemsFromGrid:function(gridAPI,list_items,item_search_prop,timeout,onFinishCallback){if(null!=gridAPI&&null!=gridAPI.selectedItems&&null!=list_items){if(1==gridAPI.selectedItems.length){var item=ArrayUtils.first(gridAPI.selectedItems),idx=list_items.indexOf(item);list_items.splice(list_items.indexOf(item),1);var new_idx=Utils.getSelectedIndexAfterAction(list_items,idx,"delete",item_search_prop,item_search_prop)}else new_idx=0,angular.forEach(gridAPI.selectedItems,function(it){list_items.splice(list_items.indexOf(it),1)}),0==list_items.length&&(new_idx=-1);-1!=new_idx?null!=timeout?$timeout(function(){gridAPI.selectAndGoToItem(new_idx),onFinishCallback&&onFinishCallback()},timeout):(gridAPI.selectAndGoToItem(new_idx),onFinishCallback&&onFinishCallback()):onFinishCallback&&onFinishCallback()}},GetUniqueName:function(prefix,current_list,current_list_prop){var nameExistInCurrentList=function(name){var name_exist=null!=current_list&&current_list.filter(function(list_item){return null!=list_item[current_list_prop]&&list_item[current_list_prop]==name}).length>0;return name_exist||prefix==name};return Utils.generateNewName(prefix,nameExistInCurrentList," ",1)},HandleLoggerChanged:function(logName,logVal,globalVal,loggersConfig){var showMessage=!1,messageBody=locale.getString("common.loggersConfig.DetailsDebug_InfoBody");if(logName==globalVal)loggersConfig[logName]=logVal,angular.forEach(loggersConfig,function(val,key){"$type"!=key&&key!=globalVal&&"LogLevel"==DO[loggersConfig.$type+"_Types"][key]&&(loggersConfig[key]=DO.LogLevel.DEFAULT)}),showMessage=logVal==DO.LogLevel.DETAILED_DEBUG;else{loggersConfig[logName]=logVal;var keys=Object.keys(loggersConfig).filter(function(it){return"$type"!=it&&it!=globalVal}),detailed_debug_keys=keys.filter(function(it){return loggersConfig[it]==DO.LogLevel.DETAILED_DEBUG});showMessage=keys.length==detailed_debug_keys.length,messageBody=locale.getString("common.loggersConfig.DetailsAllDebug_InfoBody")}if(showMessage){var headerText=locale.getString("common.loggersConfig.DetailsDebug_InfoHeader");modalService.showConfirm({bodyText:messageBody,headerText:headerText,closeButtonText:""})}},ShowConfirmationMessage:function(msg_type,headerText,messageText,questionText,actionButtonText,secondOptionActionButtonText,closeButtonText,actionButtonClickCallback,secondButtonClickCallback,closeButtonClickCallback){return null==msg_type&&(msg_type=modalService.modalConfirmationType.Warning),null==actionButtonText&&(actionButtonText=locale.getString("common.base.Yes")),null==secondOptionActionButtonText&&(secondOptionActionButtonText=""),null==closeButtonText&&(closeButtonText=locale.getString("common.base.No")),modalService.showConfirm({headerText:headerText,bodyText:messageText,questionText:questionText,actionButtonText:actionButtonText,closeButtonText:closeButtonText,secondOptionActionButtonText:secondOptionActionButtonText,msgType:msg_type,onBeforeOk:function(vm,okCallback){actionButtonClickCallback&&actionButtonClickCallback(),okCallback&&okCallback()},onBeforeSecondOptionOk:function(vm,okCallback){secondButtonClickCallback?secondButtonClickCallback(vm,okCallback):okCallback&&okCallback()}},{windowClass:"confirmDialogClass confirmDialogClassLarge"}).then(function(){},function(){closeButtonClickCallback&&closeButtonClickCallback()})},ShowMultiLineMessageMessage:function(params,onOkCallback,onCancelCallback){return null==params.actionButtonText&&(params.actionButtonText=locale.getString("common.base.Yes")),null==params.closeButtonText&&(params.closeButtonText=locale.getString("common.base.No")),modalService.showModal({contentTemplate:"partials/popup/multiLineMessageView.html",headerText:params.title,resizable:!1,okDisabledProp:"okDisabled",actionButtonText:params.actionButtonText,closeButtonText:params.closeButtonText,onBeforeOk:onOkCallback,onBeforeClose:function(vm,closeCallback){onCancelCallback&&onCancelCallback(vm),closeCallback&&closeCallback(vm)},model:{message_lines:params.message_lines,header_message:params.header_message,footer_message:params.footer_message,footer_message_class:params.footer_message_class}},{windowClass:params.message_lines.length<=5?"multiLineMessagePopup IMPORTANT":"multiLineMessagePopupLarge IMPORTANT"})
},GetStorageKey:function(key_name,from_local_storage){var ret=null;try{from_local_storage||null!=amplify.store.sessionStorage||(from_local_storage=!0),ret=from_local_storage?amplify.store(key_name):amplify.store.sessionStorage(key_name)}catch(e){console.log("repUtils.GetStorageKey error - "+e)}return ret},SetStorageKey:function(key_name,key_value,to_local_storage){try{to_local_storage||null!=amplify.store.sessionStorage||(to_local_storage=!0),to_local_storage?amplify.store(key_name,key_value):amplify.store.sessionStorage(key_name,key_value)}catch(e){console.log("repUtils.SetStorageKey error - "+e)}},HandleMultiplePromise:function(p,onSuccess,onError){p.length>0?$q.all(p).then(function(){$timeout(function(){},400),onSuccess&&onSuccess()}).catch(function(r){onError&&onError(r)}):onSuccess&&onSuccess()},MapEnumToUIObject:function(enum_obj){var ret=[];return null!==enum_obj&&(ret=Object.keys(enum_obj).map(function(key){return{type:key,name:enum_obj[key]}})),ret},GetSplitterClassName:function(class_name){return String.format("div.split-pane.{0}",class_name)},FocusOnEditableRow:function(){var el=$(".editMode input");if(el.focus(),el[0]&&el[0].setSelectionRange){var len=2*el.val().length;setTimeout(function(){el[0].setSelectionRange(len,len)},1)}else el.val($(".editMode input").val())}};return AttSharedUtils}])}(angular);