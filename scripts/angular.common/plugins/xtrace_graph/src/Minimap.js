function DirectedAcyclicGraphMinimap(DAG){return Minimap().draw(function(d){var edgedata=d3.select(d).selectAll(".edge.visible").data(),nodedata=d3.select(d).selectAll(".node.visible").data(),edges=d3.select(this).selectAll(".edge").data(edgedata);edges.enter().append("path").attr("class","edge"),edges.exit().remove();var nodes=d3.select(this).selectAll(".node").data(nodedata);nodes.enter().append("g").attr("class","node").append("rect"),nodes.selectAll("rect").attr("x",function(d){return-(d.bbox.width/2)}).attr("y",function(d){return-(d.bbox.height/2)}).attr("width",function(d){return d.width}).attr("height",function(d){return d.height}),nodes.exit().remove(),nodes.attr("transform",DAG.nodeTranslate),edges.attr("d",DAG.splineGenerator)})}function Minimap(){function minimap(selection){selection.each(function(data){var svg=d3.select(this).selectAll("svg").data([data]),firsttime=svg.enter().append("svg");firsttime.append("rect").attr("class","background").attr("fill","#DDD").attr("fill-opacity",.5).attr("width","100%").attr("height","100%");var contents=firsttime.append("svg").attr("class","minimap");contents.append("g").attr("class","contents"),contents.append("rect").attr("class","viewfinder").attr("stroke","black").attr("fill","black").attr("opacity",.1),svg.attr("width",width.call(this,data)),svg.attr("height",height.call(this,data)),svg.attr("x",x.call(this,data)),svg.attr("y",y.call(this,data)),draw.call(svg.select(".contents").node(),data);var curbbox=svg.select(".contents").node().getBBox(),bbox={x:curbbox.x-50,y:curbbox.y-50,width:curbbox.width+100,height:curbbox.height+100};svg.select(".minimap").attr("viewBox",bbox.x+" "+bbox.y+" "+bbox.width+" "+bbox.height),contents.select(".viewfinder").attr("x",bbox.x).attr("y",bbox.y).attr("width",bbox.width).attr("height",bbox.height)})}var width=d3.functor(100),height=d3.functor(100),x=d3.functor(0),y=d3.functor(0),draw=function(d){var ctx=this;d3.selectAll(d3.select(d).select("svg").node().childNodes).each(function(){ctx.appendChild(this.cloneNode(!0))})};return minimap.draw=function(_){return arguments.length?(draw=_,minimap):draw},minimap.width=function(_){return arguments.length?(width=d3.functor(_),minimap):width},minimap.height=function(_){return arguments.length?(height=d3.functor(_),minimap):height},minimap.x=function(_){return arguments.length?(x=d3.functor(_),minimap):x},minimap.y=function(_){return arguments.length?(y=d3.functor(_),minimap):y},minimap}