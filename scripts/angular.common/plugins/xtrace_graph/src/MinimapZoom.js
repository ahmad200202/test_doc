function MinimapZoom(params){function zoom(mainSVG,minimapSVG){mainSVG.call(mainZoom).on("dblclick.zoom",null),minimapSVG&&minimapSVG.call(minimapZoom)}var cb=null,mainZoom=d3.behavior.zoom().on("zoom",function(){isNaN(d3.event.translate[0])||isNaN(d3.event.translate[1])||(zoom.scale(d3.event.scale).translate(d3.event.translate),cb&&cb())}),minimapZoom=d3.behavior.zoom().on("zoom",function(){var mouse=d3.mouse(d3.select(this).select(".minimap").node()),viewport=d3.select(this).select(".viewfinder").node().getBBox(),w=viewport?viewport.width:0,h=viewport?viewport.height:0,scale=zoom.scale(),tx=scale*(w/2-mouse[0]),ty=scale*(h/2-mouse[1]);d3.event.scale=scale,d3.event.translate=[tx,ty],zoom.translate(d3.event.translate),cb&&cb()}).scaleExtent([1,1]);return zoom.translate=function(_){return arguments.length?(mainZoom.translate(_),minimapZoom.translate([0,0]),zoom):mainZoom.translate()},zoom.scale=function(_){return arguments.length?(mainZoom.scale(_),minimapZoom.scale(1),zoom):mainZoom.scale()},zoom.scaleExtent=function(_){return arguments.length?(mainZoom.scaleExtent(_),zoom):mainZoom.scaleExtent()},zoom.on=function(type,_){return"zoom"!=type?zoom:null==_?cb:(cb=_,params.show_console_logs&&console.log("returning",zoom),zoom)},zoom.getTransform=function(box){var startx=(box.x+box.width/2-zoom.translate()[0])/zoom.scale(),starty=(box.y+box.height/2-zoom.translate()[1])/zoom.scale(),startscale=.5/zoom.scale();return"translate("+startx+","+starty+") scale("+startscale+")"},zoom}