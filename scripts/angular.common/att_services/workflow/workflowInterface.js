!function(global){"use strict";function handelSelection(graph,selectedItems,item,onlyOneItemSelected,isCtrlKey){if(selectedItems)if(onlyOneItemSelected)selectedItems.length=0,graph.getRootElement().selectAll(".node.selected").classed("selected",!1),graph.getRootElement().selectAll(".edgeContainer.selected").classed("selected",!1),d3.select(this).classed("selected",!0),selectedItems.push(item);else{var selected=!1;if(isCtrlKey?selected=d3.select(this).classed("selected"):(selectedItems.length=0,graph.getRootElement().selectAll(".node.selected").classed("selected",!1),graph.getRootElement().selectAll(".edgeContainer.selected").classed("selected",!1)),d3.select(this).classed("selected",!selected),selected){var index=ArrayUtils.indexOfByNestedProperty(selectedItems,"data.id",item.data.id);-1!=index&&selectedItems.splice(index,1)}else selectedItems.push(item)}}function canBeSelected(item){var node=item.data;return node.original_type==DO.WorkflowPublicDefTypeIds.EndNode||node.original_type==DO.WorkflowPublicDefTypeIds.StartNode?!1:!0}global.WorkFlow=global.WorkFlow||{},global.WorkFlow.Interface={},global.WorkFlow.Interface.createGraph=function(nodes,edges,options){var _defaultOptions={targetElement:$("body")[0],layoutOptions:{nodeSep:50,edgeSep:50,rankSep:150,rankDir:"LR"}};options=$.extend({},_defaultOptions,options);var graphData={nodes:nodes,edges:edges},graph=new AttuGraph.GraphComponent(options.targetElement,graphData,{layout:new WorkFlow.layouts.workflowLayout(options.layoutOptions),zoomPanEnabled:!0,dynamic:options.isDynamicGraph,onNodeContextMenu:options.onNodeContextMenu,onGraphContextMenu:options.onGraphContextMenu,onEdgeContextMenu:options.createArrowsCtxMenu,onAfterGraphAction:options.onAfterGraphAction,minZoomVal:options.minZoomVal,maxZoomVal:options.maxZoomVal,onNodeDragEnd:options.onNodeDragEnd,edgeIdFn:function(edge){if(edge.id)return edge.id;var id=edge.source.id+"_"+edge.target.id;return edge.type&&(id+="_"+edge.type),id},onAfterDraw:function(nodes,edges){global.WorkFlow.WorkflowBuilder.updateVisuals(nodes,edges)},onZoomEnd:options.onZoomEnd,nodeEvents:{click:function(d){var item={type:"Node",data:d};canBeSelected(item)&&(handelSelection.call(this,graph,options.selectedItems,item,!options.isMultipleSelection,d3.event.ctrlKey||d3.event.metaKey),options.onNodeClickCallback&&options.onNodeClickCallback(d),global.WorkFlow.events.onNodeClick&&global.WorkFlow.events.onNodeClick(d,this,graph))},dblclick:function(d){options.onNodeDblClickCallback&&options.onNodeDblClickCallback(d,this,graph)}},edgeEvents:{click:function(d){var item={type:"Edge",data:d};handelSelection.call(this,graph,options.selectedItems,item,!options.isMultipleSelection,d3.event.ctrlKey||d3.event.metaKey),global.WorkFlow.events.onEdgeClick&&global.WorkFlow.events.onEdgeClick(d,this,graph)}}});return graph}}(this);