!function(angular){"use strict";var attExpressionBuilderModule=angular.module("attExpressionBuilder",["attServices.common"]);return AttServicesConstants.expresssionBuilderMethods={describeExpression:"describeExpression",testExpression:"testExpression",inspectExpression:"inspectExpression",renderExpression:"renderExpression"},attExpressionBuilderModule.factory("att_expression_builder_factory_service",["modalService","InvokerService",function(modalService,InvokerService){var expressionBuilderService={data:{regex:{dollar:/\${(.*?)\}/gim,double_dollar:/\${2,}{(.*?)\}/gim},exp_param_prefix:"${",exp_param_suffix:"}",full_view:!0,use_aliases:!1,hasPath:!1,aliasObj:{},currentExpressionBuilderData:{},currentExpressionBuilderOperators:["+","-","*","/","%","!=","==","||","AND","OR"],currentExpression:"",infoData:{},showHeaderDescription:!1,showColumnSubType:!1,columnSubType:void 0,buttonsText:{test:"Test Expression",parse:"Parse Expression",show_data:"Show Data",render_expression:null}},REQ_describeExpression:function(ctx,successCallback,errorCallback){InvokerService.invokeServiceMethod(ctx,AttServicesConstants.expresssionBuilderMethods.describeExpression,successCallback,errorCallback)},REQ_testExpressionParameters:function(ctx,successCallback,errorCallback){InvokerService.invokeServiceMethod(ctx,AttServicesConstants.expresssionBuilderMethods.testExpression,successCallback,errorCallback)},REQ_inspectExpression:function(ctx,successCallback,errorCallback){InvokerService.invokeServiceMethod(ctx,AttServicesConstants.expresssionBuilderMethods.inspectExpression,successCallback,errorCallback)},REQ_renderExpression:function(ctx,successCallback,errorCallback){InvokerService.invokeServiceMethod(ctx,AttServicesConstants.expresssionBuilderMethods.renderExpression,successCallback,errorCallback)},originalHint:CodeMirror.hint.sql,setExpressionBuilderData:function(data,operators){expressionBuilderService.data.currentExpressionBuilderData=data,null!=operators&&(expressionBuilderService.data.currentExpressionBuilderOperators=operators)},getExpressionBuilderData:function(){return expressionBuilderService.data.currentExpressionBuilderData},getExpressionBuilderAllowedOperators:function(){return expressionBuilderService.data.currentExpressionBuilderOperators},getCurrentExpression:function(){return expressionBuilderService.data.currentExpression},setCurrentExpression:function(expression){return expressionBuilderService.data.currentExpression=expression},setExpressionInfoData:function(infoData){ObjectUtils.deepMixIn(expressionBuilderService.data.infoData,infoData),ArrayUtils.emptyArray(expressionBuilderService.data.infoData.params),ArrayUtils.appendArrayToArray(expressionBuilderService.data.infoData.params,infoData.params)},getExpressionInfoData:function(){return expressionBuilderService.data.infoData},getTextWithPrefixSuffix:function(text){return expressionBuilderService.data.exp_param_prefix+text+expressionBuilderService.data.exp_param_suffix},getTextWithOutPrefixSuffix:function(text){return null==text&&(text=""),text.replace(expressionBuilderService.data.exp_param_prefix,"").replace(expressionBuilderService.data.exp_param_suffix,"")},getExpressionAliases:function(){var res=[];return null==expressionBuilderService.data.infoData||0==Object.keys(expressionBuilderService.data.infoData).length?res:(ObjectUtils.forOwn(expressionBuilderService.data.aliasObj,function(key,value){var foundInParams=ArrayUtils.find(expressionBuilderService.data.infoData.params,function(itar){return itar.parameter==key});value&&null!=value[expressionBuilderService.data.alias_parameter_var]&&foundInParams&&res.push({alias_name:expressionBuilderService.getTextWithPrefixSuffix(key),alias_parameter:value[expressionBuilderService.data.alias_parameter_var]})}),res)},checkExpressionForAlias:function(){for(var expressionParams=expressionBuilderService.parseExpressionIntern(expressionBuilderService.getCurrentExpression()),i=0;null!=expressionParams&&i<expressionParams.length;i++){var paramTxt=expressionBuilderService.getTextWithOutPrefixSuffix(expressionParams[i]);if(null==expressionBuilderService.data.aliasObj[paramTxt]){var j=0;if(expressionBuilderService.data.hasPath)for(j=0;j<expressionBuilderService.data.tablesPaths.length;j++)for(var tablesPath=expressionBuilderService.data.tablesPaths[j],k=0;k<expressionBuilderService.data.tablesAttributes[tablesPath].length;k++){var fullName=tablesPath+"."+expressionBuilderService.data.tablesAttributes[tablesPath][k][DO.TableColumnDto.attribute_name];if(paramTxt==fullName){expressionBuilderService.data.aliasObj[paramTxt]=expressionBuilderService.data.tablesAttributes[tablesPath][k],j=expressionBuilderService.data.tablesPaths.length;break}}else for(j=0;j<expressionBuilderService.data.currentExpressionBuilderData[0].group_items[0].items.length;j++){var attribute=expressionBuilderService.data.currentExpressionBuilderData[0].group_items[0].items[j];if(paramTxt==attribute.name){expressionBuilderService.data.aliasObj[paramTxt]=attribute;break}}}}},showExpressionBuilder:function(params,finishCallback,onBeforeCloseCallback){expressionBuilderService.data.full_view=params.full_view,expressionBuilderService.data.use_aliases=params.use_aliases,expressionBuilderService.data.showHeaderDescription=params.showHeaderDescription||!1,expressionBuilderService.data.showColumnSubType=params.showColumnSubType||!1,expressionBuilderService.data.columnName=params.columnName,expressionBuilderService.data.columnType=params.columnType,expressionBuilderService.data.selected_tab_index=params.selected_tab_index||0,expressionBuilderService.data.columnSubType=expressionBuilderService.data.showColumnSubType&&params.columnSubType||void 0,params.buttonsText&&(params.buttonsText.parse&&(expressionBuilderService.data.buttonsText.parse=params.buttonsText.parse),params.buttonsText.test&&(expressionBuilderService.data.buttonsText.test=params.buttonsText.test),params.buttonsText.show_data&&(expressionBuilderService.data.buttonsText.show_data=params.buttonsText.show_data),params.buttonsText.render_expression&&(expressionBuilderService.data.buttonsText.render_expression=params.buttonsText.render_expression)),params.use_aliases&&(expressionBuilderService.prepareAliasObj(params),expressionBuilderService.data.hasPath=params.hasPath,expressionBuilderService.data.alias_parameter_var=params.alias_parameter_var),expressionBuilderService.data.tablesPaths=params.tablesPaths,expressionBuilderService.data.tablesAttributes=params.tablesAttributes,expressionBuilderService.setExpressionBuilderData(params.expressionBuilderData,params.operators),expressionBuilderService.setCurrentExpression(params.expression);var title=null==params.title?"Expression Builder":params.title,popup_css_class=null==params.popup_css_class?"":params.popup_css_class;modalService.showModal({contentTemplate:"scripts/angular.common/att_services/expressionBuilder/expressionBuilderTemplate.html",headerText:title,actionButtonText:"OK",minWidth:900,resizable:!0,isValid:function(){return params.use_aliases?!0:this.model.isValid()},model:{expressionBuilderCtx:params.CONTEXT,isValid:function(){var valid=!0,has_expression=null!=expressionBuilderService.data.currentExpression&&""!=expressionBuilderService.data.currentExpression,data_valid=null!=expressionBuilderService.data.infoData&&null!=expressionBuilderService.data.infoData.params,match=expressionBuilderService.parseExpressionIntern(expressionBuilderService.data.currentExpression);if(has_expression)if(params.full_view)if(null!=match&&data_valid&&params.use_aliases&&ArrayUtils.unique(match).length==expressionBuilderService.data.infoData.params.length)for(var i=0;i<expressionBuilderService.data.infoData.params.length;i++)null==expressionBuilderService.data.aliasObj[expressionBuilderService.data.infoData.params[i].parameter]&&(valid=!1);else valid=null==match?params.use_aliases?has_expression&&data_valid&&0==expressionBuilderService.data.infoData.params.length:has_expression:data_valid&&ArrayUtils.unique(match).length==expressionBuilderService.data.infoData.params.length;else valid=data_valid&&ArrayUtils.unique(match).length==expressionBuilderService.data.infoData.params.length;return valid}},onBeforeOk:function(vm,okCallback){if(""!=expressionBuilderService.getCurrentExpression()){var self=this;params.use_aliases&&expressionBuilderService.checkExpressionForAlias(),this.model.expressionBuilderCtx.describeExpression.params.options.expression=expressionBuilderService.getCurrentExpression(),expressionBuilderService.describeExpression(this.model.expressionBuilderCtx,function(){expressionBuilderService.data.infoData.is_valid&&self.closeDialog(okCallback)})}else this.closeDialog(okCallback)},closeDialog:function(okCallback){finishCallback&&finishCallback(expressionBuilderService.getCurrentExpression(),expressionBuilderService.getExpressionInfoData(),expressionBuilderService.getExpressionAliases(),this.model.isValid()),okCallback&&okCallback(),this.clearExpressionInfoData()},onBeforeClose:function(vm,closeCallback){onBeforeCloseCallback?onBeforeCloseCallback(expressionBuilderService.getCurrentExpression(),expressionBuilderService.getExpressionInfoData(),expressionBuilderService.getExpressionAliases(),closeCallback):closeCallback(),this.clearExpressionInfoData()},clearExpressionInfoData:function(){ObjectUtils.isEmpty(expressionBuilderService.data.infoData)||(ArrayUtils.emptyArray(expressionBuilderService.data.infoData.params),expressionBuilderService.data.infoData={})}},{windowClass:"expressionBuilderPopup "+popup_css_class})},describeExpression:function(expressionBuilderCtx,onSuccessFunc){expressionBuilderService.REQ_describeExpression(expressionBuilderCtx,function(data){expressionBuilderService.setExpressionInfoData(data),onSuccessFunc&&onSuccessFunc(data)},function(){})},prepareAliasObj:function(params){expressionBuilderService.data.aliasObj={};for(var i=0;i<params.aliases.length;i++){var aliasName=params.aliases[i].alias_name.replace(params.inputColumns.prefix,"").replace(params.inputColumns.suffix,"");expressionBuilderService.data.aliasObj[aliasName]=params.full_view?expressionBuilderService.findTableColumn(params.aliases[i].alias_parameter,params):params.aliases[i].alias_parameter}},findTableColumn:function(path,params){var i=0;if(params.hasPath){for(var table in params.tablesAttributes)for(i=0;i<params.tablesAttributes[table].length;i++)if(params.tablesAttributes[table][i].path==path)return params.tablesAttributes[table][i]}else for(i=0;i<params.expressionBuilderData[0].group_items[0].items.length;i++){var item=params.expressionBuilderData[0].group_items[0].items[i];if(item[params.alias_parameter_var]==path)return item}},parseExpressionIntern:function(expression){null==expression&&(expression="");var matchToIgnore=expression.match(expressionBuilderService.data.regex.double_dollar),exp_to_validate=expression;return ArrayUtils.each(matchToIgnore,function(it){exp_to_validate=exp_to_validate.replaceAll(it,"")}),exp_to_validate.match(expressionBuilderService.data.regex.dollar)}};return expressionBuilderService}]),attExpressionBuilderModule.controller("att_expression_builder_Ctrl",["$scope","$timeout","att_expression_builder_factory_service","locale",function($scope,$timeout,att_expression_builder_factory_service,locale){var codeMirrorTimeout=null;if($scope.$on("$destroy",function(){$timeout.cancel(codeMirrorTimeout),codeMirrorTimeout=null}),$scope.ExpressionsInfoData=att_expression_builder_factory_service.data.infoData,$scope.Expression=att_expression_builder_factory_service.getCurrentExpression(),$scope.ExpressionGroups=att_expression_builder_factory_service.getExpressionBuilderData(),$scope.ExpressionEditorAllowedOperators=att_expression_builder_factory_service.getExpressionBuilderAllowedOperators(),$scope.use_aliases=att_expression_builder_factory_service.data.use_aliases,$scope.hasPath=att_expression_builder_factory_service.data.hasPath,$scope.showHeaderDescription=att_expression_builder_factory_service.data.showHeaderDescription,$scope.showColumnSubType=att_expression_builder_factory_service.data.showColumnSubType||!1,$scope.step1header=locale.getString("common.base.ExpressionBuilder_BuildExpression"),void 0!=att_expression_builder_factory_service.data.columnType){var columnTypeDisplayName=att_expression_builder_factory_service.data.columnType,subTypeText=$scope.showColumnSubType&&![void 0,"",DO.ar_sub_data_type_options_displayNames.KAR_SUB_DATA_TYPE_UNSPECIFIED].includes(att_expression_builder_factory_service.data.columnSubType)?locale.getString("common.base.SubType").toLowerCase()+" '"+att_expression_builder_factory_service.data.columnSubType+"'":"";$scope.step1header+=locale.getString("common.base.ExpressionBuilder_step1_header",[att_expression_builder_factory_service.data.columnName,columnTypeDisplayName,subTypeText])}$scope.buttons_texts=att_expression_builder_factory_service.data.buttonsText;var columnsGroupIndex=ArrayUtils.indexOfByProperty($scope.ExpressionGroups,"group_name","Columns");if($scope.use_aliases){$scope.AliasObj=att_expression_builder_factory_service.data.aliasObj;var tables=[];$scope.hasPath?($scope.pathSourceArray=att_expression_builder_factory_service.data.tablesPaths,$scope.tablesAttributesDic=att_expression_builder_factory_service.data.tablesAttributes,ObjectUtils.forOwn($scope.tablesAttributesDic,function(key,value){ArrayUtils.each(value,function(it){tables.push(it.attribute_name)})})):ArrayUtils.each(att_expression_builder_factory_service.data.currentExpressionBuilderData[0].group_items[0].items,function(it){tables.push(it.name)}),CodeMirror.hint.sql=function(cm){var options={tables:tables},inner=att_expression_builder_factory_service.originalHint(cm,options)||{from:cm.getCursor(),to:cm.getCursor(),list:[]};return inner}}$scope.TableApi={onRowDblClick:function(rowData){$scope.onAddTableItem(null,rowData)},dataLoaded:function(){$scope.showHideColumn&&""!==$scope.showHideColumn.name&&$scope.TableApi.showHideColumn&&($scope.TableApi.showHideColumn($scope.showHideColumn.name,$scope.showHideColumn.show),$scope.showHideColumn.show=!1,$scope.showHideColumn.name="")}},$scope.full_view=att_expression_builder_factory_service.data.full_view,$scope.EvaluatedExpression="",$scope.codeMirroeElementID="attExpressionBuilder",codeMirrorTimeout=$timeout(function(){try{var instance=Utils.GetCodeMirrorInstance(null);instance&&instance.focus()}catch(err){}},100),$scope.onEditorCommand=function(action){var instance=Utils.GetCodeMirrorInstance(null);if(instance)switch(action=action.toLowerCase()){case"redo":instance.redo();break;case"undo":instance.undo()}},$scope.selectionData={selected_group_index:0,selected_operator_category:0,selected_operator_index:0},$scope.editorOptions={mode:"text/x-mysql",lineNumbers:!1,matchBrackets:!0,extraKeys:{"Ctrl-Space":"autocomplete"},autofocus:!0,smartIndent:!0};$scope.codemirrorLoaded=function(_editor){_editor.getDoc();_editor.focus(),$scope.use_aliases&&_editor.on("change",function(instance,changeEv){for(var match,patt=att_expression_builder_factory_service.data.regex.dollar;match=patt.exec(att_expression_builder_factory_service.data.currentExpression);)if(match.index<changeEv.to.ch&&match.index+match[0].length>changeEv.to.ch&&null!=$scope.AliasObj[match[1]]){var newAlias=match[1],changeIndex=changeEv.to.ch-match.index-2;"+delete"==changeEv.origin?newAlias=newAlias.substring(0,changeIndex)+newAlias.substring(changeIndex+1,newAlias.length):"+input"==changeEv.origin&&(newAlias=newAlias.substring(0,changeIndex)+changeEv.text[0]+newAlias.substring(changeIndex,newAlias.length),changeEv.removed[0].length>0&&(newAlias=newAlias.substring(0,changeEv.from.ch-2)+newAlias.substring(changeEv.to.ch-2,newAlias.length))),match[1]!=newAlias&&($scope.AliasObj[newAlias]=$scope.AliasObj[match[1]],delete $scope.AliasObj[match[1]])}})},$scope.selectedTabIndex=att_expression_builder_factory_service.data.selected_tab_index,$scope.showHideColumn={name:"",show:!1};var _tableApiShowHideColumn=function(colName,showCol){$scope.showHideColumn.name=colName,$scope.showHideColumn.show=showCol,$scope.TableApi.showHideColumn&&$scope.TableApi.showHideColumn(colName,showCol)},_showHideSubType=function(tabIndex){var subTypeColName=locale.getString("common.base.SubType");if(!$scope.showColumnSubType)return void _tableApiShowHideColumn(subTypeColName,!1);var isShowHideSubTypeRelevant=$scope.TableApi.showHideColumn&&2>=tabIndex;isShowHideSubTypeRelevant&&_tableApiShowHideColumn(subTypeColName,0==tabIndex)},_onSelectedTabChange=function(tabIndex){$scope.selectionData.selected_group_index=tabIndex,$scope.selectedTabIndex=tabIndex,$scope.TableApi.selectedItems&&ArrayUtils.emptyArray($scope.TableApi.selectedItems)};$scope.onGroupItemClick=function($index){$scope.selectionData.selected_group_index<=2?(_showHideSubType($index),setTimeout(function(){_onSelectedTabChange($index)},0)):(_onSelectedTabChange($index),setTimeout(function(){_showHideSubType($index)},0))},$scope.refresh=!1;var addText=function(text,checkPrePostFix){var instance=Utils.GetCodeMirrorInstance(null),prefix="",suffix="",text_to_add="";if(instance){{instance.getCursor(!0),instance.getCursor(!1)}checkPrePostFix&&(prefix=$scope.ExpressionGroups[$scope.selectionData.selected_group_index].group_prefix,suffix=$scope.ExpressionGroups[$scope.selectionData.selected_group_index].group_suffix),text_to_add=prefix+text+suffix,instance.replaceSelection(text_to_add),instance.focus()}return text_to_add};$scope.onAddTableItem=function($event,rowData){var name="";name=null==rowData.display_name||""==rowData.display_name?rowData.name:rowData.display_name,$scope.selectionData.selected_group_index==columnsGroupIndex&&(name=name.replaceAll(" ","_"));addText(name,!0);att_expression_builder_factory_service.data.use_aliases&&(att_expression_builder_factory_service.data.aliasObj[rowData.name]=$scope.hasPath?rowData.item_data:rowData)},$scope.onAddListItem=function(rowData){addText(rowData.name,!0)},$scope.onAddActionBarItem=function(btn){addText(btn,!1)},$scope.canDescribeExpression=function(){return null!=$scope.vm&&null!=$scope.vm.expressionBuilderCtx&&null!=$scope.vm.expressionBuilderCtx.describeExpression&&!$scope.use_aliases},$scope.onDescribeExpression=function(){att_expression_builder_factory_service.data.use_aliases&&att_expression_builder_factory_service.checkExpressionForAlias(),""!=att_expression_builder_factory_service.getCurrentExpression()&&($scope.vm.expressionBuilderCtx.describeExpression.params.options.expression=att_expression_builder_factory_service.getCurrentExpression(),att_expression_builder_factory_service.describeExpression($scope.vm.expressionBuilderCtx,function(data){if($scope.use_aliases)for(var i=0;i<data.params.length;i++)null!=$scope.AliasObj[data.params[i].parameter]?($scope.hasPath&&(data.params[i].tablePath=$scope.AliasObj[data.params[i].parameter].table_path),data.params[i].attribute=$scope.AliasObj[data.params[i].parameter],data.params[i].type=$scope.AliasObj[data.params[i].parameter].display_type,data.params[i].orginalParamName=data.params[i].parameter,null!=att_expression_builder_factory_service.data&&null!=att_expression_builder_factory_service.data.infoData&&null!=att_expression_builder_factory_service.data.infoData.params&&ArrayUtils.each(att_expression_builder_factory_service.data.infoData.params,function(it){it.parameter==data.params[i].parameter&&(data.params[i].value=it.value)})):att_expression_builder_factory_service.data.full_view||(data.params[i].orginalParamName=data.params[i].parameter,$scope.AliasObj[data.params[i].parameter]=data.params[i])}))},$scope.canTestExpression=function(){return null!=$scope.vm&&null!=$scope.vm.expressionBuilderCtx&&null!=$scope.vm.expressionBuilderCtx.testExpression},$scope.testExpressionDisabled=function(check_value_to_test){var ret=""==att_expression_builder_factory_service.getCurrentExpression()||null==$scope.ExpressionsInfoData||1!=$scope.ExpressionsInfoData.is_valid;if($scope.use_aliases){var match=att_expression_builder_factory_service.parseExpressionIntern(att_expression_builder_factory_service.getCurrentExpression()),valid_params=null!=$scope.ExpressionsInfoData.params&&ArrayUtils.unique(match).length==$scope.ExpressionsInfoData.params.length;ret=ret||1!=valid_params||null==$scope.ExpressionsInfoData.params.length||$scope.ExpressionsInfoData.params.filter(function(it){return check_value_to_test?""!=it.value:null!=it.attribute&&""!=it.attribute.name}).length!=$scope.ExpressionsInfoData.params.length}return ret},$scope.onTestExpression=function(){if(null!=$scope.ExpressionsInfoData.params&&1==$scope.ExpressionsInfoData.is_valid){$scope.vm.expressionBuilderCtx.testExpression.params.options.expression=att_expression_builder_factory_service.getCurrentExpression();var params=[];$scope.use_aliases?(ArrayUtils.each($scope.ExpressionsInfoData.params,function(it){params.push(ObjectUtils.pick(it,"parameter","type","value"))}),$scope.vm.expressionBuilderCtx.testExpression.params.options.aliasObj=$scope.AliasObj):params=$scope.ExpressionsInfoData.params,$scope.vm.expressionBuilderCtx.testExpression.params.options.expression_parameters=params,att_expression_builder_factory_service.REQ_testExpressionParameters($scope.vm.expressionBuilderCtx,function(data){$scope.EvaluatedExpression=ObjectUtils.isObject(data)?data[DO.TestExpressionResp.result]:data},function(){return!0})}},$scope.canInspectExpression=function(){return null!=$scope.vm&&null!=$scope.vm.expressionBuilderCtx&&null!=$scope.vm.expressionBuilderCtx.inspectExpression},$scope.onInspectExpression=function(){null!=$scope.vm.expressionBuilderCtx&&($scope.vm.expressionBuilderCtx.inspectExpression.params.options.expression=att_expression_builder_factory_service.getCurrentExpression(),$scope.vm.expressionBuilderCtx.inspectExpression.params.options.aliases=att_expression_builder_factory_service.getExpressionAliases()),att_expression_builder_factory_service.REQ_inspectExpression($scope.vm.expressionBuilderCtx)},$scope.onRenderExpression=function(){null!=$scope.vm.expressionBuilderCtx&&($scope.vm.expressionBuilderCtx.renderExpression.params.options.expression=att_expression_builder_factory_service.getCurrentExpression(),$scope.vm.expressionBuilderCtx.renderExpression.params.options.aliases=att_expression_builder_factory_service.getExpressionAliases()),att_expression_builder_factory_service.REQ_renderExpression($scope.vm.expressionBuilderCtx)},$scope.canRenderExpression=function(){var valid=""!=att_expression_builder_factory_service.getCurrentExpression()&&null!=$scope.ExpressionsInfoData&&$scope.ExpressionsInfoData.is_valid,match=att_expression_builder_factory_service.getCurrentExpression().match(att_expression_builder_factory_service.data.regex.double_dollar);return valid&&null!=match},$scope.onChange=function(Expression){att_expression_builder_factory_service.setCurrentExpression(Expression),""==Expression&&null!=$scope.ExpressionsInfoData&&null!=$scope.ExpressionsInfoData.params&&($scope.ExpressionsInfoData.params.splice(0,$scope.ExpressionsInfoData.params.length),$scope.EvaluatedExpression="",$scope.ExpressionsInfoData.message="")},""!=$scope.Expression&&$scope.use_aliases&&$scope.onDescribeExpression(),$scope.attributeChanged=function(rowData,attribute){$scope.AliasObj[rowData.parameter]=attribute},$scope.tablePathChanged=function(rowData,tablePath){rowData.attribute=$scope.tablesAttributesDic[tablePath][0],$scope.AliasObj[rowData.parameter]=rowData.attribute},$scope.paramNameChanged=function(rowData){$scope.AliasObj[rowData.parameter]=$scope.AliasObj[rowData.orginalParamName];var instance=Utils.GetCodeMirrorInstance(null),exp=instance.getValue();exp=exp.replaceAll(att_expression_builder_factory_service.getTextWithPrefixSuffix(rowData.orginalParamName),att_expression_builder_factory_service.getTextWithPrefixSuffix(rowData.parameter)),delete $scope.AliasObj[rowData.orginalParamName],rowData.orginalParamName=rowData.parameter,instance.setValue(exp)}}]),attExpressionBuilderModule}(angular);