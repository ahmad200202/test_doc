!function(angular){"use strict";function isDescendant(parent,child,maxIterations){var node=child.parentNode;for(null==maxIterations&&(maxIterations=100);null!=node&&maxIterations>0;){if(node==parent)return!0;node=node.parentNode,maxIterations--}return!1}var app=angular.module("attCommon.commonDirectives",["infinite-scroll"]);app.run(["$templateCache",function($templateCache){$templateCache.put("taskGlobalLayeredSettings.html",'<layered-settings-view class="H100W100 mainLeftRightPadding" view-model="vm"></layered-settings-view>')}]),app.directive("dynamicCtrl",["$compile","$parse",function($compile,$parse){return{restrict:"A",terminal:!0,priority:1e5,link:function(scope,elem){var name=$parse(elem.attr("dynamic-ctrl"))(scope);elem.removeAttr("dynamic-ctrl"),name&&""!=name&&(elem.attr("ng-controller",name),$compile(elem)(scope))}}}]),app.directive("attButton",function(){return{restrict:"E",scope:!1,replace:!0,template:function(element,attrs){var template="";return(null==attrs.textPosition||""==attrs.textPosition)&&(attrs.textPosition="right"),null==attrs.buttonClass&&(attrs.buttonClass=""),null==attrs.glyphClass&&(attrs.glyphClass=""),null==attrs.label&&(attrs.label=""),null!=attrs.type&&"glyph"==attrs.type?null==attrs.onClick?(template='<button class="attBtn glyphButton text-{0} {1}" ><span class="{2}"></span><span class="inner-text" i18n="{3}"></span></button>',template=String.format(template,attrs.textPosition,attrs.buttonClass,attrs.glyphClass,attrs.label)):(template='<button class="attBtn glyphButton text-{0} {1}" ng-click="{2}" ><span class="{3}"></span><span class="inner-text" i18n="{4}"></span></button>',template=String.format(template,attrs.textPosition,attrs.buttonClass,attrs.onClick,attrs.glyphClass,attrs.label)):null==attrs.onClick?(template='<button class="attBtn {0}" i18n="{1}"></button>',template=String.format(template,attrs.buttonClass,attrs.label)):(template='<button class="attBtn {0}" ng-click="{1}" i18n="{2}"></button>',template=String.format(template,attrs.buttonClass,attrs.onClick,attrs.label)),template}}}),app.directive("attProgressBar",[function(){return{scope:{isVertical:"@",fillColor:"@",value:"@",showStacked:"=",stackedValue:"@",stackedFill:"@",isAnimated:"=",onDblClickFnc:"&"},restrict:"E",replace:!0,template:'<div class="attProgressBarContainer" style=\'overflow: hidden;\'><div class="attVerticalProgressBar" ng-if="isVertical==\'true\'" ng-dblclick="onProgressDblClick()"><div class="attProgressBarFill {{fillColor}}" ng-Class="{DefaultBarFill:(fillColor.length == 0) ,  animated:isAnimated}" ng-style="getStyleByValue()"></div></div><div class="attHorizontalProgressBar" ng-if="isVertical==\'false\'" ng-dblclick="onProgressDblClick()"><div class="attProgressBarFill {{fillColor}}" ng-Class="{DefaultBarFill:(fillColor.length == 0) , animated:isAnimated}" ng-style="getStyleByValue()"></div><div ng-if="showStacked" class="attProgressBarFill" ng-Class="stackedFill" ng-style="getAltStyleByValue()"></div></div></div>',link:function(scope){scope.getStyleByValue=function(){var styleValue=scope.value+"%",styleObj={};return"false"==scope.isVertical?(styleObj.width=styleValue,scope.showStacked&&(styleObj["border-top-right-radius"]="0px",styleObj["border-bottom-right-radius"]="0px")):styleObj.height=styleValue,styleObj},scope.getAltStyleByValue=function(){return{width:String(parseInt(scope.value)+parseInt(scope.stackedValue))+"%","border-top-left-radius":"0px","border-bottom-left-radius":"0px"}},scope.onProgressDblClick=function(){scope.onDblClickFnc&&scope.onDblClickFnc()}}}}]),app.directive("attInfoTip",["locale",function(){return{restrict:"E",template:'<span ng-class="{\'disabled\' : infoDisabled}" style="cursor: help; color: #3D9BDF;top: -4px;" class="att-info-tip bootstrapGlyphicon glyphicon-info-sign" att-custom-tooltip custom-tooltip-resource-text="{{infoText}}" tip-text-token="{{infoToken}}"></span>',scope:{infoText:"@",infoToken:"@",infoDisabled:"="},link:function(scope){null==scope.infoToken&&(scope.infoToken="''")}}}]),app.directive("attNumberStepper",["$document","$interval","$timeout",function($document,$interval){return{restrict:"E",scope:{numberData:"=",min:"=?",max:"=?",step:"=?",ngDisabled:"=?",stepperType:"@",inputName:"@",afterChange:"&",onBlur:"&",cssClass:"@",intervalMili:"=?",leadZeroGetter:"&leadZero"},replace:!0,template:function(element,attrs){return"inline"==attrs.stepperType||null==attrs.stepperType?'<div class="attStepperStyle attStepperStyleInline {{cssClass}}"><input ng-model="numberData" name="{{inputName}}" ng-change="onInnerChange()" autocomplete=\'off\' ng-keydown=\'onKeyDown($event)\' ng-blur="onNumberBlur(\'{{numberData}}\')" type="text" class="stepperInput" ng-disabled="ngDisabled"><div class="stepperButtonsWrap btn-group btn-group-vertical"><span ng-mousedown="onArrowIncrement(numberData)" type="button" class="btn btnUp spinner-up" ng-disabled="ngDisabled"><i class="bootstrapGlyphicon glyphicon-chevron-up"></i></span><span ng-mousedown="onArrowDecrement(numberData)" type="button" class="btn btnDown spinner-down" ng-disabled="ngDisabled"><i class="bootstrapGlyphicon glyphicon-chevron-down"></i></span></div></div>':"fullsize"==attrs.stepperType?'<table class="attStepperStyle attStepperStyleFullSize {{cssClass}}"><tr><td><a ng-mousedown="onArrowIncrement(numberData)" class="btn btn-link" ng-disabled="ngDisabled"><span class="bootstrapGlyphicon glyphicon-chevron-up"></span></a></td></tr><tr><td><input type="text" ng-model="numberData" autocomplete=\'off\' ng-change="onInnerChange()" ng-model-options="{debounce: inDebounce }" ng-keydown=\'onKeyDown($event)\' ng-blur="onNumberBlur(\'{{numberData}}\')" name="{{inputName}}" ng-disabled="ngDisabled"></td></tr><tr><td><a ng-mousedown="onArrowDecrement(numberData)" class="btn btn-link" ng-disabled="ngDisabled"><span class="bootstrapGlyphicon glyphicon-chevron-down"></span></a></td></tr></table>':void 0},link:function(scope,element,attrs){function doAfterChange(check_limits){null!=scope.afterChange&&scope.afterChange({newVal:scope.numberData}),check_limits&&checkLimits()}var intervalPromise,afterChangeTimeout=null;null==attrs.afterChange&&(scope.afterChange=null),null==attrs.onBlur&&(scope.onBlur=null);var handleLeadZero=function(value){return scope.leadZero?(parseInt(value)>=0&&parseInt(value)<10&&(value="0"+parseInt(value)),value):value};scope.leadZero=scope.leadZeroGetter(),(null==scope.numberData||isNaN(scope.numberData))&&(scope.numberData=0),(null==scope.step||"number"!=typeof scope.step)&&(scope.step=1),(null==scope.min||"number"!=typeof scope.min)&&(scope.min=0),(null==scope.max||"number"!=typeof scope.max)&&(scope.max=99999999999),null==attrs.intervalMili&&(scope.intervalMili=180),scope.numberData=handleLeadZero(scope.numberData),(null==scope.inDebounce||"number"!=typeof parseInt(scope.inDebounce))&&(scope.inDebounce=750);var stopInterval=function(){angular.isDefined(intervalPromise)&&($interval.cancel(intervalPromise),intervalPromise=void 0,doAfterChange(!0))},onMouseUp=function(){stopInterval(),stopEventWatcher()},startEventWatcher=function(){$document.on("mouseup",onMouseUp),element.on("mouseleave",onMouseUp)},stopEventWatcher=function(){$document.off("mouseup",onMouseUp),element.off("mouseleave",onMouseUp)};scope.$on("$destroy",function(){stopEventWatcher(),$interval.cancel(intervalPromise),afterChangeTimeout=null,intervalPromise=null});var incrementValue=function(){parseInt(scope.numberData)+scope.step<=scope.max?scope.numberData=parseInt(scope.numberData)+scope.step:stopInterval(),parseInt(scope.numberData)+scope.step<scope.min&&(scope.numberData=scope.min,stopInterval()),scope.onInnerChange()},decrementValue=function(){parseInt(scope.numberData)-scope.step>=scope.min?scope.numberData=parseInt(scope.numberData)-scope.step:stopInterval(),parseInt(scope.numberData)-scope.step>scope.max&&(scope.numberData=scope.max,stopInterval()),scope.onInnerChange()};scope.onArrowIncrement=function(){scope.ngDisabled||(startEventWatcher(),incrementValue(),intervalPromise=$interval(incrementValue,scope.intervalMili))},scope.onArrowDecrement=function(){scope.ngDisabled||(startEventWatcher(),decrementValue(),intervalPromise=$interval(decrementValue,scope.intervalMili))};var checkLimits=function(){"string"==typeof scope.numberData&&0==scope.numberData.indexOf("-")&&scope.min<0&&1==scope.numberData.length&&(scope.numberData=-1),(null==scope.numberData||""===scope.numberData)&&(scope.numberData=0),null!=scope.numberData&&(scope.numberData=parseInt(scope.numberData)),ObjectUtils.isINT(scope.numberData)||(scope.numberData=scope.numberData>scope.max?scope.max:scope.min),scope.numberData<=scope.min&&(scope.numberData=scope.min,stopInterval()),scope.numberData>=scope.max&&(scope.numberData=scope.max,stopInterval()),scope.numberData=handleLeadZero(scope.numberData)};scope.onNumberBlur=function(){checkLimits(),doAfterChange(!0),null!=scope.onBlur&&scope.onBlur({newVal:scope.numberData})},scope.onInnerChange=function(){null!=scope.min&&scope.min<0?null==scope.numberData||isNaN(parseInt(scope.numberData))||(scope.numberData=parseInt(scope.numberData),doAfterChange(!0)):isNaN(Number(scope.numberData))?(scope.numberData=scope.min,doAfterChange(!0)):doAfterChange(!1)},scope.onKeyDown=function($event){var isCtrlPressed=$event&&($event.ctrlKey===!0||$event.metaKey===!0);if(!(-1!==$.inArray($event.keyCode,[consts.ConstKey.Delete,consts.ConstKey.Backspace,consts.ConstKey.Tab,consts.ConstKey.Esc,consts.ConstKey.Enter,consts.ConstKey.Dot_char,consts.ConstKey.Dot_numpad])||$event.keyCode==consts.ConstKey.A_char&&isCtrlPressed||$event.keyCode==consts.ConstKey.C_char&&isCtrlPressed||$event.keyCode==consts.ConstKey.X_char&&isCtrlPressed||$event.keyCode==consts.ConstKey.V_char&&isCtrlPressed||$event.keyCode==consts.ConstKey.ArrowLeft||$event.keyCode==consts.ConstKey.ArrowRight))if($event.keyCode==consts.ConstKey.ArrowUp)incrementValue();else if($event.keyCode==consts.ConstKey.ArrowDown)decrementValue();else{if(scope.min<0&&($event.keyCode==consts.ConstKey.Minus||$event.keyCode==consts.ConstKey.Minus_numpad))return;($event.shiftKey||$event.keyCode<consts.ConstKey.Zero||$event.keyCode>consts.ConstKey.Nine)&&($event.keyCode<consts.ConstKey.Zero_numpad||$event.keyCode>consts.ConstKey.Nine_numpad)&&$event.preventDefault()}};try{checkLimits()}catch(e){}}}}]),app.directive("attTimeStepper",function(){return{restrict:"E",scope:{data:"=",ngDisabled:"=",minuteStep:"=",secondStep:"=?",cssClass:"@",displaySeconds:"=",afterChange:"&",minHours:"=?",minMinutes:"=?",minSeconds:"=?",maxHours:"=?",maxMinutes:"=?",maxSeconds:"=?"},replace:!0,template:'<div class="attTimeStepperStyle {{cssClass}}"><att-number-stepper number-data="hoursVal"   after-change="setTime(\'Hours\',newVal)"   input-name="hours"   min="minHours" max="maxHours"  ng-disabled="ngDisabled" lead-zero="true"></att-number-stepper><att-number-stepper number-data="minutesVal" after-change="setTime(\'Minutes\',newVal)" input-name="minutes" min="minMinutes" max="maxMinutes"  ng-disabled="ngDisabled" lead-zero="true"></att-number-stepper><att-number-stepper number-data="secondsVal" after-change="setTime(\'Seconds\',newVal)" input-name="seconds" min="minSeconds" max="maxSeconds" ng-disabled="ngDisabled" lead-zero="true" ng-if="displaySeconds !== false"></att-number-stepper></div>',compile:function(){return function(scope,element,attrs){null==attrs.afterChange&&(scope.afterChange=null),null!=scope.data&&angular.isDate(scope.data)||(scope.data=new Date),null==attrs.minHours&&(scope.minHours=0),null==attrs.minMinutes&&(scope.minMinutes=0),null==attrs.minSeconds&&(scope.minSeconds=0),null==attrs.maxHours&&(scope.maxHours=23),null==attrs.maxMinutes&&(scope.maxMinutes=59),null==attrs.maxSeconds&&(scope.maxSeconds=59),(null==scope.minuteStep||"number"!=typeof scope.minuteStep)&&(scope.minuteStep=5),(null==scope.secondStep||"number"!=typeof scope.secondStep)&&(scope.secondStep=10);var addPreNumberZero=function(value){return parseInt(value)>=0&&parseInt(value)<10&&(value="0"+parseInt(value)),value};scope.getTimesElements=function(){scope.hoursVal=addPreNumberZero(scope.data.getHours()),scope.minutesVal=addPreNumberZero(scope.data.getMinutes()),scope.secondsVal=addPreNumberZero(scope.data.getSeconds())},scope.getTimesElements(),scope.setTime=function(setter,newVal){scope["checkMinMaxAndSet"+setter](parseInt(newVal))},scope.checkMinMaxAndSetHours=function(newHoursValue){scope.hoursVal=newHoursValue>scope.maxHours?scope.maxHours:newHoursValue<scope.minHours?scope.minHours:isNaN(newHoursValue)?scope.minHours:newHoursValue,scope.hoursVal=addPreNumberZero(scope.hoursVal),scope.data.setHours(scope.hoursVal),scope.afterChange&&scope.afterChange({data:scope.data})},scope.checkMinMaxAndSetMinutes=function(newMinutesValue){scope.minutesVal=newMinutesValue>scope.maxMinutes?scope.maxMinutes:newMinutesValue<scope.minMinutes?scope.minMinutes:isNaN(newMinutesValue)?scope.minMinutes:newMinutesValue,scope.minutesVal=addPreNumberZero(scope.minutesVal),scope.data.setMinutes(scope.minutesVal),scope.afterChange&&scope.afterChange({data:scope.data})},scope.checkMinMaxAndSetSeconds=function(newSecondsValue){scope.secondsVal=newSecondsValue>scope.maxSeconds?scope.maxSeconds:newSecondsValue<scope.minSeconds?scope.minSeconds:newSecondsValue,scope.secondsVal=addPreNumberZero(scope.secondsVal),scope.data.setSeconds(scope.secondsVal),scope.afterChange&&scope.afterChange({data:scope.data})},scope.$watch("data",function(newVal){null!=newVal&&ObjectUtils.isKind(newVal,"Date")&&(scope.checkMinMaxAndSetHours(newVal.getHours()),scope.checkMinMaxAndSetMinutes(newVal.getMinutes()),scope.checkMinMaxAndSetSeconds(newVal.getSeconds()))})}}}}),app.directive("attDateTimePicker",["$filter","$timeout",function($filter,$timeout){return{restrict:"E",scope:{data:"=",minDate:"=?",maxDate:"=?",ngDisabled:"=",minuteStep:"=",secondStep:"=",ngRequired:"=?",formatDate:"@",hideTime:"=?",cssClass:"@",displaySeconds:"=",appendToBody:"=",inputName:"@",isDateReadOnly:"=?"},replace:!0,template:'<div class="attDateTimePickerStyle {{cssClass}}" ><div class="in-date-group"><input name="{{inputName}}" ng-model="innerTextDateNoTime" ng-required="ngRequired" type="text" class="form-control attDatePickerInput" uib-datepicker-popup="{{formatDate}}" datepicker-options="picDateOptions"  ng-disabled="ngDisabled" is-open="isDateOpened" close-text="Close" ng-readonly="isDateReadOnly"></div><div class="in-date-group"><button type="button" class="btn btn-default openPopupBtn" ng-click="toggleAttDatePicker($event, mmm)" ng-disabled="ngDisabled"><i class="bootstrapGlyphicon glyphicon-calendar"></i></button></div><div class="in-date-group" ng-hide="hideTime"><att-time-stepper display-seconds="displaySeconds" data="timeObjModel" after-change="afterChangeTime(data)" ng-disabled="ngDisabled"ng-required="ngRequired" minute-step="timeOptions.mmStep" second-step="timeOptions.secStep"'+"min-hours='minHours' min-minutes='minMinutes' max-hours='maxHours' max-minutes='maxMinutes'></att-time-stepper></div></div>",compile:function(){return{pre:function(scope,element,attrs){if((null==scope.formatDate||0==scope.formatDate.length)&&(scope.formatDate="MMM-dd-yyyy"),null==scope.ngRequired&&(scope.ngRequired=!1),null==scope.minDate?(scope.minDate=Utils.Now(),scope.minHours=0,scope.minMinutes=0):scope.minDate=new Date(scope.minDate),null==attrs.maxDate){var maxDate=Utils.Now();maxDate.setFullYear(maxDate.getFullYear()+10),scope.maxDate=maxDate,scope.maxHours=23,scope.maxMinutes=59}else scope.maxHours=scope.maxDate.getHours(),scope.maxMinutes=scope.maxDate.getMinutes();null!=scope.data&&angular.isDate(scope.data)||(scope.data=new Date),(null==scope.hideTime||"boolean"!=typeof scope.hideTime)&&(scope.hideTime=!1),scope.isDateReadOnly=!0,scope.picDateOptions={yearFormat:"yyyy",monthFormat:"MMM",startingDay:0,minDate:scope.minDate,maxDate:scope.maxDate},scope.timeOptions={hhStep:1,mmStep:scope.minuteStep||5,secStep:scope.secondStep||10,ismeridian:!1},scope.localTimeout=null,scope.timeObjModel=scope.data,scope.isDateOpened=!1,scope.innerTextDateNoTime=angular.isDate(scope.data)?new Date(scope.data):new Date},post:function(scope,element){var innerTextDateNoTime_lastValidValue;scope.setMinHoursMinutes=function(newMinimumDate){ObjectUtils.isKind(newMinimumDate,"Date")&&ObjectUtils.isKind(scope.data,"Date")&&Utils.isSameDay(newMinimumDate,scope.data)?(scope.minHours=newMinimumDate.getHours(),scope.minMinutes=newMinimumDate.getHours()==scope.data.getHours()?newMinimumDate.getMinutes():0):(scope.minHours=0,scope.minMinutes=0)},scope.setMaxHoursMinutes=function(maximumDate){ObjectUtils.isKind(maximumDate,"Date")&&ObjectUtils.isKind(scope.data,"Date")&&Utils.isSameDay(maximumDate,scope.data)?(scope.maxHours=maximumDate.getHours(),scope.maxMinutes=maximumDate.getHours()==scope.data.getHours()?maximumDate.getMinutes():59):(scope.maxHours=23,scope.maxMinutes=59)},scope.minDate&&scope.$watch("minDate",function(newVal){null!=newVal&&ObjectUtils.isKind(newVal,"Date")&&(scope.picDateOptions.minDate=newVal,scope.setMinHoursMinutes(newVal),scope.data.getTime()+1e3<newVal.getTime()&&(scope.data=new Date(scope.minDate.toISOString()),scope.timeObjModel=new Date(scope.minDate.toISOString())))}),scope.toggleAttDatePicker=function($event){_isValidDate(scope.innerTextDateNoTime)||(scope.innerTextDateNoTime=innerTextDateNoTime_lastValidValue),$event.preventDefault(),$event.stopPropagation(),scope.isDateOpened=!0},scope.syncDateTimeModels=function(dateModel){if(!scope.data||!scope.data.getTime||dateModel&&dateModel.getTime&&scope.data.getTime()!==dateModel.getTime()){var newDate=new Date(dateModel);newDate.setHours(scope.timeObjModel.getHours()),newDate.setMinutes(scope.timeObjModel.getMinutes()),newDate.setSeconds(scope.timeObjModel.getSeconds()),scope.data=newDate}};var checkMinDateForFutureDate=function(){var minDateObj=new Date(scope.minDate),tempBigDate=new Date(minDateObj.toISOString());tempBigDate.setDate(tempBigDate.getDate()+1),tempBigDate.setHours(0),tempBigDate.setMinutes(0),tempBigDate.setSeconds(0),scope.setMinHoursMinutes(scope.data.getTime()-1e3>tempBigDate.getTime()?null:scope.minDate)},checkMaxDateHours=function(){var tempLowDate=new Date(scope.maxDate.toISOString());tempLowDate.setDate(tempLowDate.getDate()-1),tempLowDate.setHours(23),tempLowDate.setMinutes(59),tempLowDate.setSeconds(59),scope.setMaxHoursMinutes(scope.data.getTime()+1e3<tempLowDate.getTime()?null:scope.maxDate)},_keepTimeObjModelInTheSameDate=function(){Utils.isSameDay(scope.data,scope.timeObjModel)||(scope.timeObjModel.setFullYear(scope.data.getFullYear()),scope.timeObjModel.setMonth(scope.data.getMonth()),scope.timeObjModel.setDate(scope.data.getDate()))},_setDataModel=function(newDateValue){if(scope.minDate&&scope.maxDate)if(newDateValue.getTime()-1e3>scope.maxDate.getTime())scope.data=new Date(scope.maxDate),checkMaxDateHours();else if(newDateValue.getTime()+1e3<scope.minDate.getTime()){var minDateObj=new Date(scope.minDate);scope.data=new Date(minDateObj.toISOString()),checkMinDateForFutureDate()}else scope.syncDateTimeModels(newDateValue),checkMinDateForFutureDate(),checkMaxDateHours();else scope.syncDateTimeModels(newDateValue);_keepTimeObjModelInTheSameDate()},_isValidDate=function(valToCheck){return ObjectUtils.isKind(valToCheck,"Date")?valToCheck.getYear()<0?!1:!0:!1};scope.updateDateText=function(newValue){angular.isDate(newValue)&&(scope.timeObjModel=newValue)},scope.doTextChange=function(newValue){if(angular.isDate(newValue)&&scope.data.toDateString()!=newValue.toDateString())_setDataModel(newValue);else if(null!=newValue){var modelLocalText=$filter("date")(scope.data,scope.formatDate);if(modelLocalText!=newValue){var dateObjFromLocalFormat=Date.parse(newValue);angular.isDate(dateObjFromLocalFormat)&&_setDataModel(dateObjFromLocalFormat)}else _keepTimeObjModelInTheSameDate()}},scope.afterChangeTime=function(dateTimeData){_setDataModel(dateTimeData)},scope.$watch("data",function(newValue,oldValue){ObjectUtils.isKind(newValue,"Date")&&ObjectUtils.isKind(oldValue,"Date")&&newValue.getTime()==oldValue.getTime()||scope.updateDateText(newValue)}),scope.debounceTime=0,element.find(".attDatePickerInput").on("keydown",function(){scope.debounceTime=850}),element.find(".attDatePickerInput").on("blur",function(){scope.debounceTime=0}),scope.$watch("innerTextDateNoTime",function(newValue){var manuallyChange=scope.debounceTime>0;ObjectUtils.isKind(newValue,"Date")&&manuallyChange||(innerTextDateNoTime_lastValidValue=newValue,$timeout.cancel(scope.localTimeout),scope.localTimeout=$timeout(function(){scope.doTextChange(newValue)},scope.debounceTime))}),scope.$on("$destroy",function(){$timeout.cancel(scope.localTimeout)})}}}}}]),app.directive("attTimePicker",["$document",function($document){return{restrict:"E",scope:{data:"=",disabled:"=",inputCssClass:"@",popUpCssClass:"@"},template:"<div class='row'><input type='text' data-format='hh:mm' ng-model=\"timeToShow\" ng-disabled='disabled' class='attTimePickerInput {{inputCssClass}}'><span class='input-group-addon attTimePickerSpan' ng-click=\"disabled || show($event)\"><i id=\"timeIcon\" class='bootstrapGlyphicon  glyphicon-time attTimePickerImg' type='glyph'></i></span></div><div class=\"bootstrap-datetimepicker-widget dropdown-menu {{popUpCssClass}}\">"+'<div class="timepicker"><div class="timepicker-picker"><table class="table-condensed"><tbody><tr><td><a href="#" class="btn" ng-click="incrementHours()"><i class="bootstrapGlyphicon glyphicon-chevron-up"></i></a></td><td class="separator"></td><td><a href="#" class="btn" ng-click="incrementMinutes()"><i class="bootstrapGlyphicon  glyphicon-chevron-up"></i></a></td></tr><tr><td><att-text-input ng-model="hourToShow" class="attTimePickerText" maxlength="2" ng-keyup="setHours($event)"></td><td class="separator">:</td><td><att-text-input ng-model="minutesToShow" ng-keyup="setMinutes($event)" class="attTimePickerText" maxlength="2"></td></tr><tr><td><a href="#" class="btn" ng-click="decrementHours()"><i class="bootstrapGlyphicon glyphicon-chevron-down"></i></a></td><td class="separator"></td><td><a href="#" class="btn" ng-click="decrementMinutes()"><i class="bootstrapGlyphicon  glyphicon-chevron-down"></i></a></td></tr></tbody></table></div>',link:function(scope,element){function numToMinutes(number){return 9>=number&&number>=0?"0"+number:number}function updateTimeText(){scope.data.setHours(scope.hourToShow),scope.data.setMinutes(scope.minutesToShow),scope.timeToShow=scope.hourToShow+":"+numToMinutes(scope.minutesToShow)}null!=scope.data&&angular.isDate(scope.data)||(scope.data=new Date);var opened=!1,popup=element.find(".dropdown-menu");scope.input=element.find(".attTimePickerInput");var timeIconSpan=element.find(".input-group-addon"),maxHours=23,maxMinutes=59;scope.hourToShow=scope.data.getHours(),scope.minutesToShow=numToMinutes(scope.data.getMinutes()),scope.timeToShow=scope.hourToShow+":"+scope.minutesToShow,scope.show=function(){scope.turnOnEvents();var position="absolute",offset=timeIconSpan.position();this.width=timeIconSpan.outerWidth(),this.height=timeIconSpan.outerHeight(),offset.top=offset.top+this.height;var $window=$(window);$window.width()<offset.left+popup.outerWidth()?(offset.right=$window.width()-offset.left-this.width,offset.left="auto",this.widget.addClass("pull-right")):(offset.right="auto",popup.removeClass("pull-right")),popup.css({position:position,top:offset.top,left:offset.left,right:offset.right}),popup.addClass("attTimePicker-open"),opened=!0},scope.close=function(element){element.removeClass("attTimePicker-open"),opened=!1,scope.turnOffEvents()},scope.onOuterClickEvent=function(event){return null==scope.input||null==scope.input.parent()||scope.input.parent().find(event.target).length||popup.is(event.target)||popup.find(event.target).length?!1:(scope.$apply(function(){scope.close(popup)}),!0)},scope.setHours=function($event){var hours=parseInt($event.currentTarget.value);return maxHours>=hours?void updateTimeText(hours,null):($event.currentTarget.value=maxHours,updateTimeText(maxHours,null),!1)},scope.setMinutes=function($event){var minutes=parseInt($event.currentTarget.value);return maxMinutes>=minutes?(scope.minutesToShow=minutes,void updateTimeText()):(event.currentTarget.value=scope.minutesToShow=maxMinutes,updateTimeText(maxMinutes,null),!1)},scope.incrementHours=function(){scope.hourToShow+1<=maxHours&&(scope.hourToShow=parseInt(scope.hourToShow)+1,updateTimeText())},scope.decrementHours=function(){scope.hourToShow-1>=1&&(scope.hourToShow=parseInt(scope.hourToShow)-1,updateTimeText())},scope.incrementMinutes=function(){parseInt(scope.minutesToShow)+1<=maxMinutes&&(scope.minutesToShow=parseInt(scope.minutesToShow)+1,updateTimeText())},scope.decrementMinutes=function(){scope.minutesToShow-1>=0&&(scope.minutesToShow=parseInt(scope.minutesToShow)-1,updateTimeText())},scope.turnOnEvents=function(){$document.on("click",scope.onOuterClickEvent)},scope.turnOffEvents=function(){$document.off("click",scope.onOuterClickEvent)},scope.$on("$destroy",function(){scope.turnOffEvents()})}}}]),app.directive("fileDialog",[function(){return{restrict:"A",scope:!0,link:function(scope,element){element.bind("change",function(evt){scope.$emit("fileAdded",evt.target.files[0])}),element.on("blur",function(evt){null==evt.target.files&&scope.$emit("fileUploadCanceled")})}}}]),app.directive("linkTextInput",["$timeout",function(){return{restrict:"E",scope:{trim:"=?",type:"@",editable:"=?",change:"&",inEditMode:"&",showInput:"=?",styleClass:"@",defaultValue:"@",placeholder:"@",hasSelectOnLoad:"=?"},controller:function(){},bindToController:{value:"="},controllerAs:"ctrl",template:'<div class="linkTextInputWrap" style="display: inline-block; cursor: pointer"><a ng-show="(!isOnEdit && !showInput)" ng-click="onLinkClick($event)" class="ellipsisStyle"><span>{{ctrl.value}}</span></a> <input placeholder="{{placeholder}}" select-on-load ng-if="(isOnEdit || showInput) && hasSelectOnLoad != false" type="{{type}}" ng-trim="{{trim}}" ng-model="ctrl.value" enter-close-modal="false" ng-blur="onInputFocusOut()" ng-keypress="InputkeyPress($event)" class="{{styleClass}}" /><input placeholder="{{placeholder}}" ng-if="(isOnEdit || showInput) && hasSelectOnLoad == false"                type="{{type}}" ng-trim="{{trim}}" ng-model="ctrl.value" enter-close-modal="false" ng-blur="onInputFocusOut()" ng-keypress="InputkeyPress($event)" class="{{styleClass}}" /></div>',link:function(scope,element,attrs){null==attrs.showInput&&(scope.showInput=!1),null==attrs.editable&&(scope.editable=!0),null==attrs.type&&(scope.type="text"),scope.defaultValue=null==attrs.defaultValue?null:attrs.defaultValue,scope.isOnEdit=!1,scope.onLinkClick=function(){return scope.editable?(scope.isOnEdit=!0,null!=scope.inEditMode&&_.isFunction(scope.inEditMode)&&scope.inEditMode({val:!0}),setTimeout(function(){element.find("input").select()},100),void 0):!1},scope.onInputFocusOut=function(){scope.isOnEdit=!1,null!=scope.inEditMode&&_.isFunction(scope.inEditMode)&&scope.inEditMode({val:!1}),(null==scope.ctrl.value||""==scope.ctrl.value)&&(scope.ctrl.value=null!=scope.defaultValue?scope.defaultValue:"number"==scope.type?-1:"[N]"),scope.change()},scope.InputkeyPress=function(keyEvent){13===keyEvent.which&&(scope.isOnEdit=!1,""==scope.ctrl.value&&(scope.ctrl.value=null!=scope.defaultValue?scope.defaultValue:"number"==scope.type?-1:"[N]"),scope.change())}}}}]),app.directive("linkDropDown",function(){return{restrict:"E",scope:{value:"=",sourceList:"=",displayProp:"=",showInput:"=",styleClass:"@",onSelect:"&"},template:'<div class="linkDropDownWrap"><a ng-show="!showInput" ng-click="onLinkClick($event)" >{{displayProp == null || displayProp == \'\' ? value : value[displayProp]}}</a> <att-select-list ng-show="showInput" source-array="sourceList" prop="{{displayProp}}" model="value" css-class="styleClass" on-item-selected="selectionChanged(item)"></att-select-list></div>',link:function(scope){scope.selectionChanged=function(item){scope.value=item,scope.onSelect({item:item})}}}}),app.directive("attThreeStatesCheckbox",function(){return{restrict:"EA",scope:{classWrap:"@",classInput:"@",disabled:"=",label:"@",strictLabel:"@"},require:"ngModel",template:'<div ng-click="onClick()" class="attCheckBoxWrap {{classWrap}}" ng-keydown="onKeydown($event)" tabindex="0"><span class="checkBoxSpan {{state}}" ng-class="{\'disabled\':disabled}"></span><span class="checkboxInnerSpan ellipsisStyle" ng-class="{\'disabled\':disabled}" i18n="{{label}}">{{strictLabel}}</span></div>',compile:function(elem,attrs){return null==attrs.label&&elem.find(".checkboxInnerSpan").removeAttr("i18n"),function(scope,element,attrs,ngModelCtrl){function updateModel(){ngModelCtrl.$setViewValue(ngModelCtrl.$viewValue!=consts.ThreeStatesCheckbox.true?consts.ThreeStatesCheckbox.true:consts.ThreeStatesCheckbox.false),ngModelCtrl.$render()}ngModelCtrl.$render=function(){scope.state=ngModelCtrl.$viewValue},scope.onClick=function(){scope.disabled||updateModel()},scope.onKeydown=function($event){scope.disabled||$event.keyCode==consts.ConstKey.SpaceBar&&updateModel()}}}}}),app.directive("attCheckbox",function(){return{restrict:"EA",scope:{classWrap:"@",classInput:"@",disabled:"=",label:"@",strictLabel:"@"},require:"ngModel",template:'<div ng-click="onClick()" class="attCheckBoxWrap {{classWrap}}" ng-keydown="onKeydown($event)" tabindex="0"><span class="checkBoxSpan {{classImage}}" ng-class="{\'checked\':state,\'disabled\':disabled}"></span><span class="checkboxInnerSpan" ng-class="{\'disabled\':disabled}" i18n="{{label}}">{{strictLabel}}</span></div>',compile:function(elem,attrs){return null==attrs.label&&elem.find(".checkboxInnerSpan").removeAttr("i18n"),function(scope,element,attrs,ngModelCtrl){function updateModel(){ngModelCtrl.$setViewValue(!ngModelCtrl.$viewValue),ngModelCtrl.$render()}ngModelCtrl.$render=function(){scope.state=ngModelCtrl.$viewValue},scope.onClick=function(){scope.disabled||updateModel()},scope.onKeydown=function($event){scope.disabled||$event.keyCode==consts.ConstKey.SpaceBar&&updateModel()}}}}}),app.directive("attDropDown",function(){return{restrict:"E",scope:{data:"=",displayProp:"@",onSelect:"&",disabled:"=",cssClass:"@",placeHolder:"@",searchEnabled:"=",ngModel:"="},require:"ngModel",replace:!1,template:'<ui-select on-select="selectionChanged($item)" ng-model="ngModel" theme="select2" search-enabled="{{searchEnabled}}" ng-disabled="disabled" class="attDropDownStyle {{cssClass}}"><ui-select-match placeholder="{{placeHolder}}">{{(displayProp != null) ? $select.selected[displayProp] : $select.selected}}</ui-select-match><ui-select-choices repeat="item in data track by $index"><div ng-bind-html="(displayProp != null) ? item[displayProp] : item"></div></ui-select-choices></ui-select>',link:function(scope,element,attrs,ngModelCtrl){scope.selectionChanged=function(item){ngModelCtrl.$setViewValue(item),ngModelCtrl.$render(),scope.onSelect({item:item})}}}}),app.directive("attRadioButton",["$timeout",function($timeout){return{restrict:"EA",scope:{classWrap:"@",classInput:"@",inputId:"@",disabled:"=",value:"=",label:"@",disableClick:"="},require:"ngModel",template:'<div ng-click="onClick()" id="{{inputId}}" class="attRadioBtnWrap {{classWrap}}" ng-keydown="onKeydown($event)" tabindex="0"><span class="radioBtnSpan {{classImage}}" ng-class="{\'checked\':state,\'disabled\':disabled}"></span><span class="checkboxInnerSpan" ng-class="{\'disabled\':disabled}" i18n="{{label}}"></span></div>',link:function(scope,element,attrs,ngModelCtrl){function updateModel(){ngModelCtrl.$setViewValue(scope.value),ngModelCtrl.$render()}var radioUpdateModelTimeout=null;ngModelCtrl.$render=function(){scope.state=ngModelCtrl.$viewValue==scope.value},scope.onClick=function(){scope.disabled||1==scope.disableClick||updateModel()},scope.onKeydown=function($event){scope.disabled||1==scope.disableClick||$event.keyCode==consts.ConstKey.SpaceBar&&updateModel()},scope.$watch("value",function(newV,oldV){angular.isDefined(newV)&&!angular.equals(newV,oldV)&&(radioUpdateModelTimeout=$timeout(function(){updateModel()
}))}),scope.$on("$destroy",function(){$timeout.cancel(radioUpdateModelTimeout),radioUpdateModelTimeout=null})}}}]),app.directive("attRadioButtonGroup",["$timeout",function(){return{restrict:"EA",scope:{sourceArrayGetter:"&sourceArray",model:"=",disabled:"=",verticalAligned:"@",verticalIndent:"@"},controllerAs:"rgCt",bindToController:!0,template:"<div class='attRadioButtonGroup'><att-radio-button style='{{rgCt.rbStyle}}' class-wrap='{{rgCt.rbClass}}' ng-repeat='item in rgCt.sourceArray' ng-model='rgCt.model' label='{{item.name}}' value='item.type' group-name='{{group}}' input-id='item_{{$index}}' ng-disabled='rgCt.disabled' ng-show='{{item.isVisible}}'></att-radio-button></div>",controller:function(){},link:function(scope){scope.rgCt&&(scope.rgCt.sourceArray=scope.rgCt.sourceArrayGetter(),scope.rgCt.group="radio_group_"+Utils.createGuid(),scope.rgCt.rbClass="true"==scope.rgCt.verticalAligned?"rbLeftAligned":"",scope.rgCt.rbStyle="true"==scope.rgCt.verticalAligned&&"true"==scope.rgCt.verticalIndent?"":"padding-right:40px",scope.rgCt.sourceArray&&ArrayUtils.each(scope.rgCt.sourceArray,function(item){item.isVisible=Object.keys(item).indexOf("isVisible")>-1&&item.isVisible?"boolean"==typeof item.isVisible?item.isVisible:"string"==typeof item.isVisible?JSON.parse(item.isVisible):"($parent.$parent."+item.isVisible+")":!0}))}}}]),app.directive("attSliderNumberWrapper",["$timeout",function(){return{restrict:"EA",scope:{ngModel:"=",minValue:"@",maxValue:"@",ngDisabled:"="},bindToController:!0,controllerAs:"$ctrl",template:" <div id='slider'>\n                  <div ui-slider=\"$ctrl.slider.options\"  min={{$ctrl.getMin()}} max={{$ctrl.getMax()}} step='1' ng-model='$ctrl.ngModel' title='' ng-disabled='$ctrl.ngDisabled'>                  </div>                  <div class='severityLabels' style='width:{{$ctrl.severityLabelsWidth}}%; margin-left:{{$ctrl.severityLabelsMarginLeft}}%'>                       <div class='severityItem'  ng-repeat='item in $ctrl.items' ng-style='$ctrl.sliderStyle'>                           <div class='bottomLabelCenter'></div>                           <span title='{{item}}'>{{item}}</span>                       </div>                   </div>              </div>",controller:function(){},link:function(scope,element,attrs,ngModelCtrl){var scope=this;ngModelCtrl.getMin=function(){return parseInt(attrs.minValue,10)},ngModelCtrl.getMax=function(){return parseInt(attrs.maxValue,10)};var range=ngModelCtrl.getMax()-ngModelCtrl.getMin()+1;ngModelCtrl.sliderStyle={width:100/range+"%"},ngModelCtrl.items=[];for(var i=ngModelCtrl.getMin();i<=ngModelCtrl.getMax();i++)ngModelCtrl.items.push(i);var base=Math.ceil(100/(ngModelCtrl.items.length-1));ngModelCtrl.severityLabelsWidth=base-1+100,ngModelCtrl.severityLabelsMarginLeft=-1*(Math.ceil(base/2)-.5),ngModelCtrl.slider={options:{slide:function(){},start:function(){},stop:function(event,ui){scope.ngModel=ui.value}}}}}}]),app.directive("attSelectWrapper",["$timeout",function(){return{restrict:"EA",scope:{sourceArrayGetter:"&sourceArray",model:"=",prop:"@",dataprop:"@",itemToolTipProp:"@",disabled:"=",allowSearch:"=?"},bindToController:!0,controllerAs:"$ctrl",template:"<div class='attSelectWrapper'><att-select-list prop={{$ctrl.prop}} dataprop={{$ctrl.dataprop}} item-tool-tip-prop={{$ctrl.itemToolTipProp}} model='$ctrl.model' source-array='$ctrl.sourceArray' ng-disabled='$ctrl.disabled' allow-search='$ctrl.allowSearch'></att-select-list></div>",controller:function(){},link:function(scope){scope.$ctrl&&(scope.$ctrl.sourceArray=scope.$ctrl.sourceArrayGetter())}}}]),app.directive("attTextInput",function(){return{restrict:"AE",scope:{inputId:"@",inputType:"@"},replace:!0,template:'<input type="{{inputType}}" autocomplete="off">',link:function(scope,element,attrs){angular.isUndefined(scope.inputType)&&(scope.inputType="text"),null!=attrs.id&&""!=attrs.id||null==attrs.inputId||element.attr("id",attrs.inputId)}}}),app.directive("attSearch",function(){return{restrict:"E",scope:{ngModel:"=",ngDisabled:"=?",autoCompleteArray:"=?",onSearchItemSelected:"&",onSearchChange:"&",placeHolder:"@",animated:"=?",highlightBorder:"=?",onblur:"&"},require:"ngModel",replace:!0,template:"<div class=\"searchWrap\"><input type='text' enter-close-modal='false' class='searchItem' ng-disabled=\"ngDisabled\" ng-class='{\"animated\" : animated , \"highlight\" : highlightBorder && ngModel.length > 0}' placeholder='{{placeHolder | i18n}}' ng-model='ngModel' ng-change='onSearch()' ng-model-options=\"{debounce:350}\" typeahead-on-select='onSearchSelect($item)'  uib-typeahead='item for item in autoCompleteArray  | filter:$viewValue' ng-blur='onSearchBlur($event)'/>"+'<span ng-if="ngModel == null || ngModel.length == 0" class="searchImage textSearchIcon glyphicons glyphicons-search"></span><span ng-if="ngModel.length > 0"  class="searchImage textSearchIcon glyphicons glyphicons-remove-2" ng-click="onClearSearch()" style="cursor: pointer;"></span></div>',link:function(scope,element,attrs,ngModelCtrl){function updateModel(){ngModelCtrl.$setViewValue(scope.ngModel),ngModelCtrl.$render(),scope.onSearchChange&&scope.onSearchChange({newVal:scope.ngModel})}(null==attrs.animated||""==attrs.animated)&&(scope.animated=!1),(null==attrs.highlightBorder||""==attrs.highlightBorder)&&(scope.highlightBorder=!0),(null==attrs.placeHolder||""==attrs.placeHolder)&&(scope.placeHolder="Search"),null==attrs.autoCompleteArray&&(scope.autoCompleteArray=[]),null==attrs.onSearchItemSelected&&(scope.onSearchItemSelected=null),null==attrs.onSearchChange&&(scope.onSearchChange=null),null==attrs.onblur&&(scope.onblur=null),scope.onSearch=function(){updateModel()},scope.onSearchSelect=function($item){updateModel(),scope.onSearchItemSelected&&scope.onSearchItemSelected({$item:$item})},scope.onClearSearch=function(){scope.ngModel="",updateModel()},scope.onSearchBlur=function($event){null!=scope.onblur&&scope.onblur($event)}}}}),app.directive("attList",["$timeout",function($timeout){return{restrict:"EA",scope:{classWrap:"@",classUL:"@",data:"=",displayField:"@",clickItemCallback:"&",dblClickItemCallback:"&",isFirstItemSelected:"=?",api:"=?"},template:'<div class="attListWrap {{classWrap}}" ><ul class="attList {{classUL}}" ng-disabled="disabled"><li class="ellipsisStyle" ng-repeat="item in data track by $index" tabindex="{{10000 + $index}}" ng-keyup="handleOnKeyDown($event)" ng-click="onClick($event)" itemData="{{item}}" ng-dblclick="onDblClick($event)" title="{{item[displayField] != null ? item[displayField] : item}} " >{{item[displayField] != null ? item[displayField] : item}}</li></ul></div>',link:function(scope,element){function pageDownClicked(){var elementToSelect,containerElement=$("#listDataItems"),containerTop=containerElement.offset().top,containerHeight=containerElement.height(),DOMlistItemsElements=$("#listDataItems ul li"),lastElement=DOMlistItemsElements.last(),lastElementTop=$(lastElement).offset().top,lastElementHeight=lastElement.height();return containerTop+containerHeight>lastElementTop+lastElementHeight?(scope.selectItem(lastElement[0]),void lastElement.focus()):(ArrayUtils.each(DOMlistItemsElements,function(DOMElement){var elementTop=$(DOMElement).offset().top;return elementTop>=containerTop?(elementToSelect=DOMElement,!1):void 0}),scope.selectItem(elementToSelect),elementToSelect.focus(),void(elementToSelect=null))}function pageUpClicked(){var elementToSelect,containerElement=$("#listDataItems"),containerTop=containerElement.offset().top,DOMlistItemsElements=$("#listDataItems ul li"),firstElement=DOMlistItemsElements.first(),firstElementTop=$(firstElement).offset().top;return firstElementTop>containerTop?(scope.selectItem(firstElement[0]),void firstElement.focus()):(ArrayUtils.each(DOMlistItemsElements,function(DOMElement){var elementTop=$(DOMElement).offset().top;return elementTop>=containerTop?(elementToSelect=DOMElement,!1):void 0}),scope.selectItem(elementToSelect),void elementToSelect.focus())}var listSelectItemTimeout=null;scope.api||(scope.api={}),scope.api.selectedItemsCounter=0,scope.api.getSelection=function(){var selectedItems=[],selectedItemsArray=$(element).find(".selected");if(0==selectedItemsArray.length)return selectedItems;var itemsCounter=0;return ArrayUtils.each(selectedItemsArray,function(){ArrayUtils.insert(selectedItems,JSON.parse(selectedItemsArray[itemsCounter++].getAttribute("itemdata")))}),selectedItems},scope.api.itemRemovedFromList=function(){scope.api.selectedItemsCounter>0&&(scope.api.selectedItemsCounter--,element.find(".selected").removeClass("selected"))},scope.onClick=function($event){scope.selectItem($event.currentTarget)},scope.onDblClick=function($event){var itemData=$event.currentTarget.getAttribute("itemdata");scope.dblClickItemCallback({item:itemData})},scope.handleOnKeyDown=function(event){event.keyCode==consts.ConstKey.ArrowDown?($(event.currentTarget).next().focus(),scope.selectItem($(event.currentTarget).next()[0])):event.keyCode==consts.ConstKey.ArrowUp?($(event.currentTarget).prev().focus(),scope.selectItem($(event.currentTarget).prev()[0])):event.keyCode==consts.ConstKey.PageDown?pageDownClicked():event.keyCode==consts.ConstKey.PageUp&&pageUpClicked()},scope.selectItem=function(elementToSelect){if(!angular.isUndefined(elementToSelect)&&!$(elementToSelect).hasClass("selected")){$(elementToSelect.parentElement).find(".selected").removeClass("selected"),scope.api.selectedItemsCounter=0,$(elementToSelect).addClass("selected"),scope.api.selectedItemsCounter++;var itemData=elementToSelect.getAttribute("itemdata");scope.clickItemCallback({item:itemData})}},scope.$watch("data",function(newV){if(1==scope.isFirstItemSelected&&angular.isDefined(newV)){var selectedListItem=angular.element(document.querySelector("#viewLogFilesContent .attList .selected"));selectedListItem.removeClass("selected"),selectedListItem=null,listSelectItemTimeout=$timeout(function(){scope.selectItem(element.find("li").first()[0])})}}),scope.$on("$destroy",function(){$timeout.cancel(listSelectItemTimeout),listSelectItemTimeout=null})}}}]),app.directive("attSelectList",["$document","$timeout","UserPreferencesService",function($document,$timeout,UserPreferencesService){return{restrict:"E",scope:{model:"=",sourceArray:"=",prop:"@",dataprop:"@",itemToolTipProp:"@",onClickOpen:"&",onCustomClickOpen:"&",onItemSelected:"&",onAfterItemSelected:"&",onCalcPos:"&",cssClass:"@",ngDisabled:"=?",initFunc:"&",scrollBatchSize:"=?",scrollLimit:"=?",allowSearch:"=?",userPersistenceContext:"&",elementId:"@",api:"=?"},template:'<div class="attSelectList attComboBox {{cssClass}}" ng-class="{\'disabled\':ngDisabled}" ><div class="textInputInRowWrap"><att-text-input ng-show="allowSearch" ng-model="searchText" class="textInputInRow ellipsisStyle"  ng-change="onSearchItemChange(\'{{searchText}}\')" ng-keydown="onInputKeyDown($event)" ng-disabled="ngDisabled" enter-close-modal="false" esc-close-modal="false" title="{{searchText}}"></att-text-input><span ng-show="!allowSearch" ng-click="onSpanClick($event)" class="non-edit-text" title="{{searchText}}" tabindex="0">{{searchText}}</span><span ng-click="clickOpen($event)" class="arrowDownOpenList att-glyph" ng-class="{\'disabled\':ngDisabled}"></span></div><div class="searchListWrapper" ng-class="{\'open\':(!ngDisabled && showList)}"><ul class="searchListInRow" ng-if="!ngDisabled && showList" infinite-scroll="updateScrolSize();"  infinite-scroll-distance="0.01" infinite-scroll-immediate-check="false" infinite-scroll-container="infiniteScrollContainerSelector"><li title="{{(itemToolTipProp != null && itemToolTipProp.length > 0) ? item[itemToolTipProp]  ? item[itemToolTipProp] : item: \'\'  }}" ng-repeat="item in sourceArray | attComboBoxFilter :searchText: model:prop:initSearch:useAsCombo | limitTo: scrollLimit  track by $index" ng-show="{{isPlain(item) ? true : item.isVisible}}" feature-flag feature-flag-name="{{item.featureFlagName}}" feature-flag-levels="{{item.featureFlagLevels}}" feature-flag-endpoint="{{item.featureFlagEndpoint}}" feature-flag-task="{{item.featureFlagTask}}" feature-flag-server="{{item.featureFlagServer}}" accept-empty-name="true" ng-click="onClickOptionItem($event, item)" ng-class="{\'selected\':selectedIndex == $index}" idx="{{$index}}"><span >{{ (prop != null && prop.length>0) ? item[prop] : item  }}</span></li>   </ul></div></div>',link:function(scope,element,attrs){function checkVisibleProp(item){item&&(scope.isPlain(item)||(item.isVisible=Object.keys(item).indexOf("isVisible")>-1&&item.isVisible?"boolean"==typeof item.isVisible?item.isVisible:"string"==typeof item.isVisible?JSON.parse(item.isVisible):"(parentCtrl."+item.isVisible+")":!0))}function onDocumentClick(ev){scope.$applyAsync(function(){0==element.find(ev.target).length&&searchList.is(":visible")&&(scope.showList=!1,scope.restoreOrgModel(),scope.turnOffEvents())})}function closeListByDocEvents(e){var wrapperParent=$(e.target).closest(".searchListWrapper");if(wrapperParent.length>0){var classNameArr=wrapperParent[0].className.split(" ");if(classNameArr.indexOf(scope.comboId)>-1)return}closeListItems()}function onDocumentMousedown(e){closeListByDocEvents(e)}function onDocumentWheel(e){closeListByDocEvents(e)}function onModelUpdate(newVal){checkVisibleProp(newVal);var is_plain=scope.isPlain(newVal);if(is_plain&&String(newVal)||newVal){var newSearchText=scope.getSearchTextByObject(newVal);scope.searchText=null!=newSearchText&&""!=newSearchText?newSearchText:scope.searchText}else scope.searchText=""}var selectListCalcPositionTimeout=null,selectListUserPreferenceTimeout=null;scope.comboId="combo_"+scope.$id;var searchList=element.find(".searchListWrapper");searchList.addClass("tempBox").addClass(scope.comboId).appendTo($("body")),null==attrs.api&&(scope.api={}),scope.parentCtrl=scope.$parent,null==attrs.onCustomClickOpen&&(scope.onCustomClickOpen=null),null==attrs.onClickOpen&&(scope.onClickOpen=null),null==attrs.onItemSelected&&(scope.onItemSelected=null),null==attrs.prop&&(scope.prop=null),null==attrs.dataprop&&(scope.dataprop=null),null==attrs.initFunc&&(scope.initFunc=null),null==attrs.scrollBatchSize&&(scope.scrollBatchSize=15),null==attrs.scrollLimit&&(scope.scrollLimit=15),null!=attrs.cssClass&&element.addClass(attrs.cssClass),null!=attrs.allowSearch&&""!=attrs.allowSearch&&scope.allowSearch===!1||!scope.sourceArray||(scope.allowSearch=null==attrs.allowSearch&&scope.sourceArray.length<5?!1:!0),scope.selectListId=0==ObjectUtils.isEmpty(scope.elementId)?scope.elementId:"attSelect_"+scope.$id,null==attrs.id&&$(element).attr("id",scope.selectListId),scope.infiniteScrollContainerSelector="."+scope.comboId,scope.useAsCombo=!1,scope.inputHeight=24,scope.showList=!1,scope.initSearch=!0,scope.selectedIndex=-1,scope.originalItem=angular.copy(scope.model),scope.searchText="",scope.isPlain=function(obj){return null!=obj&&("string"==typeof obj||"number"==typeof obj)};var elementType="attSelectList";null!=scope.initFunc&&scope.initFunc(),scope.updateScrolSize=function(){scope.scrollLimit=scope.scrollLimit+scope.scrollBatchSize},scope.setModelValue=function(item){scope.model=null!=scope.dataprop&&scope.dataprop.length>0?null!=scope.model?angular.copy(item[scope.dataprop]):"":angular.copy(item)},scope.getItemText=function(item,prop){return null!=prop&&prop.length>0?null!=item?item[prop]:"":item},scope.getItemByText=function(textToFind){if(!(null!=scope.sourceArray&&scope.sourceArray.length>0))return null;if(!(null!=scope.prop&&scope.prop.length>0)){var itemIndex=scope.sourceArray.indexOf(textToFind);return scope.sourceArray[itemIndex]}for(var lowerCaseText=textToFind.toLowerCase(),i=0;i<scope.sourceArray.length;i++)if(lowerCaseText==String(scope.sourceArray[i][scope.prop]).toLowerCase())return scope.sourceArray[i]},scope.getItemByKey=function(enumValue){if(scope.sourceArray){if(!(null!=scope.dataprop&&scope.dataprop.length>0)){var itemIndex=scope.sourceArray.indexOf(enumValue);return scope.sourceArray[itemIndex]}for(var i=0;i<scope.sourceArray.length;i++)if(enumValue==String(scope.sourceArray[i][scope.dataprop]))return scope.sourceArray[i]}},scope.getSearchTextByObject=function(obj){if(scope.isPlain(obj)){var selectedItem=null;return selectedItem=null!=scope.dataprop?scope.getItemByKey(obj):scope.getItemByText(obj),scope.getItemText(selectedItem,scope.prop)}return"object"==typeof obj?scope.getItemText(obj,scope.prop):void 0},scope.searchText=scope.getSearchTextByObject(scope.model),scope.showAllItemList=function(){scope.showList=!0,scope.calcPosition($(element),scope.inputHeight),scope.turnOnEvents()},scope.onSearchItemChange=function(){scope.showAllItemList(),0!=scope.initSearch&&(scope.initSearch=!1)},scope.calcPosition=function($wrapEl,inputHeight){searchList.hide(),setTimeout(function(){var $attComboEl=$(element),wrapWidth=$attComboEl.width(),liPadding=8,innerItemMaxWidth=40;searchList.find("li span").each(function(index,itemSpan){var itemWidth=$(itemSpan).outerWidth()+liPadding;itemWidth>innerItemMaxWidth&&(innerItemMaxWidth=itemWidth)}),searchList.width(innerItemMaxWidth>wrapWidth?innerItemMaxWidth+"px":wrapWidth+"px");var cboxOffset=$attComboEl.offset(),$searchListWrapper=searchList,leftVal=($attComboEl.offset(),cboxOffset.left),topVal=cboxOffset.top+inputHeight;if($attComboEl.closest(".modal").length>0){var modalMainContent=$(".modal"),singleItemHeight=20;if($attComboEl.find("li").length>0){var tHeight=$attComboEl.find("li").first().height();tHeight>singleItemHeight&&(singleItemHeight=tHeight)}var comboItemsHeight=10*singleItemHeight,itemsCount=searchList.find("li span").length;return itemsCount>0&&10>itemsCount&&(comboItemsHeight=itemsCount*singleItemHeight),$attComboEl.offset().top+comboItemsHeight>modalMainContent.offset().top+modalMainContent.height()&&(topVal=cboxOffset.top-comboItemsHeight-5),$searchListWrapper.css("left",leftVal),$searchListWrapper.css("top",topVal),void searchList.show()}var bodyHeight=document.body.offsetHeight,searchListHeight=searchList.find("li span").length*inputHeight;topVal=bodyHeight>topVal+searchListHeight?topVal:topVal-206-20,$searchListWrapper.css("left",leftVal),$searchListWrapper.css("top",topVal),searchList.show()})};var _reRenderList=function(){scope.showList=!0,scope.calcPosition($(element),scope.inputHeight),$(element).find("input").focus().select(),scope.showAllItemList()};scope.api.reRenderList=function(){_reRenderList()};var openListItems=function($event){null!=scope.onCustomClickOpen?scope.onCustomClickOpen():(_reRenderList(),null!=scope.onClickOpen&&scope.onClickOpen({$event:$event}))},closeListItems=function(){scope.$applyAsync(function(){scope.showList=!1}),scope.restoreOrgModel(),scope.turnOffEvents()};scope.onSpanClick=function($event){scope.ngDisabled||(0==scope.showList?(scope.initSearch=!0,openListItems($event)):closeListItems())},scope.clickOpen=function($event){scope.ngDisabled||(scope.showList=!scope.showList,scope.calcPosition($(element),scope.inputHeight),$(element).find("input").focus().select(),null!=scope.onClickOpen&&scope.onClickOpen({$event:$event}),scope.initSearch=1==scope.showList,scope.showList&&scope.showAllItemList())},scope.applySelectedItem=function(itemdata){if($timeout(function(){element.click(),null!=scope.onItemSelected&&scope.onItemSelected({item:itemdata})}),!ObjectUtils.isEmpty(scope.elementId)){var preferenceVal=null!=itemdata[scope.prop]?itemdata[scope.prop]:itemdata,preferenceKey=UserPreferencesService.getKey({type:elementType,id:$(element).attr("id")});UserPreferencesService.setValueByKey(preferenceKey,preferenceVal)}setTimeout(function(){scope.onAfterItemSelected({item:itemdata})},0)},scope.onClickOptionItem=function($event,itemdata){scope.setModelValue(itemdata),scope.searchText=scope.getItemText(itemdata,scope.prop),scope.showList=!1,scope.applySelectedItem(itemdata),0!=scope.initSearch&&(scope.initSearch=!1),scope.turnOffEvents()},scope.restoreOrgModel=function(){if(scope.searchText!=scope.getSearchTextByObject(scope.model)){var item=scope.getItemByText(scope.searchText);null!=item?(scope.setModelValue(item),scope.searchText=scope.getItemText(item,scope.prop)):(scope.setModelValue(scope.originalItem),scope.searchText=scope.getItemText(scope.originalItem,scope.prop))}},scope.setItemWithArrows=function(eventKeyCode){scope.selectedIndex<0?scope.selectedIndex=0:scope.selectedIndex>scope.sourceArray.length-1?scope.selectedIndex=scope.sourceArray.length-1:eventKeyCode==consts.ConstKey.ArrowDown?(scope.showList||scope.showAllItemList(),scope.selectedIndex++):eventKeyCode==consts.ConstKey.ArrowUp&&scope.selectedIndex--;var selector='li[idx="'+scope.selectedIndex+'"]';scope.selectedIndex>-1&&scope.selectedIndex<scope.sourceArray.length&&$(element).find(selector).length>0&&$(element).find(selector).get(0).scrollIntoView(!1)},scope.onInputKeyDown=function($event){if($event.keyCode==consts.ConstKey.ArrowDown||$event.keyCode==consts.ConstKey.ArrowUp)scope.setItemWithArrows($event.keyCode);else if($event.keyCode==consts.ConstKey.Enter&&scope.selectedIndex>-1){var selector='li[idx="'+scope.selectedIndex+'"]',selectedText=$(searchList).find(selector).text().trim(),selectedItem=scope.getItemByText(selectedText);scope.initSearch=!1,scope.showList=!1,scope.setModelValue(selectedItem),scope.searchText=scope.getItemText(selectedItem,scope.prop),scope.applySelectedItem(selectedItem)}else-1!=scope.selectedIndex||$event.keyCode!=consts.ConstKey.Enter&&$event.keyCode!=consts.ConstKey.Tab?$event.keyCode==consts.ConstKey.Esc&&($event.stopPropagation(),scope.showList=!1):(scope.showList=!1,scope.restoreOrgModel(),scope.turnOffEvents())},scope.onBlur=function(){scope.showList=!1,scope.restoreOrgModel(),scope.turnOffEvents()},scope.turnOnEvents=function(){scope.turnOffEvents(),$document.on("click",onDocumentClick),$document.on("wheel",onDocumentWheel),$document.on("mousedown",onDocumentMousedown)},scope.turnOffEvents=function(){$document.off("click",onDocumentClick),$document.off("wheel",onDocumentWheel),$document.off("mousedown",onDocumentMousedown)},scope.$watch("model",onModelUpdate),scope.$watch("sourceArray",function(newVal){null!=newVal&&angular.isArray(newVal)&&0==newVal.length?scope.searchText="":onModelUpdate(scope.model),null!=newVal&&angular.isArray(newVal)&&newVal.length>0&&ArrayUtils.each(scope.sourceArray,function(item){checkVisibleProp(item)})},!0),selectListUserPreferenceTimeout=$timeout(function(){if(!ObjectUtils.isEmpty(scope.elementId)){var preferenceKey=UserPreferencesService.getKey({type:elementType,id:$(element).attr("id")}),preferenceVal=UserPreferencesService.getValueByKey(preferenceKey);if(null!=preferenceVal&&angular.isDefined(preferenceVal)){var itemData=ArrayUtils.find(scope.sourceArray,function(val){var valToCompare=null!=val[scope.prop]?val[scope.prop]:val;return valToCompare==preferenceVal});scope.onClickOptionItem(null,itemData)}}}),scope.$on("$destroy",function(){scope.turnOffEvents(),$("."+scope.comboId).remove(),$timeout.cancel(selectListCalcPositionTimeout),$timeout.cancel(selectListUserPreferenceTimeout),selectListCalcPositionTimeout=null,selectListUserPreferenceTimeout=null,searchList=null})}}}]),app.directive("attComboBox",["$document","$timeout",function($document,$timeout){return{restrict:"E",scope:{model:"=",sourceArray:"=",onClickOpen:"&",onItemSelected:"&",onCalcPos:"&",cssClass:"@",ngDisabled:"=?",onTextChange:"&",scrollBatchSize:"=?",scrollLimit:"=?",placeholder:"=?"},replace:!0,template:'<div class="attComboBox {{cssClass}}" ng-class="{\'disabled\':ngDisabled}" id=\'comboBox_{{$id}}\'><div class="textInputInRowWrap"><att-text-input ng-model="model" class="textInputInRow ellipsisStyle" ng-change="onSearchItemChange(\'{{model}}\')"  placeholder="{{placeholder}}" ng-keydown="onInputKeyDown($event)" ng-disabled="ngDisabled" enter-close-modal="false" esc-close-modal="false" att-select></att-text-input><span ng-click="clickOpen($event)" class="arrowDownOpenList att-glyph" ng-class="{\'disabled\':ngDisabled}"></span></div><div class="searchListWrapper" ng-class="{\'open\':(!ngDisabled && showList), \'hidden\': ((sourceArray | attComboBoxFilter :null:model:null:initSearch:useAsCombo).length === 0)}" ><ul class="searchListInRow" ng-if="!ngDisabled && showList" infinite-scroll="updateScrolSize();" infinite-scroll-distance="0.01" infinite-scroll-immediate-check="false" infinite-scroll-container="comboBoxInfiniteScrollSelector"><li ng-repeat="item in sourceArray | attComboBoxFilter :null:model:null:initSearch:useAsCombo | limitTo:scrollLimit track by $index" ng-click="clickItem($event, item)" ng-class="{\'selected\':selectedIndex == $index}" idx="{{$index}}"><span>{{item}}</span></li></ul></div></div>',link:function(scope,element,attrs){function onDocumentClick(ev){scope.$applyAsync(function(){0==element.find(ev.target).length&&searchList.is(":visible")&&(scope.showList=!1,scope.turnOffEvents())})}scope.comboId="combo_"+scope.$id;var searchList=element.find(".searchListWrapper");searchList.addClass("tempBox").addClass(scope.comboId).appendTo($("body"));var comboBoxCalcPositionTimeout=null;null==attrs.onClickOpen&&(scope.onClickOpen=null),null==attrs.onItemSelected&&(scope.onItemSelected=null),null==attrs.onTextChange&&(scope.onTextChange=null),null==attrs.scrollBatchSize&&(scope.scrollBatchSize=15),null==attrs.scrollLimit&&(scope.scrollLimit=15),scope.inputHeight=24,scope.showList=!1,scope.initSearch=!0,scope.useAsCombo=!0,scope.comboBoxInfiniteScrollSelector="."+scope.comboId,scope.selectedIndex=ArrayUtils.indexOf(scope.sourceArray,scope.model),scope.updateScrolSize=function(){scope.scrollLimit=scope.scrollLimit+scope.scrollBatchSize},scope.onSearchItemChange=function(oldVal){0==oldVal.length&&(scope.showList=!0,scope.calcPosition($(element),scope.inputHeight)),0!=scope.initSearch&&(scope.initSearch=!1),scope.onTextChange&&scope.onTextChange({oldVal:oldVal,newVal:scope.model}),scope.selectedIndex=-1,scope.turnOnEvents()},scope.calcPosition=function($wrapEl,inputHeight){searchList.hide(),setTimeout(function(){var $attComboEl=$(element),wrapWidth=$attComboEl.width();$attComboEl.width(wrapWidth+"px");var liPadding=8,innerItemMaxWidth=40;searchList.find("li span").each(function(index,itemSpan){var itemWidth=$(itemSpan).outerWidth()+liPadding;itemWidth>innerItemMaxWidth&&(innerItemMaxWidth=itemWidth)}),searchList.width(innerItemMaxWidth>wrapWidth?innerItemMaxWidth+"px":wrapWidth+"px");var cboxOffset=$attComboEl.offset(),$searchListWrapper=searchList,leftVal=($attComboEl.offset(),cboxOffset.left),topVal=cboxOffset.top+inputHeight;if($attComboEl.closest(".modal").length>0){var modalMainContent=$(".modal"),singleItemHeight=20;if($attComboEl.find("li").length>0){var tHeight=$attComboEl.find("li").first().height();tHeight>singleItemHeight&&(singleItemHeight=tHeight)}var comboItemsHeight=10*singleItemHeight,itemsCount=searchList.find("li span").length;return itemsCount>0&&10>itemsCount&&(comboItemsHeight=itemsCount*singleItemHeight),$attComboEl.offset().top+comboItemsHeight>modalMainContent.offset().top+modalMainContent.height()&&(topVal=cboxOffset.top-comboItemsHeight-5),$searchListWrapper.css("left",leftVal),$searchListWrapper.css("top",topVal),void searchList.show()}var bodyHeight=document.body.offsetHeight,searchListHeight=searchList.find("li span").length*inputHeight;topVal=bodyHeight>topVal+searchListHeight?topVal:topVal-searchListHeight+10,$searchListWrapper.css("left",leftVal),$searchListWrapper.css("top",topVal),searchList.show()})},scope.clickOpen=function($event){scope.ngDisabled||(scope.showList=!scope.showList,scope.calcPosition($(element),scope.inputHeight),$(element).find("input").focus().select(),null!=scope.onClickOpen&&scope.onClickOpen({$event:$event}),scope.initSearch=1==scope.showList,scope.turnOnEvents())},scope.clickItem=function($event,itemdata){setTimeout(function(){element.click()}),scope.model=angular.copy(itemdata),scope.showList=!1,null!=scope.onItemSelected&&scope.onItemSelected({item:itemdata}),0!=scope.initSearch&&(scope.initSearch=!1),scope.selectedIndex=ArrayUtils.indexOf(scope.sourceArray,itemdata),scope.turnOffEvents()},scope.setItemWithArrows=function(eventKeyCode){scope.selectedIndex<0?scope.selectedIndex=0:scope.selectedIndex>scope.sourceArray.length-1?scope.selectedIndex=scope.sourceArray.length-1:eventKeyCode==consts.ConstKey.ArrowDown?scope.selectedIndex++:eventKeyCode==consts.ConstKey.ArrowUp&&scope.selectedIndex--;var selector='li[idx="'+scope.selectedIndex+'"]';scope.selectedIndex>-1&&scope.selectedIndex<scope.sourceArray.length&&$(searchList).find(selector).length>0&&$(searchList).find(selector).get(0).scrollIntoView(!1)},scope.onInputKeyDown=function($event){if($event.keyCode==consts.ConstKey.ArrowDown||$event.keyCode==consts.ConstKey.ArrowUp)scope.setItemWithArrows($event.keyCode);else if($event.keyCode==consts.ConstKey.Enter&&scope.selectedIndex>-1){var selector='li[idx="'+scope.selectedIndex+'"]',elementText=$(searchList).find(selector).text().trim(),itemIndex=scope.sourceArray.indexOf(elementText);if(itemIndex>-1){scope.initSearch=!1,scope.showList=!1;var oldVal=scope.model;scope.model=scope.sourceArray[itemIndex],scope.onSearchItemChange(oldVal),null!=scope.onItemSelected&&scope.onItemSelected({item:scope.model})}}else-1!=scope.selectedIndex||$event.keyCode!=consts.ConstKey.Enter&&$event.keyCode!=consts.ConstKey.Tab?$event.keyCode==consts.ConstKey.Esc&&($event.stopPropagation(),scope.showList=!1):(scope.showList=!1,scope.turnOffEvents())},scope.turnOnEvents=function(){scope.turnOffEvents(),$document.on("click",onDocumentClick)},scope.turnOffEvents=function(){$document.off("click",onDocumentClick)},scope.$on("$destroy",function(){scope.turnOffEvents(),$timeout.cancel(comboBoxCalcPositionTimeout),$("."+scope.comboId).remove(),comboBoxCalcPositionTimeout=null,searchList=null})}}}]),app.factory("TooltipService",function(){var TooltipService={lastShownTipId:0,timer:null};return TooltipService}),app.directive("attCustomTooltip",["$compile","$timeout","locale","TooltipService",function($compile,$timeout,locale,TooltipService){return{restrict:"A",scope:{customTooltipTemplateGetter:"&customTooltipTemplate",customTooltipText:"@",customTooltipResourceText:"@",tipTextToken:"@",customTipTimeout:"@",strictText:"@",delegateEventSelector:"@",onlyIfNeeded:"&",showIf:"&",customTemplateData:"="},link:function(scope,element,attrs){function tooltipMouseMoveHandler(event){if(null!=attrs.showIf){var shouldShow=scope.showIf()(this);if(!shouldShow)return;ObjectUtils.isKind(shouldShow,"String")&&""!=shouldShow.length&&(scope.strictText=shouldShow,scope.customTooltipText=shouldShow)}var tooltipNeeded=!0;if(null==scope.customTooltipTemplate||""==scope.customTooltipTemplate)if(null==scope.customTooltipResourceText||""==scope.customTooltipResourceText){if(!(null!=scope.customTooltipText&&""!=scope.customTooltipText||null!=scope.strictText&&""!=scope.strictText))return}else null!=scope.tipTextToken&&""!=scope.tipTextToken&&(scope.customTooltipText=locale.getString(scope.customTooltipResourceText,{placeholder:scope.tipTextToken}));posX=event.pageX+4,posY=event.pageY,scope.onlyIfNeeded()&&(tooltipNeeded=element[0].offsetHeight<element[0].scrollHeight||element[0].offsetWidth<element[0].scrollWidth?!0:!1),$("#contextMenu").length>0||(null==scope.delegateEventSelector?$("body").off("mousemove",onTipMouseMove).on("mousemove",onTipMouseMove):(scope.lastDelegated=event.currentTarget,$("body").off("mousemove",onTipMouseMoveDelegated).on("mousemove",onTipMouseMoveDelegated)),TooltipService.lastShownTipId!=scope.$id&&tooltipNeeded&&(TooltipService.lastShownTipId=scope.$id,$(".attCustomTooltip").remove(),clearTimeout(TooltipService.timer),TooltipService.timer=setTimeout(function(){$("#contextMenu").length>0||(TooltipService.lastShownTipId=scope.$id,createAndAppendToolTip(event))},showAfterMili)))}var showAfterMili=650;scope.templateUrl="";var posX=0,posY=0,customTooltipSetTimeout=null;null!=scope.customTipTimeout&&""==scope.customTipTimeout&&"number"==typeof parseInt(scope.customTipTimeout)&&(showAfterMili=parseInt(scope.customTipTimeout)),scope.customTooltipTemplate=scope.customTooltipTemplateGetter(),scope.templateUrl=null==scope.customTooltipTemplate||""==scope.customTooltipTemplate?"scripts/angular.common/attTooltip/tooltipTemplate.html":scope.customTooltipTemplate;
var onTipMouseMove=function(event){event.target!=element[0]&&0==element.find(event.target).length&&(clearTimeout(TooltipService.timer),$(".attCustomTooltip").remove(),TooltipService.lastShownTipId=-1,$("body").off("mousemove",onTipMouseMove))},onTipMouseMoveDelegated=function(event){event.target==scope.lastDelegated||isDescendant(scope.lastDelegated,event.target,5)||(clearTimeout(TooltipService.timer),$(".attCustomTooltip").remove(),TooltipService.lastShownTipId=-1,$("body").off("mousemove",onTipMouseMoveDelegated))},createAndAppendToolTip=function(){$(".attCustomTooltip").remove();var elGuid=Utils.createGuid();element.attr("rel",elGuid);var tooltipElement=angular.element("<div class='attCustomTooltip' style='position: absolute; z-index: 1200; display: inline-block;' rel='"+elGuid+"'>");tooltipElement.append("<div ng-include='\""+scope.templateUrl+"\"'></div>"),tooltipElement.css("top",posY+"px"),tooltipElement.css("left",posX+"px"),null!=scope.child&&scope.child.$destroy(),scope.child=scope.$new(),$compile(tooltipElement)(scope.child),$("body").append(tooltipElement)};null!=scope.delegateEventSelector?element.on("mousemove",scope.delegateEventSelector,tooltipMouseMoveHandler):element.on("mousemove",tooltipMouseMoveHandler),scope.$on("$includeContentLoaded",function(ev,url){url==scope.templateUrl&&(customTooltipSetTimeout=setTimeout(function(){var tooltipElement=$(".attCustomTooltip");if(tooltipElement.length>0){var tipOffset=tooltipElement.offset(),tipOffsetLeft=tooltipElement.width()+tipOffset.left,tipOffsetTop=tooltipElement.height()+tipOffset.top,xDelta=window.innerWidth-tipOffsetLeft,yDelta=window.innerHeight-tipOffsetTop;0>xDelta&&tooltipElement.css("left",tipOffset.left+xDelta-10+"px"),0>yDelta&&tooltipElement.css("top",tipOffset.top+yDelta-10+"px")}},0)),ev.stopPropagation()}),scope.$on("$destroy",function(){element.off("mousemove",onTipMouseMove);var elGuid=element.attr("rel");$('.attCustomTooltip[rel="'+elGuid+'"]').remove(),clearTimeout(customTooltipSetTimeout),clearTimeout(TooltipService.timer),customTooltipSetTimeout=null,TooltipService.timer=null})}}}]),app.directive("attTooltip",["$templateCache","$filter","$compile","locale",function($http,$filter,$compile,locale){return{restrict:"A",replace:!0,terminal:!0,priority:1e3,compile:function(element,attrs){if(element.removeClass("attTooltip").addClass("attTooltip"),element.removeAttr("title"),element.removeAttr("att-tooltip"),element.attr("tooltip-placement",attrs.tipPosition||"bottom"),element.attr("tooltip-animation",attrs.tipAnimation),element.attr("tooltip-popup-delay",null==attrs.tipDelay?1500:attrs.tipDelay),element.attr("tooltip-trigger",attrs.tipTrigger),element.attr("tooltip-enable",attrs.tipEnabled),element.attr("tooltip-append-to-body",attrs.tipAppendToBody),element.attr("tooltip-class",attrs.tipClass),angular.isDefined(attrs.tipTemplate)&&angular.isDefined(attrs.tipTemplateData))element.attr("tooltip-template",attrs.tipTemplate);else{var tooltipText="";tooltipText=angular.isDefined(attrs.tipResourceText)?angular.isDefined(attrs.tipTextToken)?locale.getString(attrs.tipResourceText,{placeholder:attrs.tipTextToken}):locale.getString(attrs.tipResourceText):attrs.tipText,element.attr("tooltip",tooltipText)}return{pre:function(){},post:function(scope,iElement,iAttrs){if(angular.isDefined(attrs.tipTemplate)&&angular.isDefined(attrs.tipTemplateData)){var tip_data=null;tip_data=angular.fromJson(iAttrs.tipTemplateData),tip_data&&angular.extend(scope,tip_data)}$compile(iElement)(scope)}}}}}]),app.directive("renderIf",["$compile",function($compile){return{scope:{renderIf:"=",renderOnce:"="},compile:function(element){if(element&&element[0]){var childElem=element[0].innerHTML;return element.empty(),function(scope,elem){scope.rendered=!1,scope.$watch("renderIf",function(newVal){if(newVal){if(scope.renderIf)if(scope.renderOnce&&scope.rendered)elem.show();else{elem.empty();var compiled=$compile(angular.element(childElem))(scope.$parent);elem.append(compiled),elem.show(),scope.rendered=!0}}else scope.renderOnce&&scope.rendered?elem.hide():(elem.empty(),elem.hide())},!0)}}}}}]),app.factory("ContextMenuService",function(){return{element:null,menuElement:null,contextMenuScope:null}}),app.directive("attContextMenu",["$compile","$parse","$document","$timeout","ContextMenuService",function($compile,$parse,$document,$timeout,ContextMenuService){return{restrict:"A",replace:!0,priority:0,link:function(scope,elem,attrs){var opened=!1,contextMenuCreateTimeout=null;elem.on("contextmenu",function(event){"false"!==attrs.ctxMenuAsloClick&&$(this).click(),scope.menuData=$parse(attrs.menuData)(scope),scope.elData=$parse(attrs.elData)(scope),ObjectUtils.isKind(scope.menuData,"Function")&&(scope.menuData=scope.menuData(event,scope.elData)),scope.menuData&&0!=scope.menuData.length&&(event.preventDefault(),event.stopPropagation()),scope.$applyAsync(function(){scope.menuData&&0!=scope.menuData.length&&scope.createContextMenu(event)})}),scope.onItemClick=function($event,menuItem){null!=menuItem.clickFunc&&($event.stopPropagation(),scope.isItemDisabled(menuItem,scope.elData)||(menuItem.clickFunc($event,menuItem,scope.elData),scope.close(ContextMenuService.menuElement)))},scope.isItemDisabled=function(item,elData){return"undefined"==typeof item.disabled?!1:"function"==typeof item.disabled?item.disabled(elData):item.disabled},scope.isItemVisible=function(item,elData){return"undefined"==typeof item.visible?!0:"function"==typeof item.visible?item.visible(elData):item.visible},scope.close=function(menuElement){menuElement.removeClass("open"),menuElement.remove(),menuElement=null,opened=!1,ContextMenuService.contextMenuScope&&(ContextMenuService.contextMenuScope.$destroy(),ContextMenuService.contextMenuScope=null),scope.turnOffEvents()},scope.createContextMenu=function(event){scope.turnOffEvents(),$(".attCustomTooltip").remove(),null!==ContextMenuService.menuElement&&scope.close(ContextMenuService.menuElement),ContextMenuService.contextMenuScope=scope.$new();var doc=$document[0].documentElement,list=angular.element("<div id='contextMenu'><ul class='dropdown-menu sub-menu' style='display: block;'><li ng-repeat='item in menuData'><a id='{{item.id}}' ng-click=\"onItemClick($event, item)\" ng-show=\"isItemVisible(item,elData)\" ng-disabled=\"isItemDisabled(item,elData)\" ng-class=\"{'disabled': isItemDisabled(item,elData) }\">{{item.name | i18n}}<i class='contextMenuItemIcon' ng-class=\"{'att-glyph icon-gl-Expand_right':(item.children != null && item.children.length > 0)}\"></i></a><ul ng-if='item.children != null && item.children.length > 0' class='dropdown-menu sub-menu'><li ng-repeat='child in item.children' ><a id='{{child.id}}' ng-click=\"onItemClick($event, child)\" ng-show=\"isItemVisible(item,elData)\"  ng-disabled=\"isItemDisabled(child,elData)\" ng-class=\"{'disabled': isItemDisabled(child,elData) }\">{{child.name | i18n}}</a></li></ul></li></ul></div>");$compile(list)(ContextMenuService.contextMenuScope),ContextMenuService.menuElement=list,$(doc).append(list),contextMenuCreateTimeout=$timeout(function(){var elementWidth=ContextMenuService.menuElement.children("ul").width(),elementHeight=ContextMenuService.menuElement.children("ul").height(),docWidth=window.innerWidth,docHeight=window.innerHeight,totalWidth=elementWidth+event.pageX,totalHeight=elementHeight+event.pageY,left=event.pageX,top=event.pageY;totalWidth>docWidth&&(left-=totalWidth-docWidth),totalHeight>docHeight-40&&(top=top-(totalHeight-docHeight)-40),ContextMenuService.menuElement.css("top",top+"px"),ContextMenuService.menuElement.css("left",left+"px");var subMenu=ContextMenuService.menuElement.children("ul").find("ul");left+elementHeight+subMenu.width()>docWidth&&(subMenu.css("left","auto"),subMenu.css("right","100%"))}),opened=!0,scope.turnOnEvents()},scope.checkForCloseContextMenuEvent=function(event){return null!=event?!opened||2===event.button&&event.target===ContextMenuService.element?!1:(scope.$apply(function(){scope.close(ContextMenuService.menuElement)}),!0):void(null!=ContextMenuService.menuElement&&scope.close(ContextMenuService.menuElement))},scope.handleContextMenuEvent=function(event){scope.checkForCloseContextMenuEvent(event)},scope.handleClickEvent=function(event){scope.checkForCloseContextMenuEvent(event)},scope.turnOnEvents=function(){$document.on("click",scope.handleClickEvent),$document.on("contextmenu",scope.handleContextMenuEvent)},scope.turnOffEvents=function(){$document.off("click",scope.handleClickEvent),$document.off("contextmenu",scope.handleContextMenuEvent)},scope.$on("$destroy",function(){scope.turnOffEvents(),$timeout.cancel(contextMenuCreateTimeout),contextMenuCreateTimeout=null,scope.checkForCloseContextMenuEvent()})}}}]),app.directive("attSelect",["$timeout",function($timeout){return{restrict:"A",link:function(scope,element){var selectElementTimeout=null,selectElement=function(){element.select()};selectElementTimeout=$timeout(selectElement,100),scope.$on("$destroy",function(){$timeout.cancel(selectElementTimeout),selectElementTimeout=null})}}}]),app.factory("focus",function($timeout){return function(element){element&&(element.focus(),$timeout(function(){element[0].select()}))}}),app.directive("selectOnLoad",["$timeout","focus",function($timeout,focus){return{restrict:"A",link:function(scope,element){focus(element)}}}]),app.directive("attFocus",["$timeout","focus",function($timeout){return{restrict:"A",link:function(scope,element){element&&$timeout(function(){element.focus()},50)}}}]),app.directive("attButtonDropList",["$document",function($document){return{restrict:"E",scope:{ngModel:"=",sourceArray:"=",onClickOpen:"&",onItemSelected:"&",cssClass:"@",ngDisabled:"="},replace:!0,template:'<div class="attButtonDropListWarp {{cssClass}}" ng-class="{\'disabled\':ngDisabled, \'open\':showList}"><div class="mainBtn" ng-click="clickOpen($event)"  ng-class="{\'disabled\':ngDisabled}"><span class="listItemIcon {{ngModel[\'icon\']}}"></span><span class="btnText" i18n="{{ngModel[\'text\']}}"></span><span class="btnOpenListIcon att-glyph icon-gl-Collapse_down"></span></div><ul ng-if="!ngDisabled && showList" class="dropdown-menu open openToLeft"><li ng-repeat="item in sourceArray track by $index" ng-click="clickItem(item)" idx="{{$index}}"><a><span class="listItemIcon {{item.icon}}" style="width: auto;"></span><span class="listItemText" i18n="{{item.text}}"></span></a></li></ul></div>',link:function(scope,element,attrs){function onDocumentClick(ev){scope.showList&&0==element.find(ev.target).length&&(scope.showList=!1,$document.off("click",onDocumentClick))}null==attrs.onClickOpen&&(scope.onClickOpen=null),null==attrs.onItemSelected&&(scope.onItemSelected=null),null==scope.ngModel&&(scope.ngModel=scope.sourceArray[0]),scope.showList=!1,scope.selectedIndex=-1,scope.clickOpen=function($event){scope.ngDisabled||(scope.showList=!scope.showList,$document.on("click",onDocumentClick),null!=scope.onClickOpen&&scope.onClickOpen({$event:$event}))},scope.clickItem=function(itemData){scope.ngModel=angular.copy(itemData),scope.showList=!1,null!=scope.onItemSelected&&scope.onItemSelected({item:itemData}),$document.off("click",onDocumentClick)},scope.$on("$destroy",function(){$document.off("click",onDocumentClick)})}}}]),app.directive("attModeBtns",[function(){return{restrict:"E",scope:{onModeClick:"&",isDesignerActive:"=?",isMonitorActive:"=?",labelDesigner:"@",labelMonitor:"@",constModeDesigner:"@",constModeMonitor:"@",showDesigner:"=?",showMonitor:"=?",disableDesigner:"=?",disableMonitor:"=?",cssDesigner:"@",cssMonitor:"@",cssClass:"@"},replace:!0,template:'<div class="designer_monitor_btns {{cssClass}}"><att-button ng-show="showDesigner" label="{{labelDesigner}}" text-position="right" on-click="btnAction(constModeDesigner)" ng-disabled="disableDesigner" class="modeBtn" ng-class="{activeBtn : isDesignerActive }" type="glyph" glyph-class="{{cssDesigner}}" ></att-button><att-button ng-show="showMonitor" label="{{labelMonitor}}" text-position="right" on-click="btnAction(constModeMonitor)" ng-disabled="disableMonitor" class="modeBtn" ng-class="{activeBtn : isMonitorActive }" type="glyph" glyph-class="{{cssMonitor}}" ></att-button></div>',link:function(scope,element,attrs){null==attrs.onModeClick&&(scope.onModeClick=null),null==attrs.labelDesigner&&(scope.labelDesigner="common.base.Designer"),null==attrs.labelMonitor&&(scope.labelMonitor="common.base.Monitor"),null==attrs.constModeDesigner&&(scope.constModeDesigner=consts.Mode.DESIGNER),null==attrs.constModeMonitor&&(scope.constModeMonitor=consts.Mode.MONITOR),null==attrs.showDesigner&&(scope.showDesigner=!0),null==attrs.showMonitor&&(scope.showMonitor=!0),null==attrs.disableDesigner&&(scope.disableDesigner=!1),null==attrs.disableMonitor&&(scope.disableMonitor=!1),null==attrs.cssDesigner&&(scope.cssDesigner="modeIcon iconDesigner"),null==attrs.cssMonitor&&(scope.cssMonitor="modeIcon iconMonitor"),scope.btnAction=function(mode){null!=scope.onModeClick&&scope.onModeClick({mode:mode})}}}}]),app.directive("inCellTooltip",["$compile",function($compile){return{restrict:"A",compile:function(element){return element.removeAttr("in-cell-tooltip"),element.addClass("cellTextStyle"),element.attr("att-custom-tooltip",!0),element.attr("strict-text",element.attr("celltext")),element.text(element.attr("strict-text")),{pre:function(){},post:function(scope,iElement){$compile(iElement)(scope)}}}}}]),app.directive("fileModel",["$parse",function($parse){return{restrict:"A",link:function(scope,element,attrs){var model=$parse(attrs.fileModel),modelSetter=model.assign;element.bind("change",function(){scope.$apply(function(){modelSetter(scope,element[0].files[0])})})}}}]),app.directive("formOnChange",function($parse){return{require:"form",link:function(scope,element,attrs){var cb=$parse(attrs.formOnChange);element.on("change",function(){cb(scope)})}}}),app.directive("domElementReady",["DomElementsService",function(DomElementsService){return{restrict:"A",link:function(scope,element,attrs){var elementId="";angular.isUndefined(attrs.id)||""==attrs.id||(elementId=attrs.id,DomElementsService.DOMElementReady(elementId),scope.$on("$destroy",function(){DomElementsService.removeId(elementId)}))}}}]),app.directive("rightCollapsibleContainer",[function(){return{restrict:"A",transclude:!0,scope:{expanded:"="},template:function(el,attrs){var template='<div class="CollapsibleContainerHeader menuBarStyle"><span style="float: left"><button ng-click="onExpandCollapse()" class="expandButton attBtn horizontal"ng-class="{expanded:expanded}"><span class="att-glyph expandCollapseIconIntern"></span></button></span><span class="CollapsibleContainerLabel"  ng-show="expanded">'+attrs.header+'</span></div><div class="CollapsibleContainerContent"  ng-show="expanded" ng-transclude></div>';return template},link:function(scope,element,attrs){null==attrs.expanded&&(scope.expanded=!1),element.css("float","right"),element.addClass("CollapsibleContainerStyle");var expandedWidth=attrs.expandedWidth,ind=element.index(),brother=$(element.parent().children()[ind-1]);scope.onExpandCollapse=function(){scope.expanded=!scope.expanded},scope.$watch("expanded",function(){scope.calc()}),scope.calc=function(){if(scope.expanded){element.css("width",expandedWidth);var parentWidth=element.parent().width(),elementWidthP=element.width()/parentWidth*100;brother.css("width",100-(elementWidthP+1)+"%")}else element.css("width",attrs.collapsedWidth||"40px"),brother.css("width","calc(100% - "+(attrs.collapsedWidth||"40px")+")")},scope.calc()}}}]),app.directive("overflowDots",["$compile",function($compile){return{restrict:"A",link:function(scope,element,attrs){element.addClass("overflowDotsElement");var percentRange=0;null!=attrs.percentRange&&(percentRange=Number(attrs.percentRange));var calcPercent=(100-percentRange)/100,dotsElement=angular.element('<span class="moreInfoDots" ng-class="{\'showOverflowDots\' : canShowDots() }">...</span>');null!=scope.child&&scope.child.$destroy(),scope.child=scope.$new(),$compile(dotsElement)(scope.child),element.append(dotsElement),scope.canShowDots=function(){var parentHeight=element.parent().height(),parentWidth=Math.floor(element.parent().width()*calcPercent),firstChildHeight=element.children().first().height(),firstChildWidth=element.children().first().width();return firstChildHeight>=parentHeight||firstChildWidth>=parentWidth}}}}])}(angular);