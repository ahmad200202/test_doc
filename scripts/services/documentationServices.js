!function(angular){"use strict";var services=angular.module(window.AppName+".documentationServices");services.service(composeConsts.DocumentationSrvcs.DisplayService,[composeConsts.Srvcs.composeUtils,"$filter","$timeout",function(composeUtils,$filter){var DisplayService={data:{TreeIds:{Model:"tree-root1",Etl:"tree-root2",DataMart:"tree-root3",Appendix:"tree-root4"},tenCharRegex:/.{1,10}/g,printMode:!1,TREE_NAV_ITEMS:[{"class":"modelImage",route:composeConsts.documentation_tree_nodes.MODEL_NODE},{"class":"dataWarehouseImage",route:composeConsts.documentation_tree_nodes.ETL_SETS_NODE},{"class":"dataMartImage",route:composeConsts.documentation_tree_nodes.DATA_MARTS_SETS_NODE},{"class":"databaseImage",route:composeConsts.documentation_tree_nodes.APPENDIX_NODE}],SELECTED_TREE_NAV_ITEM:null,ROUTING_STATES:Object.keys(composeConsts.documentation_tree_nodes).map(function(key){return composeConsts.documentation_tree_nodes[key]}),CUSTOM_ETL_NODES_DISPLAY_NAMES:Object.keys(composeConsts.ETL_CUSTOM_ETL_NODES_NAMES).map(function(key){return composeConsts.ETL_CUSTOM_ETL_NODES_NAMES[key]}),Repository:null,editorOptions:composeConsts.CodeMirrorOptions,navigation_items:[],model_erd_data:null,current_item_name:"",current_model_entity_attributes:[],current_model_entity_lineage:{},current_mapping_item:null,current_custom_etl_item:null,current_fact_dim_item:{ui_prop_transaction_date:null,ui_prop_fact_dim_type_name:null,fact_dim:null,group_by_cols:[],aggregations_cols:[]},current_database_item:null,entities:[],transformations:[],etl_sets_list:[],etl_set_item_active_mappings_list:[],etl_or_dm_custom_etls_list:[],etl_item_mapping_list:[],etl_entity_item_mappings_list:[],facts_dims_list:[],data_marts_list:[],current_star_schema_display_data:{data:{},actionBarOptions:{allow_zoom:!0,zoom_duration:composeConsts.ZOOM_DURATION,allow_search:!1,search_term:""}},current_dimension_display_data:{nodes:[],options:{allow_context_menu:!1},actionBarOptions:{show_pk:!1,show_minimap:!1}}},INIT:function(){void 0!=DisplayService.getRepository()&&(DisplayService.data.Repository=DisplayService.getRepository(),DisplayService.data.editorOptions.lineNumbers=!1,DisplayService.data.editorOptions.readOnly=!0)},addDisplayDescription:function(object){object&&object.description&&(object.display_description=object.description.match(DisplayService.data.tenCharRegex).join(" "))},findRepositoryNodeByName:function(node_name,tree){if(tree.name==node_name)return tree;if(null!=tree.children){for(var result=null,i=0;null==result&&i<tree.children.length;i++)result=DisplayService.findRepositoryNodeByName(node_name,tree.children[i]);return result}return null},setSelectedNavItemByState:function(state_name){if(state_name&&""!=state_name){var nav_item=_.find(DisplayService.data.TREE_NAV_ITEMS,function(it){return it.route.state_name==state_name});nav_item&&(DisplayService.data.SELECTED_TREE_NAV_ITEM=DisplayService.data.TREE_NAV_ITEMS[DisplayService.data.TREE_NAV_ITEMS.indexOf(nav_item)])}},setNavigationItems:function(node,parent_node){DisplayService.data.navigation_items.splice(0,DisplayService.data.navigation_items.length),Array.prototype.push.apply(DisplayService.data.navigation_items,node.children.map(function(it){return{parent_origin_name:parent_node?parent_node.name:null,origin_name:node.name,name:it.name,state_name:DisplayService.getStateNameByNodeName(it.name)}}))},getStateNameByNodeName:function(node_name){var state=_.find(DisplayService.data.ROUTING_STATES,function(it){return it.node_name==node_name});return state=state||{},state.state_name},getStateNameBy:function(id){var state=_.find(DisplayService.data.ROUTING_STATES,function(it){return it.state_id==id});return state=state||{},state.state_name},getRepository:function(){return window.Repository},getProjectName:function(){return DisplayService.getRepository()[DO.DocumentationModel.project_name]},getProjectCreateTime:function(){return DisplayService.getRepository()[DO.DocumentationModel.generation_time]},getModelRootNode:function(){return DisplayService.getRepository()[DO.DocumentationModel.model]},getETLSetsRootNode:function(){return DisplayService.getRepository()[DO.DocumentationModel.etl_sets]},getDataMartsRootNode:function(){return DisplayService.getRepository()[DO.DocumentationModel.data_marts]},getAppendixRootNode:function(){return DisplayService.getRepository()[DO.DocumentationModel.appendix]},repoGetEntities:function(){var ret=DisplayService.findRepositoryNodeByName(composeConsts.documentation_tree_nodes.ENTITIES_NODE.node_name,DisplayService.getModelRootNode()),entities=ret[DO.LeafsList.children].map(function(it){return it.object});return angular.forEach(entities,function(item){angular.forEach(item.table_columns_ext,function(table_column){DisplayService.addDisplayDescription(table_column)})}),entities},repoGetAttributesDomain:function(){var ret=DisplayService.findRepositoryNodeByName(composeConsts.documentation_tree_nodes.ATTRIBUTES_DOMAIN_NODE.node_name,DisplayService.getModelRootNode()),attributes_domain=ret[DO.DTObjectList.objects];return angular.forEach(attributes_domain,function(item){item[DO.DocDomainAttributeDto.domain_attribute][composeConsts.UI_PROPS2.ui_prop_data_type_obj]=$filter("ACDataTypeToTypeObj")(item[DO.DocDomainAttributeDto.domain_attribute][DO.DomainAttributeDto.type]),item[DO.DocDomainAttributeDto.domain_attribute][DO.DomainAttributeDto.description]&&DisplayService.addDisplayDescription(item[DO.DocDomainAttributeDto.domain_attribute])}),ret[DO.DTObjectList.objects]},repoGetTransformations:function(){var ret=DisplayService.findRepositoryNodeByName(composeConsts.documentation_tree_nodes.TRANSFORMATION_NODE.node_name,DisplayService.getModelRootNode());return ret?ret[DO.DTObjectList.objects].map(function(it){return{transformation:it[DO.DocTransformationDto.transformation],usage_list_display:it[DO.DocTransformationDto.usage_list]}}):[]},repoGetMappings:function(){var ret=DisplayService.findRepositoryNodeByName(composeConsts.documentation_tree_nodes.MAPPINGS_NODE.node_name,DisplayService.getETLSetsRootNode());return ret[DO.LeafsList.children]},repoGetETLSetsList:function(){var ret=DisplayService.findRepositoryNodeByName(composeConsts.documentation_tree_nodes.ETL_SETS_LIST_NODE.node_name,DisplayService.getETLSetsRootNode()),etl_sets=ret[DO.LeafsList.children];return angular.forEach(etl_sets,function(item){DisplayService.addDisplayDescription(item.object)}),etl_sets},repoGetDataMartsList:function(){var ret=DisplayService.findRepositoryNodeByName(composeConsts.documentation_tree_nodes.DATA_MARTS_SETS_LIST_NODE.node_name,DisplayService.getDataMartsRootNode());return ret[DO.LeafsList.children]},repoGetEntityLineage:function(entity_name,entity_id){var ret=null,mode_root_node=DisplayService.getModelRootNode(),m=_.find(mode_root_node.children,function(it){return it.name==composeConsts.documentation_tree_nodes.ENTITIES_NODE.node_name}),ent=_.find(m.children,function(it){return it.object.id==entity_id});return ent&&(ret=_.find(ent.children,function(it){return it.name==composeConsts.DocumentationTexts.Lineage_Text})),ret},repoGetDatabases:function(){var ret=DisplayService.findRepositoryNodeByName(composeConsts.documentation_tree_nodes.APPENDIX_DATABASES_NODE.node_name,DisplayService.getAppendixRootNode());return ret[DO.LeafsList.children]},repoGetAllDatabases:function(){var ret=[],s_dbs=DisplayService.getAllSourceDatabases(),dwh_dbs=DisplayService.getAllDwhDatabases();return Array.prototype.push.apply(ret,s_dbs),Array.prototype.push.apply(ret,dwh_dbs),ret},setETLSetsList:function(){DisplayService.data.etl_sets_list=DisplayService.repoGetETLSetsList()},setEntities:function(){DisplayService.data.entities=DisplayService.repoGetEntities()},setMappings:function(){var etl_sets_mappings=DisplayService.repoGetMappings(),etl_sets_list=DisplayService.getETLSetsRootNode();try{angular.forEach(etl_sets_mappings,function(map){angular.forEach(map.children,function(map_child){angular.forEach(etl_sets_list.children,function(etl){var etls=etl.children.filter(function(it){return null!=it.object&&it.object.active_mappings.indexOf(map_child.id)>-1});if(etls&&etls.length>0){var used_in_etls=etls.map(function(it){return it.name});map.used_in_etls=used_in_etls.join(", ")}})})})}catch(err){console.log(err)}finally{DisplayService.data.etl_item_mapping_list=DisplayService.repoGetMappings()}},setAttributesDomain:function(){DisplayService.data.attributes=DisplayService.repoGetAttributesDomain()},setTransformations:function(){DisplayService.data.transformations=DisplayService.repoGetTransformations()},setEntityAttributesData:function(entityName){var entities=DisplayService.repoGetEntities();DisplayService.data.current_model_entity_attributes=_.find(entities,function(it){return it.name==entityName}),angular.forEach(DisplayService.data.current_model_entity_attributes.table_columns_ext,function(item){if(item.display_history_type=item.history_type==DO.HistoryType.N?composeConsts.DocumentationTexts.Type_1_Text:composeConsts.DocumentationTexts.Type_2_Text,1==item.is_fk)item.display_name=item.entity.name,item.display_type=composeConsts.DocumentationTexts.Relationship_Text;else if(null!=item.domainAttribute)item.display_name=item.attribute_name||item.domainAttribute.name,item.display_type=$filter("columnTypeDisplayFilterByProps")(item.domainAttribute.type,item.domainAttribute.length,item.domainAttribute.scale);else if(DisplayService.data.current_model_entity_attributes.object&&DisplayService.data.current_model_entity_attributes.object.attributes){var att=DisplayService.data.current_model_entity_attributes.attributes.filter(function(it){return it.id==item.pbe});att&&1==att.length&&(item.display_name=""!=item.prefix?item.prefix+att[0].name:att[0].name,item.display_type=att[0].type==DO.ACDataType.NotSupported?composeConsts.DocumentationTexts.Relationship_Text:att[0].type)}})},setDiagramData:function(){var entities=DisplayService.repoGetEntities(),displayModelData={entities:entities},data=Utils.mergeValuedObjToDefaultValuedObj(displayModelData,"GetEntitiesRsp");DisplayService.data.model_erd_data={nodes:[],options:{show_date_model:!0,allow_context_menu:!1,show_minimap:!1,lightweight:DisplayService.data.printMode},actionBarOptions:{show_pk:!1,show_fk:!1}},DisplayService.data.model_erd_data.nodes=composeUtils.prepareDataForGraphDisplay({entities:data.entities})},setLineageData:function(entity_name,entity_id){var appendixExists=null!=DisplayService.getAppendixRootNode(),current_model_entity_lineage=DisplayService.repoGetEntityLineage(entity_name,entity_id);DisplayService.data.current_model_entity_lineage=composeUtils.getDWHLineageDisplayData(current_model_entity_lineage.info,current_model_entity_lineage.info.entity_name),DisplayService.data.current_model_entity_lineage.options={allow_zoom:!0},ArrayUtils.each(DisplayService.data.current_model_entity_lineage.nodes,function(item){item.class=item.type,item.type===Lineage.LineageTypes.Landing.type&&(item.clickable=appendixExists),item.type==Lineage.LineageTypes.Mappings.type||item.type==Lineage.LineageTypes.ReplicateTask.type?(item.width=Lineage.MappingDefaultRectWidth,item.height=Lineage.MappingDefaultRectHeight,item.shape=AttuGraph.shapes.lineageRoundedRect):(item.width=Lineage.DefaultRectWidth,item.height=Lineage.DefaultRectHeight,item.shape=AttuGraph.shapes.lineageRectangle)})},getParentEntities:function(selectedEntity,entities){var resultArr=[];return _.each(entities,function(entity){_.each(entity.table_columns_ext,function(column){column[DO.TableColumnExtended.is_fk]&&column[DO.TableColumnExtended.entity][DO.EntityDto.id]==selectedEntity[DO.EntityFull.id]&&null==_.findWhere(resultArr,{id:selectedEntity[DO.EntityFull.id]})&&resultArr.push(entity)})}),resultArr},setEntityRelationShipData:function(entityName){var entities=DisplayService.repoGetEntities();DisplayService.data.current_model_entity_attributes=_.find(entities,function(it){return it.name==entityName});var modelData={entities:entities},data=Utils.mergeValuedObjToDefaultValuedObj(modelData,"GetEntitiesRsp"),erd={nodes:[],api:{},options:{show_date_model:!0,show_minimap:!1,allow_context_menu:!1,show_pk:!0,show_fk:!0}};erd.nodes.splice(0,erd.nodes.length);var selectedEntity=data.entities.filter(function(ent){return ent.id==DisplayService.data.current_model_entity_attributes.id}),parentRelatedEntities=this.getParentEntities(selectedEntity[0],data.entities),childRelatedEntities=composeUtils.getEntitiesRelationsByEntity(selectedEntity[0],data.entities);childRelatedEntities.push.apply(childRelatedEntities,parentRelatedEntities),erd.nodes=composeUtils.prepareDataForGraphDisplay({entities:childRelatedEntities}),DisplayService.data.model_erd_data=erd},getETL:function(etl_name){var all_etls=DisplayService.repoGetETLSetsList();return _.find(all_etls,function(etl){return etl.name==etl_name})},getMappingForEntity:function(entity_id,etl_mappings){return etl_mappings.filter(function(map){return map.entity_id==entity_id})},setETLMappingList:function(etl_name){var all_entities=angular.copy(DisplayService.repoGetEntities()),etl=DisplayService.getETL(etl_name);angular.forEach(all_entities,function(entity){if(entity.entity_mappings=DisplayService.getMappingForEntity(entity.id,etl.children[0][DO.DTObjectList.objects]),etl.object&&etl.object.entity_action)var action=etl.object.entity_action.filter(function(act){return act.entity_id==entity.id});entity.is_handle_dup_active=null!=action&&1==action.length&&1==action[0].handle_duplicates}),DisplayService.data.etl_set_item_active_mappings_list=all_entities},setETLMappingItem:function(table_name,mapping_name){var mappingObj=null,tableObj=null,databaseObj=null,mappings=DisplayService.repoGetMappings(),databases=DisplayService.repoGetAllDatabases();tableObj=_.find(mappings,function(it){return it.name==table_name}),tableObj&&(mappingObj=_.find(tableObj.children,function(it){return it.name==mapping_name})),mappingObj&&(databaseObj=_.find(databases,function(it){return it.id==mappingObj.database_id}),angular.forEach(mappingObj[DO.MappingDto.mapping_fields],function(field){switch(field[composeConsts.UI_PROPS2.ui_prop_source_col_display_name]="",field[DO.MappingField.mapping_type]){case DO.FieldMappingType.DIRECT:field[composeConsts.UI_PROPS2.ui_prop_source_col_display_name]=field[DO.MappingField.source_col_name];break;case DO.FieldMappingType.EXPRESSION:field[composeConsts.UI_PROPS2.ui_prop_source_col_display_name]=field.expression.expression_statement;break;case DO.FieldMappingType.LOOKUP:field.lookup&&field.lookup.lookup_expression&&(field[composeConsts.UI_PROPS2.ui_prop_source_col_display_name]=composeConsts.DocumentationTexts.Condition_Text+": "+field.lookup.lookup_expression.expression_statement+"\n, "+composeConsts.DocumentationTexts.ResultColumn_Text+": "+field.lookup.lookup_result_expression.expression_statement)}}),angular.forEach(mappingObj[DO.MappingDto.data_quality_rules],function(data_quality_rules){data_quality_rules.ui_prop_action_display_name=$filter("capitalizeFirstLetter")($filter("humanize")(data_quality_rules[DO.DataQualityRule.action])),DisplayService.addDisplayDescription(data_quality_rules)}),angular.forEach(mappingObj[DO.MappingDto.cleansing_rules],function(cleansing_rule){cleansing_rule.ui_prop_action_display_name=$filter("capitalizeFirstLetter")($filter("humanize")(cleansing_rule[DO.CleansingRule.action])),DisplayService.addDisplayDescription(cleansing_rule)})),DisplayService.data.current_mapping_item={name:mapping_name,databaseObj:databaseObj,mappingObj:mappingObj}},getCustomEtls:function(etl_name,custom_etl_type){var etl=DisplayService.getETL(etl_name),custom_etl=_.find(etl.children,function(it){return it.name==custom_etl_type});return custom_etl?custom_etl[DO.LeafsList.children]:null},setCustomETLList:function(etl_name,custom_etl_type){DisplayService.data.etl_or_dm_custom_etls_list=DisplayService.getCustomEtls(etl_name,custom_etl_type)},setEntitiesSingleTableCustomETL:function(etl_name,custom_etl_type){var custom_etls=DisplayService.getCustomEtls(etl_name,custom_etl_type);DisplayService.setEntities(),angular.forEach(DisplayService.data.entities,function(ent){null==ent.custom_etls_for_type&&(ent.custom_etls_for_type={}),ent.custom_etls_for_type[composeUtils.convertCustomETLNameToType(custom_etl_type)]=custom_etls.filter(function(it){return it.type==composeUtils.convertCustomETLNameToType(custom_etl_type)&&it.entity_id==ent.id})})},setCurrentCustomETL:function(custom_etl_item){DisplayService.data.current_custom_etl_item=custom_etl_item},setDataMartsList:function(){DisplayService.data.data_marts_list=DisplayService.repoGetDataMartsList().map(function(it){return it.object})},getDataMart:function(data_mart_name){return _.find(DisplayService.repoGetDataMartsList(),function(it){return it.name==data_mart_name})},getFactDimList:function(dm_table_type,data_mart_name){var dm=DisplayService.getDataMart(data_mart_name),items=_.find(dm.children,function(it){return it.name==dm_table_type});return items[DO.LeafsList.children]},setCurrentFactDimList:function(dm_table_type,data_mart_name){DisplayService.data.facts_dims_list=DisplayService.getFactDimList(dm_table_type,data_mart_name)},setCurrentFactDimItem:function(dm_table_type,data_mart_name,table_name,fact_dim_id){var dms=DisplayService.getFactDimList(dm_table_type,data_mart_name);if(DisplayService.data.current_fact_dim_item.ui_prop_transaction_date=null,DisplayService.data.current_fact_dim_item.ui_prop_fact_dim_type=null,DisplayService.data.current_fact_dim_item.fact_dim=_.find(dms,function(it){return it.id==fact_dim_id}),null!=DisplayService.data.current_fact_dim_item.fact_dim){var the_node=DisplayService.data.current_fact_dim_item.fact_dim;composeUtils.getIsAggregated(the_node)&&(DisplayService.data.current_fact_dim_item.group_by_cols=$filter("filter")(the_node[DO.FactDimDto.fact_dim_columns],{aggregate_function:DO.AggregatedFunction.GROUPBY},!0),DisplayService.data.current_fact_dim_item.aggregations_cols=$filter("filter")(the_node[DO.FactDimDto.fact_dim_columns],{aggregate_function:"!"+DO.AggregatedFunction.GROUPBY},!0));var all_ents=DisplayService.repoGetEntities(),root_entity=$filter("filter")(all_ents,{id:the_node[DO.FactDimDto.root_entity_id]})[0];if(DisplayService.data.current_fact_dim_item.ui_prop_fact_dim_type=composeUtils.getStarSchemaDimensionType(the_node),composeUtils.getIsFact(the_node)){var txdate_path=$filter("filter")(the_node[DO.FactDimDto.dwh_columns],{path:the_node[DO.FactDimDto.txdate_path]},!0);DisplayService.data.current_fact_dim_item.ui_prop_transaction_date=null!=txdate_path&&txdate_path.length>0?txdate_path[0][DO.FactDimColumn.attribute_name]:null;var facts=[the_node],dimensions=[],fact_entity=(DisplayService.getDataMartDimensions(data_mart_name),$filter("filter")(all_ents,{id:facts[0].root_entity_id},!0));facts[0][composeConsts.UI_PROPS.ui_prop_display_name]=composeUtils.getFactDisplayName(the_node,1==fact_entity.length?fact_entity[0].name:null),1==facts.length&&(dimensions=facts[0][DO.FactDimDto.fact_dim_columns].filter(function(it){return it[DO.FactDimColumn.is_internal_column]&&null!=it[DO.FactDimColumn.attribute_name]&&""!=it[DO.FactDimColumn.attribute_name]&&it[DO.FactDimColumn.attribute_name].toLowerCase().indexOf(composeConsts.SpecialColumn_OID.toLowerCase()>-1)})),angular.forEach(dimensions,function(item){var attribute_name=item[DO.FactDimColumn.attribute_name];item[composeConsts.UI_PROPS.ui_prop_display_name]=attribute_name.replaceAll(composeConsts.SpecialColumn_OID,"")}),DisplayService.data.current_star_schema_display_data.data=composeUtils.createStarSchemaDisplayNodes(facts,dimensions,[composeConsts.UI_PROPS.ui_prop_display_name],DO.FactDimColumn.path)[0]}else if(root_entity){var entities=composeUtils.getEntitiesRelationsByEntity(root_entity,all_ents);DisplayService.data.current_dimension_display_data.nodes=composeUtils.prepareDataForGraphDisplay({entities:entities})}else DisplayService.data.current_dimension_display_data.nodes.splice(0,DisplayService.data.current_dimension_display_data.nodes.length)}},getDataMartStarSchemas:function(data_mart_name){var dm=DisplayService.getDataMart(data_mart_name),st=_.find(dm.children,function(it){return it.name==composeConsts.documentation_tree_nodes.DATA_MARTS_STAR_SCHEMAS_ROOT_NODE.node_name});return st[DO.LeafsList.children]},getDataMartDimensions:function(data_mart_name){var dm=DisplayService.getDataMart(data_mart_name),dim=_.find(dm.children,function(it){return it.name==composeConsts.documentation_tree_nodes.DATA_MARTS_DIMENSIONS_ROOT_NODE.node_name});return dim[DO.LeafsList.children]},getDataMartCustomETLs:function(data_mart_name,custom_etl_type){var dm=DisplayService.getDataMart(data_mart_name),custom_etls=_.find(dm.children,function(it){return it.name==custom_etl_type});return custom_etls&&(DisplayService.data.etl_or_dm_custom_etls_list=custom_etls.children),custom_etls},setCurrentSourceDatabase:function(db_id){DisplayService.data.current_database_item=DisplayService.getSourceDatabaseItem(db_id)},setCurrentDwhDatabase:function(db_id){DisplayService.data.current_database_item=DisplayService.getDwhDatabaseItem(db_id)},getAllDatabases:function(){var ret=[],appendix=DisplayService.getAppendixRootNode();if(appendix){var databases=_.find(appendix.children,function(it){return it.name===composeConsts.documentation_tree_nodes.APPENDIX_DATABASES_NODE.node_name});ret=databases.children}return ret},getAllSourceDatabases:function(){var ret=[],all_databases=DisplayService.getAllDatabases(),all_sources=_.find(all_databases,function(it){return it.name==composeConsts.documentation_tree_nodes.APPENDIX_SOURCE_DATABASES_NODE.node_name});return all_sources&&(ret=all_sources.children),ret},getSourceDatabaseItem:function(database_id){var sources=DisplayService.getAllSourceDatabases();return _.find(sources,function(it){return it[DO.DatabaseDto.id]==database_id})},getAllDwhDatabases:function(){var ret=[],all_databases=DisplayService.getAllDatabases(),all_dwhs=_.find(all_databases,function(it){return it.name==composeConsts.documentation_tree_nodes.APPENDIX_DWH_DATABASES_NODE.node_name});return all_dwhs&&(ret=all_dwhs.children),ret},getDwhDatabaseItem:function(database_id){var all_dwhs=DisplayService.getAllDwhDatabases();return _.find(all_dwhs,function(it){return it[DO.DatabaseDto.id]==database_id})}};return DisplayService.INIT(),DisplayService}]),services.service(composeConsts.DocumentationSrvcs.PrintService,["$compile","$timeout","$rootScope","$templateCache",composeConsts.DocumentationSrvcs.DisplayService,composeConsts.Srvcs.composeUtils,function($compile,$timeout,$rootScope,$templateCache,DisplayService){var PrintService={diagram_print_width:"900",diagram_print_height:"550",getPrintItemWrapper:function(name){var wrapEl=angular.element("<div class='printItemWrap page'></div>");return wrapEl.append("<div class='printItemHeader'>"+name+"</div>"),wrapEl.append("<div class='printItemContent'></div>"),wrapEl},appendViewToPrintElement2:function(elNode,template){var scope=$rootScope.$new();scope.data=ObjectUtils.deepClone(DisplayService.data),scope.printMode=!0;var view=$templateCache.get(template);view=view.replaceAll('static-mode="{{printMode}}"','static-mode="true"');var el=$compile(view)(scope);elNode.find(".printItemContent").append(el)},printProductLogo:function(){this.element.append("<div class='appHeader'> <div class='row mainHeaderWrapper'> <span id='ProductLogoSpan' class='productLogoIcon replicateLogo'></span></div> </div>")},printTitle:function(){var self=this,el=angular.element("<div class='appDocumentationStatusBar'></div>");el.append("<div class='printItemContent H100W100'></div>"),self.element.append(el),self.appendViewToPrintElement2(el,"partials/statusBarView.html")},printProjectDocumentation:function(element){var self=this;self.element=element;var print_all=!0;self.printProductLogo(),self.printTitle(),print_all&&(self.printEntitiesAttributesData(),self.printAttributesDomain(),self.printTransformations(),self.printERD(),self.printETLSetsList(),self.printETLActiveMappings(),self.printDWHCustomETL(),self.printEntityMappings(),self.printDataMartList(),self.printDataMartItem(),self.printAppendix()),element.find(".printItemWrap").first().addClass("first")},printEntitiesAttributesData:function(){var self=this,entities=DisplayService.repoGetEntities();ArrayUtils.each(entities,function(item){var wrapEl=PrintService.getPrintItemWrapper(item.name);self.element.append(wrapEl),DisplayService.setEntityAttributesData(item.name),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.ENTITY_ATTRIBUTES_NODE.templateUrl)})},printAttributesDomain:function(){var self=this,wrapEl=PrintService.getPrintItemWrapper(composeConsts.documentation_tree_nodes.ATTRIBUTES_DOMAIN_NODE.display_name);self.element.append(wrapEl),DisplayService.setAttributesDomain(),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.ATTRIBUTES_DOMAIN_NODE.templateUrl)},printTransformations:function(){var self=this,wrapEl=PrintService.getPrintItemWrapper(composeConsts.documentation_tree_nodes.TRANSFORMATION_NODE.display_name);self.element.append(wrapEl),DisplayService.setTransformations(),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.TRANSFORMATION_NODE.templateUrl)},printERD:function(){var self=this,wrapEl=angular.element(PrintService.getPrintItemWrapper(composeConsts.DocumentationTexts.DataWarehouse_Model_Text));wrapEl.find(".printItemContent").width(PrintService.diagram_print_width).height(PrintService.diagram_print_height),self.element.append(wrapEl),DisplayService.setDiagramData(),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.ERD_NODE.templateUrl)},printETLSetsList:function(){var self=this,wrapEl=angular.element(PrintService.getPrintItemWrapper(composeConsts.documentation_tree_nodes.ETL_SETS_LIST_NODE.display_name));self.element.append(wrapEl),DisplayService.setETLSetsList(),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.ETL_SETS_LIST_NODE.templateUrl)},printETLActiveMappings:function(){var self=this,all_etls=DisplayService.repoGetETLSetsList();angular.forEach(all_etls,function(etl){var wrapEl=angular.element(PrintService.getPrintItemWrapper(etl.name+" - "+composeConsts.documentation_tree_nodes.ETL_ACTIVE_MAPPING_ROOT_NODE.node_name));self.element.append(wrapEl),DisplayService.setETLMappingList(etl.name),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.ETL_ACTIVE_MAPPING_ROOT_NODE.templateUrl)})},printDWHCustomETL:function(){var self=this,all_etls=DisplayService.repoGetETLSetsList();angular.forEach(all_etls,function(item){var etl=DisplayService.getETL(item.name);angular.forEach(DisplayService.data.CUSTOM_ETL_NODES_DISPLAY_NAMES,function(custom_etl_name){var custom_etl=DisplayService.getCustomEtls(etl.name,custom_etl_name);custom_etl&&angular.forEach(custom_etl,function(cust_etl){DisplayService.setCurrentCustomETL(cust_etl);var title=etl.name+" - "+custom_etl_name+" - "+cust_etl.name,wrapEl=angular.element(PrintService.getPrintItemWrapper(title));self.element.append(wrapEl),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.ETL_CUSTOM_ETL_NODE.templateUrl)})})})},printEntityMappings:function(){var self=this,mappings=DisplayService.repoGetMappings();ArrayUtils.each(mappings,function(mappingEntity){ArrayUtils.each(mappingEntity.children,function(mapping){DisplayService.setETLMappingItem(mappingEntity.name,mapping.name);var title=composeConsts.DocumentationTexts.Mappings_Text+" - "+mappingEntity.name+" - "+mapping.name,wrapEl=angular.element(PrintService.getPrintItemWrapper(title));self.element.append(wrapEl),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.ETL_ENTITY_MAPPING_ITEM_NODE.templateUrl)})})},printDataMartList:function(){var self=this;DisplayService.setDataMartsList();var wrapEl=angular.element(PrintService.getPrintItemWrapper(composeConsts.documentation_tree_nodes.DATA_MARTS_SETS_LIST_NODE.display_name));self.element.append(wrapEl),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.DATA_MARTS_SETS_LIST_NODE.templateUrl)},printDataMartItem:function(){var self=this,dms=DisplayService.repoGetDataMartsList().map(function(it){return it.object});angular.forEach(dms,function(dm_item){var dm=DisplayService.getDataMart(dm_item.name),dm_sts=DisplayService.getDataMartStarSchemas(dm_item.name),dm_dims=DisplayService.getDataMartDimensions(dm_item.name);angular.forEach(dm_sts,function(st){DisplayService.setCurrentFactDimItem(composeConsts.documentation_tree_nodes.DATA_MARTS_STAR_SCHEMAS_ROOT_NODE.node_name,dm_item.name,st.name,st.id);var title=composeConsts.DocumentationTexts.DataMart_Text+" - "+dm_item.name,wrapEl=angular.element(PrintService.getPrintItemWrapper(title));self.element.append(wrapEl),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.DATA_MARTS_STAR_SCHEMA_ITEM_NODE.templateUrl)}),angular.forEach(dm_dims,function(st){DisplayService.setCurrentFactDimItem(composeConsts.documentation_tree_nodes.DATA_MARTS_DIMENSIONS_ROOT_NODE.node_name,dm_item.name,st.name,st.id);var title=composeConsts.DocumentationTexts.DataMart_Text+" - "+dm_item.name,wrapEl=angular.element(PrintService.getPrintItemWrapper(title));self.element.append(wrapEl),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.DATA_MARTS_STAR_DIMENSION_ITEM_NODE.templateUrl)}),angular.forEach(DisplayService.data.CUSTOM_ETL_NODES_DISPLAY_NAMES,function(custom_etl_type){var custom_etls=DisplayService.getDataMartCustomETLs(dm.name,custom_etl_type);custom_etls&&custom_etls.children&&angular.forEach(custom_etls.children,function(custom_etl){var custom_etl_title=dm_item.name+" - "+custom_etl_type+" - "+custom_etl.name,wrapEl1=angular.element(PrintService.getPrintItemWrapper(custom_etl_title)),custom_etl_item=_.find(custom_etls.children,function(it){return it.name==custom_etl.name});DisplayService.setCurrentCustomETL(custom_etl_item),self.element.append(wrapEl1),self.appendViewToPrintElement2(wrapEl1,composeConsts.documentation_tree_nodes.ETL_CUSTOM_ETL_NODE.templateUrl)})})})},printAppendix:function(){var self=this,src_databases=DisplayService.getAllSourceDatabases(),trg_databases=DisplayService.getAllDwhDatabases();angular.forEach(src_databases,function(src_db){DisplayService.setCurrentSourceDatabase(src_db[DO.DatabaseDto.id]);var title=composeConsts.DocumentationTexts.Source_Database_Text+" - "+src_db.name,wrapEl=angular.element(PrintService.getPrintItemWrapper(title));self.element.append(wrapEl),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.APPENDIX_DATABASE_ITEM_NODE.templateUrl)}),angular.forEach(trg_databases,function(dwh_db){DisplayService.setCurrentDwhDatabase(dwh_db[DO.DatabaseDto.id]);var title=composeConsts.DocumentationTexts.DataWarehouse_Database_Text+" - "+dwh_db.name,wrapEl=angular.element(PrintService.getPrintItemWrapper(title));self.element.append(wrapEl),self.appendViewToPrintElement2(wrapEl,composeConsts.documentation_tree_nodes.APPENDIX_DATABASE_ITEM_NODE.templateUrl)})}};return PrintService}])}(angular);