!function(global){"use strict";global.AttuGraph=global.AttuGraph||{},global.AttuGraph.Utils=global.AttuGraph.Utils||{},global.AttuGraph.Utils.templatesLoader=function(){var templatesCache={};this.get=function(templateUrl){return null==templatesCache[templateUrl]&&$.ajax({url:templateUrl,success:function(html){templatesCache[templateUrl]=html},async:!1}),templatesCache[templateUrl]}},global.AttuGraph.Utils.svgDefsLoader=function(defsPath){var defsHtml=$("<div></div>");$.ajax({url:defsPath,success:function(html){defsHtml.append(html)},async:!1}),this.getById=function(id){return defsHtml.find("#"+id).clone()[0]}},global.AttuGraph.Utils.point=function(d){return{x:global.AttuGraph.Utils.nodePosition.x(d),y:global.AttuGraph.Utils.nodePosition.y(d)}},global.AttuGraph.Utils.ellipsisTextInMiddle=function(text,strLen,separator){if(text.length<=strLen)return text;separator=separator||"...";var sepLen=separator.length,charsToShow=strLen-sepLen,frontChars=Math.ceil(charsToShow/2),backChars=Math.floor(charsToShow/2);return text.substr(0,frontChars)+separator+text.substr(text.length-backChars)},global.AttuGraph.Utils.shortenText=function(text,maxLength,separator){var ret=text,ret_separator="",separator_length=0;return separator?(separator_length=ret_separator.length,ret_separator=separator):(separator_length=0,ret_separator=""),ret.length>maxLength&&(ret=ret.substr(0,maxLength-separator_length)+ret_separator),ret},global.AttuGraph.Utils.setTextToNode=function(node,nodeEl,prop,split_by,maxLength){if(global.AttuGraph.Utils.hasValidProp(node,prop)){var arr=[];arr=""!=split_by?node[prop].split(split_by).filter(function(it){return""!=it}):[node[prop]];var text=d3.select(nodeEl).select("text");if(null==text.node()&&(text=d3.select(nodeEl).append("text").attr("class",node.class)),void 0!=arr)for(var xPos=15,yPos=15,i=0;i<arr.length;i++)if(arr[i]!=String(void 0)&&void 0!=arr[i]&&""!=arr[i]){var tspan=null;tspan=text.append("tspan").text(i==arr.length-1?global.AttuGraph.Utils.shortenText(arr[i],maxLength,"..."):global.AttuGraph.Utils.ellipsisTextInMiddle(arr[i],maxLength,"...")),yPos=arr.length>3?10+(i+4):3==arr.length?10+(i+6):2==arr.length?node.height/2-5:node.height/2,tspan&&tspan.attr("dy",yPos).attr("x",xPos).attr("text-anchor","left").attr("class","tspan"+i)}}},global.AttuGraph.Utils.setToolTipToNode=function(tipText,nodeEl){d3.select(nodeEl).select(".FlowNodeTooltip").remove(),""!=tipText&&"string"==typeof tipText&&d3.select(nodeEl).append("title").attr("class","FlowNodeTooltip").text(tipText)},global.AttuGraph.Utils.hasValidProp=function(node,prop){return null!=node&&node.hasOwnProperty(prop)&&""!=node[prop]},global.AttuGraph.Utils.nodePosition={x:function(node){return null!=node.px?node.px:node.x||0},y:function(node){return null!=node.py?node.py:node.y||0}},global.AttuGraph.Utils.svgAddClass=function(el,className){var $el=$(el),tempClass=$el.attr("class");tempClass.indexOf(className)<0&&$el.attr("class",tempClass+" "+className)},global.AttuGraph.Utils.svgRemoveClass=function(el,className){var $el=$(el),tempClass=$el.attr("class");tempClass.indexOf(className)>=0&&$el.attr("class",tempClass.replace(className,""))}}(this);