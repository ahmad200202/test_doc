"use strict";angular.module("jsonFormatter",["RecursionHelper"]).directive("jsonFormatter",["RecursionHelper",function(RecursionHelper){function escapeString(str){return str.replace('"','"')}function getObjectName(object){if(void 0===object)return"";if(null===object)return"Object";if("object"==typeof object&&!object.constructor)return"Object";var funcNameRegex=/function (.{1,})\(/,results=funcNameRegex.exec(object.constructor.toString());return results&&results.length>1?results[1]:""}function getType(object){return null===object?"null":typeof object}function link(scope){scope.isArray=function(){return Array.isArray(scope.json)},scope.isObject=function(){return scope.json&&"object"==typeof scope.json},scope.getKeys=function(){return scope.isObject()?Object.keys(scope.json).map(function(key){return""===key?'""':key}):void 0},scope.type=getType(scope.json),scope.hasKey="undefined"!=typeof scope.key,scope.getConstructorName=function(){return getObjectName(scope.json)},"string"===scope.type&&("Invalid Date"!==new Date(scope.json).toString()&&(scope.isDate=!0),0===scope.json.indexOf("http")&&(scope.isUrl=!0)),scope.isEmptyObject=function(){return scope.getKeys()&&!scope.getKeys().length&&scope.isOpen&&!scope.isArray()},scope.isOpen=!!scope.open,scope.toggleOpen=function(){scope.isOpen=!scope.isOpen},scope.childrenOpen=function(){return scope.open>1?scope.open-1:0},scope.openLink=function(isUrl){isUrl&&(window.location.href=scope.json)},scope.parseValue=function(value){return scope.type=getType(scope.json),"null"===scope.type?"null":"undefined"===scope.type?"undefined":("string"===scope.type&&(value='"'+escapeString(value)+'"'),"function"===scope.type?scope.json.toString().replace(/\n/g,"").replace(/\{.+?\}/,"")+"{ ... }":value)}}return{templateUrl:"json-formatter.html",restrict:"E",replace:!0,scope:{json:"=",key:"=",open:"="},compile:function(element){return RecursionHelper.compile(element,link)}}}]);